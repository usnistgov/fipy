
<!DOCTYPE html>


<!--[if IEMobile 7]><html class="iem7 no-js"  lang="en" dir="ltr"><![endif]-->
<!--[if lte IE 6]><html class="lt-ie9 lt-ie8 lt-ie7 no-js"  lang="en" dir="ltr"><![endif]-->
<!--[if (IE 7)&(!IEMobile)]><html class="lt-ie9 lt-ie8 no-js"  lang="en" dir="ltr"><![endif]-->
<!--[if IE 8]><html class="lt-ie9 no-js"  lang="en" dir="ltr"><![endif]-->
<!--[if (gte IE 9)|(gt IEMobile 7)]><!--><html class="no-js"  lang="en" dir="ltr" prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# book: http://ogp.me/ns/book# profile: http://ogp.me/ns/profile# video: http://ogp.me/ns/video# product: http://ogp.me/ns/product# content: http://purl.org/rss/1.0/modules/content/ dc: http://purl.org/dc/terms/ foaf: http://xmlns.com/foaf/0.1/ rdfs: http://www.w3.org/2000/01/rdf-schema# sioc: http://rdfs.org/sioc/ns# sioct: http://rdfs.org/sioc/types# skos: http://www.w3.org/2004/02/skos/core# xsd: http://www.w3.org/2001/XMLSchema#"><!--<![endif]-->

  <head>
<meta charset="utf-8" />
<link rel="shortcut icon" href="https://www.nist.gov/sites/all/themes/nist_style/favicon.ico" type="image/vnd.microsoft.icon" />
<script type="text/x-mathjax-config">MathJax.Hub.Config({
  extensions: ['tex2jax.js'],
  jax: ['input/TeX','output/HTML-CSS'],
  tex2jax: {
    inlineMath: [ ['$$','$$'], ['\\(','\\)'] ],
    processEscapes: true,
    processClass: 'tex2jax',
    ignoreClass: 'html'
  },
  showProcessingMessages: false,
  messageStyle: 'none'
});
</script>
<meta name="MobileOptimized" content="width">
    <meta name="HandheldFriendly" content="true">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=0">

      <!--[if lt IE 9]>
    <script src="https://www.nist.gov/sites/all/themes/zen/js/html5-respond.js"></script>
    <![endif]-->
    <!--[if (gte IE 6)&(lte IE 8)]>
  <script type="text/javascript" src="https://www.nist.gov/sites/all/themes/nist_style/js/selectivizr-min.js"></script>
  <![endif]--><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>General Conservation Equation &#8212; FiPy 3.4.5+416.g72a0321d4 documentation</title>
    <link rel="stylesheet" href="../_static/ntd2d.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/ntd2d.css?v=de7af573" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/widetable.css?v=32b6a719" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=e02dfeb3"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="canonical" href="https://pages.nist.gov/fipy/en/latest/numerical/equation.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="top" title="FiPy 3.4.5+416.g72a0321d4 documentation" href="../contents.html" />
    <link rel="up" title="Theoretical and Numerical Background" href="index.html" />
    <link rel="next" title="Finite Volume Method" href="discret.html" />
    <link rel="prev" title="Theoretical and Numerical Background" href="index.html" />
  
 


  <link rel="stylesheet" href="https://pages.nist.gov/nist-header-footer/css/nist-combined.css">
  <script src="https://code.jquery.com/jquery-3.6.2.min.js" type="text/javascript" defer="defer"></script>
  <script src="https://pages.nist.gov/nist-header-footer/js/nist-header-footer.js" type="text/javascript" defer="defer"></script>


  </head>
<!--  <body role="document">-->
  <body class="html not-front not-logged-in no-sidebars page-node page-node- page-node-414011 node-type-software hide-breadcrumb section-services-resources page-panels is-panel" role="document">
      <div id="page" class="mini-header">



    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="discret.html" title="Finite Volume Method"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Theoretical and Numerical Background"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html"><img src="../_static/fipy.png" alt="FiPy logo"
                 style="vertical-align: middle; margin-top: -1px"/>
        FiPy</a> &gt;</li>

          <li class="nav-item nav-item-1"><a href="../introduction.html" >Introduction</a> &gt;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">Theoretical and Numerical Background</a> &gt;</li> 
      </ul>
    </div>

  <div id="main" class="clearfix" role="main" tabindex="-1">
    <div class="main__inner">
      <div class="page-info">
        <a id="main-content"></a>
      </div>

      <div class="document">
        <div class="documentwrapper">

      <div id="content" class="column">
      <div id="block-nist-www-content" class="nist-block">
        <section class="nist-page__content usa-section clearfix">

         

        <div class="grid-container margin-top-4">
        <div class="grid-row grid-gap-6">

  <div class="nist-page__region nist-page__region--content tablet-lg:grid-col-8">
              <div class="body" role="main">
		
  <section id="general-conservation-equation">
<span id="sec-generalconservationequation"></span><h1>General Conservation Equation<a class="headerlink" href="#general-conservation-equation" title="Permalink to this heading">¶</a></h1>
<p>The equations that model the evolution of physical, chemical and
biological systems often have a remarkably universal form.  Indeed,
PDEs have proven necessary to model complex physical systems and
processes that involve variations in both space and time.  In general,
given a variable of interest <span class="math notranslate nohighlight">\(\phi\)</span> such as species concentration,
pH, or temperature, there exists an evolution equation of the form</p>
<div class="math notranslate nohighlight" id="equation-general-equation">
<span class="eqno">(1)<a class="headerlink" href="#equation-general-equation" title="Permalink to this equation">¶</a></span>\[\frac{\partial \phi}{\partial t} = H(\phi, \lambda_i)\]</div>
<p>where <span class="math notranslate nohighlight">\(H\)</span> is a function of <span class="math notranslate nohighlight">\(\phi\)</span>, other state variables
<span class="math notranslate nohighlight">\(\lambda_i\)</span>, and higher order derivatives of all of these variables.
Examples of such systems are wide ranging, but include problems that
exhibit a combination of diffusing and reacting species, as well as
such diverse problems as determination of the electric potential in
heart tissue, of fluid flow, stress evolution, and even the
Schrödinger equation.</p>
<p>A general conservation equation, solved using <a class="reference internal" href="../glossary.html#term-FiPy"><span class="xref std std-term">FiPy</span></a>, can include any
combination of the following terms,</p>
<div class="math notranslate nohighlight" id="equation-num-gen">
<span class="eqno">(2)<a class="headerlink" href="#equation-num-gen" title="Permalink to this equation">¶</a></span>\[\underbrace{
  \frac{\partial (\rho \phi)}{\partial t}
}_{\text{transient}}
+
\underbrace{
  \vphantom{\frac{\partial (\rho \phi)}{\partial t}}
  \nabla \cdot \left( \vec{u} \phi \right)
}_{\text{convection}}
=
\underbrace{
  \vphantom{\frac{\partial (\rho \phi)}{\partial t}}
  \left[ \nabla \cdot \left( \Gamma_i \nabla \right) \right]^n \phi
}_{\text{diffusion}}
+
\underbrace{
  \vphantom{\frac{\partial (\rho \phi)}{\partial t}}
  S_{\phi}
}_{\text{source}}\]</div>
<p>where <span class="math notranslate nohighlight">\(\rho\)</span>, <span class="math notranslate nohighlight">\(\vec{u}\)</span> and <span class="math notranslate nohighlight">\(\Gamma_i\)</span> represent coefficients in the
transient, convection and diffusion terms, respectively.  These
coefficients can be arbitrary functions of any parameters or variables
in the system.  The variable <span class="math notranslate nohighlight">\(\phi\)</span> represents the unknown quantity in
the equation.  The diffusion term can represent any higher order
diffusion-like term, where the order is given by the exponent <span class="math notranslate nohighlight">\(n\)</span>.
For example, the diffusion term can represent conventional Fickian
diffusion [<em>i.e.</em>, <span class="math notranslate nohighlight">\(\nabla\cdot(\Gamma\nabla\phi)\)</span>] when the
exponent <span class="math notranslate nohighlight">\(n = 1\)</span> or a Cahn-Hilliard term [<em>i.e.</em>, <span class="math notranslate nohighlight">\(\nabla
\cdot (\Gamma_1 \nabla [ \nabla \cdot \Gamma_2 \nabla \phi ) ] )\)</span>
<span id="id1">[<a class="reference internal" href="../references.html#id16" title="John W. Cahn and John E. Hilliard. Free energy of a nonuniform system. I. Interfacial free energy. Journal of Chemical Physics, 28(2):258-267, 1958.">18</a>]</span> <span id="id2">[<a class="reference internal" href="../references.html#id17" title="John W. Cahn. Free energy of a nonuniform system. II. Thermodynamic basis. Journal of Chemical Physics, 30(5):1121-1124, 1959.">19</a>]</span> <span id="id3">[<a class="reference internal" href="../references.html#id18" title="John W. Cahn and John E. Hilliard. Free energy of a nonuniform system. III. Nucleation in a two-component incompressible fluid. Journal of Chemical Physics, 31(3):688-699, 1959.">20</a>]</span>] when <span class="math notranslate nohighlight">\(n = 2\)</span>,
or a phase field crystal term [<em>i.e.</em>, <span class="math notranslate nohighlight">\(\nabla \cdot (\Gamma_1 \nabla
[ \nabla \cdot \Gamma_2 \nabla \{ \nabla \cdot \Gamma_3 \nabla \phi ) \} )
] )\)</span> <span id="id4">[<a class="reference internal" href="../references.html#id34" title="K. R Elder, K Thornton, and J. J Hoyt. The kirkendall effect in the phase field crystal model. Philosophical Magagazine, 91(1):151–164, Jan 2011. doi:10.1080/14786435.2010.506427.">21</a>]</span>] when <span class="math notranslate nohighlight">\(n = 3\)</span>, although spectral methods are probably a
better approach. Higher order terms (<span class="math notranslate nohighlight">\(n &gt; 3\)</span>) are also possible, but
the matrix condition number becomes quite poor.</p>
</section>


                <div class='last-updated'>
                Last updated on Jul 22, 2025.
                Created using <a href="http://sphinx-doc.org/">Sphinx</a> 7.1.2.
                </div>
              </div>
  </div>  
  <aside class="nist-page__region nist-page__region--sidebar-second tablet-lg:grid-col-4">
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">

<strong>FiPy: A Finite Volume PDE Solver Using Python</strong><br />
Version 3.4.5+416.g72a0321d4

<div class="sphinxsidebarsection">
  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Theoretical and Numerical Background</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="discret.html"
                        title="next chapter">Finite Volume Method</a></p>
</div>
  <div class="sphinxsidebarsection">
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/numerical/equation.rst.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
  </div>
<div class="sphinxsidebarsection">
<div id="searchbox" style="display: none" role="search">
  <div data-layout-content-preview-placeholder-label="&quot;Sphinx
  Search&quot; field" class="nist-block nist-block--search">
  <h2 id="searchlabel">Quick search</h2>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
  </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
</div>
<div class="sphinxsidebarsection" id="contact-wrapper">
  
        <div data-layout-content-preview-placeholder-label="&quot;Related
        organization tree&quot; views block" class="nist-block nist-block--org">
          
          <h2 class="nist-block__title">Organizations</h2>
              
              <div class="views-element-container"><div
              class="js-view-dom-id-70b0923f677edbe3dda361030ef8dc373cd0ca94065c39cfd81338de767f1019">

            <div class="nist-related-orgs"><div class="term-tree-list"><ul
            class="term"><li class="selected"><a
            href="https://www.nist.gov/nist-organizations/nist-headquarters" hreflang="en">NIST
            Headquarters</a><ul class="term"><li class="selected"><a
            href="https://www.nist.gov/nist-organizations/nist-headquarters/laboratory-programs"
            hreflang="en">Laboratory Programs</a><ul class="term"><li
            class="selected"><a
            href="https://www.nist.gov/nist-organizations/nist-headquarters/laboratory-programs/material-measurement-laboratory"
            hreflang="en">Material Measurement Laboratory</a>
			<ul
			class="term"><li
			class="selected"><a href="https://www.nist.gov/mml/msed"
			hreflang="en">Materials Science and Engineering
			Division</a></li><li
			class="selected"><a href="https://www.nist.gov/mml/ctcms"
			hreflang="en">Center for Theoretical and
			              Computational Materials Science</a></li></ul>
                          </li></ul></li></ul></li></ul></div></div>
          <div class="nist-related-orgs"></div>
          <div class="nist-related-orgs"></div>



        </div>
        </div>

          </div>


          <div data-layout-content-preview-placeholder-label="&quot;NIST
          Staff&quot; field" class="nist-block nist-block--contact">

          <h2 class="nist-block__title">NIST Staff</h2>

                  <div class="nist-field nist-field--label-hidden
                  nist-field--link-list entity-reference nist-field__items
                  nist-field--no-margin">
                            <div class="nist-field__item
                            nist-field--no-margin"><a
                            href="https://www.nist.gov/people/jonathan-e-guyer"
                            hreflang="en">Jonathan E. Guyer</a></div>
                                <div class="nist-field__item
                                nist-field--no-margin"><a
                                href="https://www.nist.gov/people/daniel-wheeler"
                                hreflang="en">Daniel Wheeler</a></div>
                                <div class="nist-field__item
                                nist-field--no-margin"><a
                                href="https://www.nist.gov/people/james-warren"
                                hreflang="en">James A. Warren</a></div>
                  </div>


          </div>

          <div data-layout-content-preview-placeholder-label="&quot;Contact&quot; field"
          class="nist-block nist-block--contact nist-block--mail">

          <h2 class="nist-block__title">
          <a class="" href="../docs/source/CONTACT.html" style="">Contact</a>
          </h2>

          </div>

</div>
        </div>
      </div>
      <div class="clearer"></div>
  </aside>
        </div>
      </div>

      <div class="panel-region--postface">
      <div class="inner region-inner inside">
        
<div class="pane pane--nist-node-date-pane" >

    </div>
      </div>
    </div>

        </section>
        </div>
      </div>

      </div>  
    </div>          

    </div>

  </div>

</div>


  


  <!-- Taken from https://www.filamentgroup.com/lab/html-includes/#another-demo%3A-including-another-html-file -->
  <iframe src="../_static/ntd2d_menu.html" onload="this.before((this.contentDocument.body||this.contentDocument).children[0]);this.remove()"></iframe>
    </div>
  </body>
</html>