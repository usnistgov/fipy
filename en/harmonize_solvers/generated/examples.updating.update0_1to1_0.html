
<!DOCTYPE html>


<!--[if IEMobile 7]><html class="iem7 no-js"  lang="en" dir="ltr"><![endif]-->
<!--[if lte IE 6]><html class="lt-ie9 lt-ie8 lt-ie7 no-js"  lang="en" dir="ltr"><![endif]-->
<!--[if (IE 7)&(!IEMobile)]><html class="lt-ie9 lt-ie8 no-js"  lang="en" dir="ltr"><![endif]-->
<!--[if IE 8]><html class="lt-ie9 no-js"  lang="en" dir="ltr"><![endif]-->
<!--[if (gte IE 9)|(gt IEMobile 7)]><!--><html class="no-js"  lang="en" dir="ltr" prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# book: http://ogp.me/ns/book# profile: http://ogp.me/ns/profile# video: http://ogp.me/ns/video# product: http://ogp.me/ns/product# content: http://purl.org/rss/1.0/modules/content/ dc: http://purl.org/dc/terms/ foaf: http://xmlns.com/foaf/0.1/ rdfs: http://www.w3.org/2000/01/rdf-schema# sioc: http://rdfs.org/sioc/ns# sioct: http://rdfs.org/sioc/types# skos: http://www.w3.org/2004/02/skos/core# xsd: http://www.w3.org/2001/XMLSchema#"><!--<![endif]-->

  <head>
<meta charset="utf-8" />
<link rel="shortcut icon" href="https://www.nist.gov/sites/all/themes/nist_style/favicon.ico" type="image/vnd.microsoft.icon" />
<script type="text/x-mathjax-config">MathJax.Hub.Config({
  extensions: ['tex2jax.js'],
  jax: ['input/TeX','output/HTML-CSS'],
  tex2jax: {
    inlineMath: [ ['$$','$$'], ['\\(','\\)'] ],
    processEscapes: true,
    processClass: 'tex2jax',
    ignoreClass: 'html'
  },
  showProcessingMessages: false,
  messageStyle: 'none'
});
</script>
<meta name="MobileOptimized" content="width">
    <meta name="HandheldFriendly" content="true">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=0">

      <!--[if lt IE 9]>
    <script src="https://www.nist.gov/sites/all/themes/zen/js/html5-respond.js"></script>
    <![endif]-->
    <!--[if (gte IE 6)&(lte IE 8)]>
  <script type="text/javascript" src="https://www.nist.gov/sites/all/themes/nist_style/js/selectivizr-min.js"></script>
  <![endif]--><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>examples.updating.update0_1to1_0 &#8212; FiPy 3.4.5+362.gffac540b2 documentation</title>
    <link rel="stylesheet" href="../_static/ntd2d.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/ntd2d.css?v=de7af573" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/widetable.css?v=32b6a719" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=90de1667"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="canonical" href="https://pages.nist.gov/fipy/en/latest/generated/examples.updating.update0_1to1_0.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="top" title="FiPy 3.4.5+362.gffac540b2 documentation" href="../contents.html" />
    <link rel="up" title="examples.updating" href="examples.updating.html" />
    <link rel="next" title="examples.updating.update1_0to2_0" href="examples.updating.update1_0to2_0.html" />
    <link rel="prev" title="examples.updating" href="examples.updating.html" />
  
 


  <link rel="stylesheet" href="https://pages.nist.gov/nist-header-footer/css/nist-combined.css">
  <script src="https://code.jquery.com/jquery-3.6.2.min.js" type="text/javascript" defer="defer"></script>
  <script src="https://pages.nist.gov/nist-header-footer/js/nist-header-footer.js" type="text/javascript" defer="defer"></script>


  </head>
<!--  <body role="document">-->
  <body class="html not-front not-logged-in no-sidebars page-node page-node- page-node-414011 node-type-software hide-breadcrumb section-services-resources page-panels is-panel" role="document">
      <div id="page" class="mini-header">



    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="examples.updating.update1_0to2_0.html" title="examples.updating.update1_0to2_0"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="examples.updating.html" title="examples.updating"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html"><img src="../_static/fipy.png" alt="FiPy logo"
                 style="vertical-align: middle; margin-top: -1px"/>
        FiPy</a> &gt;</li>

          <li class="nav-item nav-item-1"><a href="../API.html" ><code class="xref py py-mod docutils literal notranslate"><span class="pre">fipy</span></code> Package Documentation</a> &gt;</li>
          <li class="nav-item nav-item-2"><a href="examples.html" >examples</a> &gt;</li>
          <li class="nav-item nav-item-3"><a href="examples.updating.html" accesskey="U">examples.updating</a> &gt;</li> 
      </ul>
    </div>

  <div id="main" class="clearfix" role="main" tabindex="-1">
    <div class="main__inner">
      <div class="page-info">
        <a id="main-content"></a>
      </div>

      <div class="document">
        <div class="documentwrapper">

      <div id="content" class="column">
      <div id="block-nist-www-content" class="nist-block">
        <section class="nist-page__content usa-section clearfix">

         

        <div class="grid-container margin-top-4">
        <div class="grid-row grid-gap-6">

  <div class="nist-page__region nist-page__region--content tablet-lg:grid-col-8">
              <div class="body" role="main">
		
  <section id="module-examples.updating.update0_1to1_0">
<span id="examples-updating-update0-1to1-0"></span><h1>examples.updating.update0_1to1_0<a class="headerlink" href="#module-examples.updating.update0_1to1_0" title="Permalink to this heading">Â¶</a></h1>
<p>How to update scripts from version 0.1 to 1.0.</p>
<p>It seems unlikely that many users are still running <a class="reference internal" href="../glossary.html#term-FiPy"><span class="xref std std-term">FiPy</span></a> 0.1, but for those
that are, the syntax of <a class="reference internal" href="../glossary.html#term-FiPy"><span class="xref std std-term">FiPy</span></a> scripts changed considerably between version 0.1
and version 1.0.  We incremented the full version-number to stress
that previous scripts are incompatible.  We strongly believe that these
changes are for the better, resulting in easier code to write and read as
well as slightly improved efficiency, but we realize that this represents
an inconvenience to our users that have already written scripts of their
own.  We will strive to avoid any such incompatible changes in the future.</p>
<p>Any scripts you have written for <a class="reference internal" href="../glossary.html#term-FiPy"><span class="xref std std-term">FiPy</span></a> 0.1 should be updated in two steps,
first to work with <a class="reference internal" href="../glossary.html#term-FiPy"><span class="xref std std-term">FiPy</span></a> 1.0, and then with <a class="reference internal" href="../glossary.html#term-FiPy"><span class="xref std std-term">FiPy</span></a> 2.0. As a tutorial for
updating your scripts, we will walk through updating
<code class="file docutils literal notranslate"><span class="pre">examples/convection/exponential1D/input.py</span></code> from <a class="reference internal" href="../glossary.html#term-FiPy"><span class="xref std std-term">FiPy</span></a> 0.1. If you attempt to
run that script with <a class="reference internal" href="../glossary.html#term-FiPy"><span class="xref std std-term">FiPy</span></a> 1.0, the script will fail and you will see the
errors shown below:</p>
<hr class="docutils" />
<p>This example solves the steady-state convection-diffusion equation
given by:</p>
<div class="math notranslate nohighlight">
\[\nabla \cdot \left(D \nabla \phi + \vec{u} \phi \right) = 0\]</div>
<p>with coefficients <span class="math notranslate nohighlight">\(D = 1\)</span> and <span class="math notranslate nohighlight">\(\vec{u} = (10, 0)\)</span>, or</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">diffCoeff</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">convCoeff</span> <span class="o">=</span> <span class="p">(</span><span class="mf">10.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
</pre></div>
</div>
<p>We define a 1D mesh</p>
<div class="doctest highlight-default notranslate" id="index-0"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">L</span> <span class="o">=</span> <span class="mf">10.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nx</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ny</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">fipy.meshes.grid2D</span> <span class="kn">import</span> <span class="n">Grid2D</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">Grid2D</span><span class="p">(</span><span class="n">L</span> <span class="o">/</span> <span class="n">nx</span><span class="p">,</span> <span class="n">L</span> <span class="o">/</span> <span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">)</span>
</pre></div>
</div>
<p>and impose the boundary conditions</p>
<div class="math notranslate nohighlight">
\[\begin{split}\phi = \begin{cases}
0&amp; \text{at $x = 0$,} \\
1&amp; \text{at $x = L$,}
\end{cases}\end{split}\]</div>
<p>or</p>
<div class="doctest highlight-default notranslate" id="index-1"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">valueLeft</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">valueRight</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">fipy.boundaryConditions.fixedValue</span> <span class="kn">import</span> <span class="n">FixedValue</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">fipy.boundaryConditions.fixedFlux</span> <span class="kn">import</span> <span class="n">FixedFlux</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">boundaryConditions</span> <span class="o">=</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">FixedValue</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">getFacesLeft</span><span class="p">(),</span> <span class="n">valueLeft</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">FixedValue</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">getFacesRight</span><span class="p">(),</span> <span class="n">valueRight</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">FixedFlux</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">getFacesTop</span><span class="p">(),</span> <span class="mf">0.</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">FixedFlux</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">getFacesBottom</span><span class="p">(),</span> <span class="mf">0.</span><span class="p">)</span>
<span class="gp">... </span>    <span class="p">)</span>
</pre></div>
</div>
<p>The solution variable is initialized to <cite>valueLeft</cite>:</p>
<div class="doctest highlight-default notranslate" id="index-2"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">fipy.variables.cellVariable</span> <span class="kn">import</span> <span class="n">CellVariable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var</span> <span class="o">=</span> <span class="n">CellVariable</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;concentration&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">mesh</span> <span class="o">=</span> <span class="n">mesh</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">value</span> <span class="o">=</span> <span class="n">valueLeft</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">SteadyConvectionDiffusionScEquation</span></code> object is
used to create the equation.  It needs to be passed a convection term
instantiator as follows:</p>
<div class="doctest highlight-default notranslate" id="index-3"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">fipy.terms.exponentialConvectionTerm</span> <span class="kn">import</span> <span class="n">ExponentialConvectionTerm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">fipy.solvers</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">fipy.equations.stdyConvDiffScEquation</span> <span class="kn">import</span> <span class="n">SteadyConvectionDiffusionScEquation</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ImportError</span>: <span class="n">No module named equations.stdyConvDiffScEquation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span> <span class="o">=</span> <span class="n">SteadyConvectionDiffusionScEquation</span><span class="p">(</span>
<span class="gp">... </span>     <span class="n">var</span> <span class="o">=</span> <span class="n">var</span><span class="p">,</span>
<span class="gp">... </span>     <span class="n">diffusionCoeff</span> <span class="o">=</span> <span class="n">diffCoeff</span><span class="p">,</span>
<span class="gp">... </span>     <span class="n">convectionCoeff</span> <span class="o">=</span> <span class="n">convCoeff</span><span class="p">,</span>
<span class="gp">... </span>     <span class="n">solver</span> <span class="o">=</span> <span class="n">LinearLUSolver</span><span class="p">(</span><span class="n">tolerance</span> <span class="o">=</span> <span class="mf">1.e-15</span><span class="p">,</span> <span class="n">steps</span> <span class="o">=</span> <span class="mi">2000</span><span class="p">),</span>
<span class="gp">... </span>     <span class="n">convectionScheme</span> <span class="o">=</span> <span class="n">ExponentialConvectionTerm</span><span class="p">,</span>
<span class="gp">... </span>     <span class="n">boundaryConditions</span> <span class="o">=</span> <span class="n">boundaryConditions</span>
<span class="gp">... </span>     <span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NameError</span>: <span class="n">name &#39;SteadyConvectionDiffusionScEquation&#39; is not defined</span>
</pre></div>
</div>
<p>More details of the benefits and drawbacks of each type of convection
term can be found in the numerical section of the manual. Essentially
the <a class="reference internal" href="fipy.terms.exponentialConvectionTerm.html#fipy.terms.exponentialConvectionTerm.ExponentialConvectionTerm" title="fipy.terms.exponentialConvectionTerm.ExponentialConvectionTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExponentialConvectionTerm</span></code></a> and <a class="reference internal" href="fipy.terms.powerLawConvectionTerm.html#fipy.terms.powerLawConvectionTerm.PowerLawConvectionTerm" title="fipy.terms.powerLawConvectionTerm.PowerLawConvectionTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">PowerLawConvectionTerm</span></code></a> will both
handle most types of convection diffusion cases with the
<a class="reference internal" href="fipy.terms.powerLawConvectionTerm.html#fipy.terms.powerLawConvectionTerm.PowerLawConvectionTerm" title="fipy.terms.powerLawConvectionTerm.PowerLawConvectionTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">PowerLawConvectionTerm</span></code></a> being more efficient.</p>
<p>We iterate to equilibrium</p>
<div class="doctest highlight-default notranslate" id="index-4"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">fipy.iterators.iterator</span> <span class="kn">import</span> <span class="n">Iterator</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">it</span> <span class="o">=</span> <span class="n">Iterator</span><span class="p">((</span><span class="n">eq</span><span class="p">,))</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NameError</span>: <span class="n">name &#39;eq&#39; is not defined</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">it</span><span class="o">.</span><span class="n">timestep</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NameError</span>: <span class="n">name &#39;it&#39; is not defined</span>
</pre></div>
</div>
<p>and test the solution against the analytical result</p>
<div class="math notranslate nohighlight">
\[\phi = \frac{1 - \exp(-u_x x / D)}{1 - \exp(-u_x L / D)}\]</div>
<p>or</p>
<div class="doctest highlight-default notranslate" id="index-5"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">getCellCenters</span><span class="p">()[:,</span> <span class="n">axis</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">fipy.tools</span> <span class="kn">import</span> <span class="n">numerix</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">CC</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">numerix</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">convCoeff</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span> <span class="o">/</span> <span class="n">diffCoeff</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">DD</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">numerix</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">convCoeff</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">*</span> <span class="n">L</span> <span class="o">/</span> <span class="n">diffCoeff</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">analyticalArray</span> <span class="o">=</span> <span class="n">CC</span> <span class="o">/</span> <span class="n">DD</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">numerix</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">analyticalArray</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">rtol</span> <span class="o">=</span> <span class="mf">1e-10</span><span class="p">,</span> <span class="n">atol</span> <span class="o">=</span> <span class="mf">1e-10</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<p>If the problem is run interactively, we can view the result:</p>
<div class="doctest highlight-default notranslate" id="index-6"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<span class="gp">... </span>    <span class="kn">from</span> <span class="nn">fipy.viewers.grid2DGistViewer</span> <span class="kn">import</span> <span class="n">Grid2DGistViewer</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ImportError</span>: <span class="n">No module named grid2DGistViewer</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">...</span>     <span class="n">viewer</span> <span class="o">=</span> <span class="n">Grid2DGistViewer</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">viewer</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<hr class="docutils" />
<p>We see that a number of errors are thrown:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="xref py py-exc docutils literal notranslate"><span class="pre">ImportError:</span> <span class="pre">No</span> <span class="pre">module</span> <span class="pre">named</span> <span class="pre">equations.stdyConvDiffScEquation</span></code></p></li>
<li><p><code class="xref py py-exc docutils literal notranslate"><span class="pre">NameError:</span> <span class="pre">name</span> <span class="pre">'SteadyConvectionDiffusionScEquation'</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">defined</span></code></p></li>
<li><p><code class="xref py py-exc docutils literal notranslate"><span class="pre">NameError:</span> <span class="pre">name</span> <span class="pre">'eq'</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">defined</span></code></p></li>
<li><p><code class="xref py py-exc docutils literal notranslate"><span class="pre">NameError:</span> <span class="pre">name</span> <span class="pre">'it'</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">defined</span></code></p></li>
<li><p><code class="xref py py-exc docutils literal notranslate"><span class="pre">ImportError:</span> <span class="pre">No</span> <span class="pre">module</span> <span class="pre">named</span> <span class="pre">grid2DGistViewer</span></code></p></li>
</ul>
</div></blockquote>
<p>As is usually the case with computer programming, many of these errors are
caused by earlier errors.  Let us update the script, section by
section:</p>
<p>Although no error was generated by the use of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grid2D</span></code>, <a class="reference internal" href="../glossary.html#term-FiPy"><span class="xref std std-term">FiPy</span></a> 1.0 supports
a true 1D mesh class, so we instantiate the mesh as</p>
<div class="doctest highlight-default notranslate" id="index-7"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">L</span> <span class="o">=</span> <span class="mf">10.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nx</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">fipy.meshes.grid1D</span> <span class="kn">import</span> <span class="n">Grid1D</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">Grid1D</span><span class="p">(</span><span class="n">dx</span> <span class="o">=</span> <span class="n">L</span> <span class="o">/</span> <span class="n">nx</span><span class="p">,</span> <span class="n">nx</span> <span class="o">=</span> <span class="n">nx</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">Grid2D</span></code> class with <cite>ny = 1</cite> still works perfectly well for 1D
problems, but the <code class="xref py py-class docutils literal notranslate"><span class="pre">Grid1D</span></code> class is slightly more efficient, and it makes
the code clearer when a 1D geometry is actually desired.</p>
<p>Because the mesh is now 1D, we must update the convection coefficient
vector to be 1D as well</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">diffCoeff</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">convCoeff</span> <span class="o">=</span> <span class="p">(</span><span class="mf">10.</span><span class="p">,)</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="fipy.boundaryConditions.fixedValue.html#fipy.boundaryConditions.fixedValue.FixedValue" title="fipy.boundaryConditions.fixedValue.FixedValue"><code class="xref py py-class docutils literal notranslate"><span class="pre">FixedValue</span></code></a> boundary conditions at the left and right are unchanged,
but a <cite>Grid1D</cite> mesh does not even have top and bottom faces:</p>
<div class="doctest highlight-default notranslate" id="index-8"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">valueLeft</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">valueRight</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">fipy.boundaryConditions.fixedValue</span> <span class="kn">import</span> <span class="n">FixedValue</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">boundaryConditions</span> <span class="o">=</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">FixedValue</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">getFacesLeft</span><span class="p">(),</span> <span class="n">valueLeft</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">FixedValue</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">getFacesRight</span><span class="p">(),</span> <span class="n">valueRight</span><span class="p">))</span>
</pre></div>
</div>
<p>The creation of the solution variable is unchanged:</p>
<div class="doctest highlight-default notranslate" id="index-9"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">fipy.variables.cellVariable</span> <span class="kn">import</span> <span class="n">CellVariable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var</span> <span class="o">=</span> <span class="n">CellVariable</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;concentration&quot;</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="n">mesh</span> <span class="o">=</span> <span class="n">mesh</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="n">value</span> <span class="o">=</span> <span class="n">valueLeft</span><span class="p">)</span>
</pre></div>
</div>
<p>The biggest change between <a class="reference internal" href="../glossary.html#term-FiPy"><span class="xref std std-term">FiPy</span></a> 0.1 and <a class="reference internal" href="../glossary.html#term-FiPy"><span class="xref std std-term">FiPy</span></a> 1.0 is that <code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code>
objects no longer exist at all.  Instead, <a class="reference internal" href="fipy.terms.term.html#fipy.terms.term.Term" title="fipy.terms.term.Term"><code class="xref py py-class docutils literal notranslate"><span class="pre">Term</span></code></a> objects can be simply
added, subtracted, and equated to assemble an equation.  Where before the
assembly of the equation occurred in the black-box of
<code class="xref py py-class docutils literal notranslate"><span class="pre">SteadyConvectionDiffusionScEquation</span></code>, we now assemble it directly:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">fipy.terms.implicitDiffusionTerm</span> <span class="kn">import</span> <span class="n">ImplicitDiffusionTerm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diffTerm</span> <span class="o">=</span> <span class="n">ImplicitDiffusionTerm</span><span class="p">(</span><span class="n">coeff</span> <span class="o">=</span> <span class="n">diffCoeff</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">fipy.terms.exponentialConvectionTerm</span> <span class="kn">import</span> <span class="n">ExponentialConvectionTerm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span> <span class="o">=</span> <span class="n">diffTerm</span> <span class="o">+</span> <span class="n">ExponentialConvectionTerm</span><span class="p">(</span><span class="n">coeff</span> <span class="o">=</span> <span class="n">convCoeff</span><span class="p">,</span>
<span class="gp">... </span>                                          <span class="n">diffusionTerm</span> <span class="o">=</span> <span class="n">diffTerm</span><span class="p">)</span>
</pre></div>
</div>
<p>One thing that <code class="xref py py-class docutils literal notranslate"><span class="pre">SteadyConvectionDiffusionScEquation</span></code> took care of
automatically was that a <code class="xref py py-class docutils literal notranslate"><span class="pre">ConvectionTerm</span></code> must know about any
<a class="reference internal" href="fipy.terms.diffusionTerm.html#fipy.terms.diffusionTerm.DiffusionTerm" title="fipy.terms.diffusionTerm.DiffusionTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiffusionTerm</span></code></a> in the equation in order to calculate a PÃ©clet number.
Now, the <a class="reference internal" href="fipy.terms.diffusionTerm.html#fipy.terms.diffusionTerm.DiffusionTerm" title="fipy.terms.diffusionTerm.DiffusionTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiffusionTerm</span></code></a> must be explicitly passed to the <code class="xref py py-class docutils literal notranslate"><span class="pre">ConvectionTerm</span></code>
in the <cite>diffusionTerm</cite> parameter.</p>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">Iterator</span></code> class still exists, but it is no longer necessary.  Instead,
the solution to an implicit steady-state problem like this can simply be
obtained by telling the equation to solve itself (with an appropriate
<cite>solver</cite> if desired, although the default <a class="reference internal" href="fipy.solvers.pysparse.linearPCGSolver.html#fipy.solvers.pysparse.linearPCGSolver.LinearPCGSolver" title="fipy.solvers.pysparse.linearPCGSolver.LinearPCGSolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinearPCGSolver</span></code></a> is usually
suitable):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">fipy.solvers</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">var</span> <span class="o">=</span> <span class="n">var</span><span class="p">,</span>
<span class="gp">... </span>         <span class="n">solver</span> <span class="o">=</span> <span class="n">LinearLUSolver</span><span class="p">(</span><span class="n">tolerance</span> <span class="o">=</span> <span class="mf">1.e-15</span><span class="p">,</span> <span class="n">steps</span> <span class="o">=</span> <span class="mi">2000</span><span class="p">),</span>
<span class="gp">... </span>         <span class="n">boundaryConditions</span> <span class="o">=</span> <span class="n">boundaryConditions</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In version 0.1, the <code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object had to be
told about the <a class="reference internal" href="fipy.variables.variable.html#fipy.variables.variable.Variable" title="fipy.variables.variable.Variable"><code class="xref py py-class docutils literal notranslate"><span class="pre">Variable</span></code></a>, <a class="reference internal" href="fipy.solvers.solver.html#fipy.solvers.solver.Solver" title="fipy.solvers.solver.Solver"><code class="xref py py-class docutils literal notranslate"><span class="pre">Solver</span></code></a>,
and <a class="reference internal" href="fipy.boundaryConditions.boundaryCondition.html#fipy.boundaryConditions.boundaryCondition.BoundaryCondition" title="fipy.boundaryConditions.boundaryCondition.BoundaryCondition"><code class="xref py py-class docutils literal notranslate"><span class="pre">BoundaryCondition</span></code></a> objects
when it was created (and it, in turn, passed much of this information to
the <a class="reference internal" href="fipy.terms.term.html#fipy.terms.term.Term" title="fipy.terms.term.Term"><code class="xref py py-class docutils literal notranslate"><span class="pre">Term</span></code></a> objects in order to create them). In version
1.0, the <a class="reference internal" href="fipy.terms.term.html#fipy.terms.term.Term" title="fipy.terms.term.Term"><code class="xref py py-class docutils literal notranslate"><span class="pre">Term</span></code></a> objects (and the equation assembled
from them) are abstract.
The <a class="reference internal" href="fipy.variables.variable.html#fipy.variables.variable.Variable" title="fipy.variables.variable.Variable"><code class="xref py py-class docutils literal notranslate"><span class="pre">Variable</span></code></a>, <a class="reference internal" href="fipy.solvers.solver.html#fipy.solvers.solver.Solver" title="fipy.solvers.solver.Solver"><code class="xref py py-class docutils literal notranslate"><span class="pre">Solver</span></code></a>,
and <a class="reference internal" href="fipy.boundaryConditions.boundaryCondition.html#fipy.boundaryConditions.boundaryCondition.BoundaryCondition" title="fipy.boundaryConditions.boundaryCondition.BoundaryCondition"><code class="xref py py-class docutils literal notranslate"><span class="pre">BoundaryCondition</span></code></a> objects
are only needed by the <code class="xref py py-meth docutils literal notranslate"><span class="pre">solve()</span></code> method (and, in fact, the same equation
could be used to solve different variables, with different solvers, subject
to different boundary conditions, if desired).</p>
</div>
<p>The analytical solution is unchanged, and we can test as before</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">numerix</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">analyticalArray</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">rtol</span> <span class="o">=</span> <span class="mf">1e-10</span><span class="p">,</span> <span class="n">atol</span> <span class="o">=</span> <span class="mf">1e-10</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<p>or we can use the slightly simpler syntax</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">analyticalArray</span><span class="p">,</span> <span class="n">rtol</span> <span class="o">=</span> <span class="mf">1e-10</span><span class="p">,</span> <span class="n">atol</span> <span class="o">=</span> <span class="mf">1e-10</span><span class="p">))</span>
<span class="go">1</span>
</pre></div>
</div>
<p>The <code class="xref py py-exc docutils literal notranslate"><span class="pre">ImportError:</span> <span class="pre">No</span> <span class="pre">module</span> <span class="pre">named</span> <span class="pre">grid2DGistViewer</span></code> results because the
<code class="xref py py-class docutils literal notranslate"><span class="pre">Viewer</span></code> classes have been moved and renamed.  This error could be resolved
by changing the <cite>import</cite> statement appropriately:</p>
<div class="doctest highlight-default notranslate" id="index-10"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<span class="gp">... </span>    <span class="kn">from</span> <span class="nn">fipy.viewers.gistViewer.gist1DViewer</span> <span class="kn">import</span> <span class="n">Gist1DViewer</span>
<span class="gp">... </span>    <span class="n">viewer</span> <span class="o">=</span> <span class="n">Gist1DViewer</span><span class="p">(</span><span class="nb">vars</span> <span class="o">=</span> <span class="n">var</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">viewer</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>Instead, rather than instantiating a particular <code class="xref py py-class docutils literal notranslate"><span class="pre">Viewer</span></code> (which you can
still do, if you desire), a generic âfactoryâ method will return a <code class="xref py py-class docutils literal notranslate"><span class="pre">Viewer</span></code>
appropriate for the supplied <cite>Variable</cite> object(s):</p>
<div class="doctest highlight-default notranslate" id="index-11"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<span class="gp">... </span>    <span class="kn">import</span> <span class="nn">fipy.viewers</span>
<span class="gp">... </span>    <span class="n">viewer</span> <span class="o">=</span> <span class="n">fipy</span><span class="o">.</span><span class="n">viewers</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="nb">vars</span> <span class="o">=</span> <span class="n">var</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">viewer</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>Please do not hesitate to contact us if this example does not help you
convert your existing scripts to <a class="reference internal" href="../glossary.html#term-FiPy"><span class="xref std std-term">FiPy</span></a> 1.0.</p>
</section>


                <div class='last-updated'>
                Last updated on Jul 03, 2025.
                Created using <a href="http://sphinx-doc.org/">Sphinx</a> 7.1.2.
                </div>
              </div>
  </div>  
  <aside class="nist-page__region nist-page__region--sidebar-second tablet-lg:grid-col-4">
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">

<strong>FiPy: A Finite Volume PDE Solver Using Python</strong><br />
Version 3.4.5+362.gffac540b2

<div class="sphinxsidebarsection">
  <h4>Previous topic</h4>
  <p class="topless"><a href="examples.updating.html"
                        title="previous chapter">examples.updating</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="examples.updating.update1_0to2_0.html"
                        title="next chapter">examples.updating.update1_0to2_0</a></p>
</div>
  <div class="sphinxsidebarsection">
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/generated/examples.updating.update0_1to1_0.rst.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
  </div>
<div class="sphinxsidebarsection">
<div id="searchbox" style="display: none" role="search">
  <div data-layout-content-preview-placeholder-label="&quot;Sphinx
  Search&quot; field" class="nist-block nist-block--search">
  <h2 id="searchlabel">Quick search</h2>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
  </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
</div>
<div class="sphinxsidebarsection" id="contact-wrapper">
  
        <div data-layout-content-preview-placeholder-label="&quot;Related
        organization tree&quot; views block" class="nist-block nist-block--org">
          
          <h2 class="nist-block__title">Organizations</h2>
              
              <div class="views-element-container"><div
              class="js-view-dom-id-70b0923f677edbe3dda361030ef8dc373cd0ca94065c39cfd81338de767f1019">

            <div class="nist-related-orgs"><div class="term-tree-list"><ul
            class="term"><li class="selected"><a
            href="https://www.nist.gov/nist-organizations/nist-headquarters" hreflang="en">NIST
            Headquarters</a><ul class="term"><li class="selected"><a
            href="https://www.nist.gov/nist-organizations/nist-headquarters/laboratory-programs"
            hreflang="en">Laboratory Programs</a><ul class="term"><li
            class="selected"><a
            href="https://www.nist.gov/nist-organizations/nist-headquarters/laboratory-programs/material-measurement-laboratory"
            hreflang="en">Material Measurement Laboratory</a>
			<ul
			class="term"><li
			class="selected"><a href="https://www.nist.gov/mml/msed"
			hreflang="en">Materials Science and Engineering
			Division</a></li><li
			class="selected"><a href="https://www.nist.gov/mml/ctcms"
			hreflang="en">Center for Theoretical and
			              Computational Materials Science</a></li></ul>
                          </li></ul></li></ul></li></ul></div></div>
          <div class="nist-related-orgs"></div>
          <div class="nist-related-orgs"></div>



        </div>
        </div>

          </div>


          <div data-layout-content-preview-placeholder-label="&quot;NIST
          Staff&quot; field" class="nist-block nist-block--contact">

          <h2 class="nist-block__title">NIST Staff</h2>

                  <div class="nist-field nist-field--label-hidden
                  nist-field--link-list entity-reference nist-field__items
                  nist-field--no-margin">
                            <div class="nist-field__item
                            nist-field--no-margin"><a
                            href="https://www.nist.gov/people/jonathan-e-guyer"
                            hreflang="en">Jonathan E. Guyer</a></div>
                                <div class="nist-field__item
                                nist-field--no-margin"><a
                                href="https://www.nist.gov/people/daniel-wheeler"
                                hreflang="en">Daniel Wheeler</a></div>
                                <div class="nist-field__item
                                nist-field--no-margin"><a
                                href="https://www.nist.gov/people/james-warren"
                                hreflang="en">James A. Warren</a></div>
                  </div>


          </div>

          <div data-layout-content-preview-placeholder-label="&quot;Contact&quot; field"
          class="nist-block nist-block--contact nist-block--mail">

          <h2 class="nist-block__title">
          <a class="" href="../docs/source/CONTACT.html" style="">Contact</a>
          </h2>

          </div>

</div>
        </div>
      </div>
      <div class="clearer"></div>
  </aside>
        </div>
      </div>

      <div class="panel-region--postface">
      <div class="inner region-inner inside">
        
<div class="pane pane--nist-node-date-pane" >

    </div>
      </div>
    </div>

        </section>
        </div>
      </div>

      </div>  
    </div>          

    </div>

  </div>

</div>


  


  <!-- Taken from https://www.filamentgroup.com/lab/html-includes/#another-demo%3A-including-another-html-file -->
  <iframe src="../_static/ntd2d_menu.html" onload="this.before((this.contentDocument.body||this.contentDocument).children[0]);this.remove()"></iframe>
    </div>
  </body>
</html>