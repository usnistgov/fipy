
<!DOCTYPE html>


<!--[if IEMobile 7]><html class="iem7 no-js"  lang="en" dir="ltr"><![endif]-->
<!--[if lte IE 6]><html class="lt-ie9 lt-ie8 lt-ie7 no-js"  lang="en" dir="ltr"><![endif]-->
<!--[if (IE 7)&(!IEMobile)]><html class="lt-ie9 lt-ie8 no-js"  lang="en" dir="ltr"><![endif]-->
<!--[if IE 8]><html class="lt-ie9 no-js"  lang="en" dir="ltr"><![endif]-->
<!--[if (gte IE 9)|(gt IEMobile 7)]><!--><html class="no-js"  lang="en" dir="ltr" prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# book: http://ogp.me/ns/book# profile: http://ogp.me/ns/profile# video: http://ogp.me/ns/video# product: http://ogp.me/ns/product# content: http://purl.org/rss/1.0/modules/content/ dc: http://purl.org/dc/terms/ foaf: http://xmlns.com/foaf/0.1/ rdfs: http://www.w3.org/2000/01/rdf-schema# sioc: http://rdfs.org/sioc/ns# sioct: http://rdfs.org/sioc/types# skos: http://www.w3.org/2004/02/skos/core# xsd: http://www.w3.org/2001/XMLSchema#"><!--<![endif]-->

  <head>
<meta charset="utf-8" />
<link rel="shortcut icon" href="https://www.nist.gov/sites/all/themes/nist_style/favicon.ico" type="image/vnd.microsoft.icon" />
<script type="text/x-mathjax-config">MathJax.Hub.Config({
  extensions: ['tex2jax.js'],
  jax: ['input/TeX','output/HTML-CSS'],
  tex2jax: {
    inlineMath: [ ['$$','$$'], ['\\(','\\)'] ],
    processEscapes: true,
    processClass: 'tex2jax',
    ignoreClass: 'html'
  },
  showProcessingMessages: false,
  messageStyle: 'none'
});
</script>
<meta name="MobileOptimized" content="width">
    <meta name="HandheldFriendly" content="true">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=0">

      <!--[if lt IE 9]>
    <script src="https://www.nist.gov/sites/all/themes/zen/js/html5-respond.js"></script>
    <![endif]-->
    <!--[if (gte IE 6)&(lte IE 8)]>
  <script type="text/javascript" src="https://www.nist.gov/sites/all/themes/nist_style/js/selectivizr-min.js"></script>
  <![endif]--><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>examples.levelSet.electroChem.howToWriteAScript &#8212; FiPy 3.4.5+347.g24c7a036d documentation</title>
    <link rel="stylesheet" href="../_static/ntd2d.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/ntd2d.css?v=de7af573" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/widetable.css?v=32b6a719" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=dbc51956"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="canonical" href="https://pages.nist.gov/fipy/en/latest/generated/examples.levelSet.electroChem.howToWriteAScript.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="top" title="FiPy 3.4.5+347.g24c7a036d documentation" href="../contents.html" />
    <link rel="up" title="examples.levelSet.electroChem" href="examples.levelSet.electroChem.html" />
    <link rel="next" title="examples.levelSet.electroChem.leveler" href="examples.levelSet.electroChem.leveler.html" />
    <link rel="prev" title="examples.levelSet.electroChem.gold" href="examples.levelSet.electroChem.gold.html" />
  
 


  <link rel="stylesheet" href="https://pages.nist.gov/nist-header-footer/css/nist-combined.css">
  <script src="https://code.jquery.com/jquery-3.6.2.min.js" type="text/javascript" defer="defer"></script>
  <script src="https://pages.nist.gov/nist-header-footer/js/nist-header-footer.js" type="text/javascript" defer="defer"></script>


  </head>
<!--  <body role="document">-->
  <body class="html not-front not-logged-in no-sidebars page-node page-node- page-node-414011 node-type-software hide-breadcrumb section-services-resources page-panels is-panel" role="document">
      <div id="page" class="mini-header">



    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="examples.levelSet.electroChem.leveler.html" title="examples.levelSet.electroChem.leveler"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="examples.levelSet.electroChem.gold.html" title="examples.levelSet.electroChem.gold"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html"><img src="../_static/fipy.png" alt="FiPy logo"
                 style="vertical-align: middle; margin-top: -1px"/>
        FiPy</a> &gt;</li>

          <li class="nav-item nav-item-1"><a href="../API.html" ><code class="xref py py-mod docutils literal notranslate"><span class="pre">fipy</span></code> Package Documentation</a> &gt;</li>
          <li class="nav-item nav-item-2"><a href="examples.html" >examples</a> &gt;</li>
          <li class="nav-item nav-item-3"><a href="examples.levelSet.html" >examples.levelSet</a> &gt;</li>
          <li class="nav-item nav-item-4"><a href="examples.levelSet.electroChem.html" accesskey="U">examples.levelSet.electroChem</a> &gt;</li> 
      </ul>
    </div>

  <div id="main" class="clearfix" role="main" tabindex="-1">
    <div class="main__inner">
      <div class="page-info">
        <a id="main-content"></a>
      </div>

      <div class="document">
        <div class="documentwrapper">

      <div id="content" class="column">
      <div id="block-nist-www-content" class="nist-block">
        <section class="nist-page__content usa-section clearfix">

         

        <div class="grid-container margin-top-4">
        <div class="grid-row grid-gap-6">

  <div class="nist-page__region nist-page__region--content tablet-lg:grid-col-8">
              <div class="body" role="main">
		
  <section id="module-examples.levelSet.electroChem.howToWriteAScript">
<span id="examples-levelset-electrochem-howtowriteascript"></span><h1>examples.levelSet.electroChem.howToWriteAScript<a class="headerlink" href="#module-examples.levelSet.electroChem.howToWriteAScript" title="Permalink to this heading">Â¶</a></h1>
<p>Tutorial for writing an electrochemical superfill script.</p>
<p>This input file demonstrates how to
create a new superfill script if the existing suite of scripts do
not meet the required needs. It provides the functionality of
<a class="reference internal" href="examples.levelSet.electroChem.simpleTrenchSystem.html#module-examples.levelSet.electroChem.simpleTrenchSystem" title="examples.levelSet.electroChem.simpleTrenchSystem"><code class="xref py py-mod docutils literal notranslate"><span class="pre">examples.levelSet.electroChem.simpleTrenchSystem</span></code></a>.</p>
<p>To run this example from the base FiPy directory type:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ python examples/levelSet/electroChem/howToWriteAScript.py --numberOfElements=10000 --numberOfSteps=800
</pre></div>
</div>
<p>at the command line. The results of the simulation will be displayed
and the word <code class="docutils literal notranslate"><span class="pre">finished</span></code> in the terminal at the end of the
simulation. To obtain this example in a plain script file in order to
edit and run type:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ python setup.py copy_script --From examples/levelSet/electroChem/howToWriteAScript.py --To myScript.py
</pre></div>
</div>
<p>in the base <a class="reference internal" href="../glossary.html#term-FiPy"><span class="xref std std-term">FiPy</span></a> directory. The file <code class="file docutils literal notranslate"><span class="pre">myScript.py</span></code> will contain the
script.</p>
<p>The following is an explicit explanation of the input commands
required to set up and run the problem. At the top of the file all the
parameter values are set. Their use will be explained during the
instantiation of various objects and are the same as those explained in
<a class="reference internal" href="examples.levelSet.electroChem.simpleTrenchSystem.html#module-examples.levelSet.electroChem.simpleTrenchSystem" title="examples.levelSet.electroChem.simpleTrenchSystem"><code class="xref py py-mod docutils literal notranslate"><span class="pre">examples.levelSet.electroChem.simpleTrenchSystem</span></code></a>.</p>
<p>The following parameters (all in S.I. units)  represent,</p>
<blockquote>
<div><ul>
<li><p>physical constants,</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">faradaysConstant</span> <span class="o">=</span> <span class="mf">9.6e4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gasConstant</span> <span class="o">=</span> <span class="mf">8.314</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">transferCoefficient</span> <span class="o">=</span> <span class="mf">0.5</span>
</pre></div>
</div>
</li>
<li><p>properties associated with the catalyst species,</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rateConstant0</span> <span class="o">=</span> <span class="mf">1.76</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rateConstant3</span> <span class="o">=</span> <span class="o">-</span><span class="mf">245e-6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">catalystDiffusion</span> <span class="o">=</span> <span class="mf">1e-9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">siteDensity</span> <span class="o">=</span> <span class="mf">9.8e-6</span>
</pre></div>
</div>
</li>
<li><p>properties of the cupric ions,</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molarVolume</span> <span class="o">=</span> <span class="mf">7.1e-6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">charge</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metalDiffusionCoefficient</span> <span class="o">=</span> <span class="mf">5.6e-10</span>
</pre></div>
</div>
</li>
<li><p>parameters dependent on experimental constraints,</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">298.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">overpotential</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bulkMetalConcentration</span> <span class="o">=</span> <span class="mf">250.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">catalystConcentration</span> <span class="o">=</span> <span class="mf">5e-3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">catalystCoverage</span> <span class="o">=</span> <span class="mf">0.</span>
</pre></div>
</div>
</li>
<li><p>parameters obtained from experiments on flat copper electrodes,</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">currentDensity0</span> <span class="o">=</span> <span class="mf">0.26</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">currentDensity1</span> <span class="o">=</span> <span class="mf">45.</span>
</pre></div>
</div>
</li>
<li><p>general simulation control parameters,</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cflNumber</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">numberOfCellsInNarrowBand</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cellsBelowTrench</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cellSize</span> <span class="o">=</span> <span class="mf">0.1e-7</span>
</pre></div>
</div>
</li>
<li><p>parameters required for a trench geometry,</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">trenchDepth</span> <span class="o">=</span> <span class="mf">0.5e-6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aspectRatio</span> <span class="o">=</span> <span class="mf">2.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trenchSpacing</span> <span class="o">=</span> <span class="mf">0.6e-6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">boundaryLayerDepth</span> <span class="o">=</span> <span class="mf">0.3e-6</span>
</pre></div>
</div>
</li>
</ul>
</div></blockquote>
<p>The hydrodynamic boundary layer depth (<code class="docutils literal notranslate"><span class="pre">boundaryLayerDepth</span></code>) is
intentionally small in this example to keep the mesh at a reasonable
size.</p>
<p>Build the mesh:</p>
<div class="doctest highlight-default notranslate" id="index-0"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">fipy.tools.parser</span> <span class="kn">import</span> <span class="n">parse</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">numberOfElements</span> <span class="o">=</span> <span class="n">parse</span><span class="p">(</span><span class="s1">&#39;--numberOfElements&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">numberOfSteps</span> <span class="o">=</span> <span class="n">parse</span><span class="p">(</span><span class="s1">&#39;--numberOfSteps&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate" id="index-1"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">fipy</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">numberOfElements</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">pos</span> <span class="o">=</span> <span class="n">trenchSpacing</span> <span class="o">*</span> <span class="n">cellsBelowTrench</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">/</span> <span class="n">numberOfElements</span>
<span class="gp">... </span>    <span class="n">sqr</span> <span class="o">=</span> <span class="n">trenchSpacing</span> <span class="o">*</span> <span class="p">(</span><span class="n">trenchDepth</span> <span class="o">+</span> <span class="n">boundaryLayerDepth</span><span class="p">)</span> \
<span class="gp">... </span>          <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">numberOfElements</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">cellSize</span> <span class="o">=</span> <span class="n">pos</span> <span class="o">+</span> <span class="n">numerix</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pos</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sqr</span><span class="p">)</span>
<span class="gp">... </span><span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">cellSize</span> <span class="o">=</span> <span class="mf">0.1e-7</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">yCells</span> <span class="o">=</span> <span class="n">cellsBelowTrench</span> \
<span class="gp">... </span>         <span class="o">+</span> <span class="nb">int</span><span class="p">((</span><span class="n">trenchDepth</span> <span class="o">+</span> <span class="n">boundaryLayerDepth</span><span class="p">)</span> <span class="o">/</span> <span class="n">cellSize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xCells</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">trenchSpacing</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">cellSize</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate" id="index-2"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.metalIonDiffusionEquation</span> <span class="kn">import</span> <span class="n">buildMetalIonDiffusionEquation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.adsorbingSurfactantEquation</span> <span class="kn">import</span> <span class="n">AdsorbingSurfactantEquation</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">fipy</span> <span class="kn">import</span> <span class="n">serialComm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">Grid2D</span><span class="p">(</span><span class="n">dx</span><span class="o">=</span><span class="n">cellSize</span><span class="p">,</span>
<span class="gp">... </span>              <span class="n">dy</span><span class="o">=</span><span class="n">cellSize</span><span class="p">,</span>
<span class="gp">... </span>              <span class="n">nx</span><span class="o">=</span><span class="n">xCells</span><span class="p">,</span>
<span class="gp">... </span>              <span class="n">ny</span><span class="o">=</span><span class="n">yCells</span><span class="p">,</span>
<span class="gp">... </span>              <span class="n">communicator</span><span class="o">=</span><span class="n">serialComm</span><span class="p">)</span>
</pre></div>
</div>
<p>A <code class="docutils literal notranslate"><span class="pre">distanceVariable</span></code> object,
<span class="math notranslate nohighlight">\(\phi\)</span>, is  required to store  the  position of the interface.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">distanceVariable</span></code> calculates its value so that it is a distance
function
(<em>i.e.</em> holds the distance at any point in the mesh from the electrolyte/metal
interface at <span class="math notranslate nohighlight">\(\phi = 0\)</span>) and <span class="math notranslate nohighlight">\(|\nabla\phi| = 1\)</span>.</p>
<p>First, create the <span class="math notranslate nohighlight">\(\phi\)</span> variable, which is initially set to -1 everywhere.
Create an initial variable,</p>
<div class="doctest highlight-default notranslate" id="index-3"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">narrowBandWidth</span> <span class="o">=</span> <span class="n">numberOfCellsInNarrowBand</span> <span class="o">*</span> <span class="n">cellSize</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">distanceVar</span> <span class="o">=</span> <span class="n">DistanceVariable</span><span class="p">(</span>
<span class="gp">... </span>   <span class="n">name</span><span class="o">=</span><span class="s1">&#39;distance variable&#39;</span><span class="p">,</span>
<span class="gp">... </span>   <span class="n">mesh</span><span class="o">=</span> <span class="n">mesh</span><span class="p">,</span>
<span class="gp">... </span>   <span class="n">value</span><span class="o">=-</span><span class="mf">1.</span><span class="p">,</span>
<span class="gp">... </span>   <span class="n">hasOld</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>The electrolyte region will be the positive region of the domain while the metal
region will be negative.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bottomHeight</span> <span class="o">=</span> <span class="n">cellsBelowTrench</span> <span class="o">*</span> <span class="n">cellSize</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trenchHeight</span> <span class="o">=</span> <span class="n">bottomHeight</span> <span class="o">+</span> <span class="n">trenchDepth</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trenchWidth</span> <span class="o">=</span> <span class="n">trenchDepth</span> <span class="o">/</span> <span class="n">aspectRatio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sideWidth</span> <span class="o">=</span> <span class="p">(</span><span class="n">trenchSpacing</span> <span class="o">-</span> <span class="n">trenchWidth</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">cellCenters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">distanceVar</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="p">(</span><span class="n">y</span> <span class="o">&gt;</span> <span class="n">trenchHeight</span><span class="p">)</span>
<span class="gp">... </span>                                <span class="o">|</span> <span class="p">((</span><span class="n">y</span> <span class="o">&gt;</span> <span class="n">bottomHeight</span><span class="p">)</span>
<span class="gp">... </span>                                   <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">xCells</span> <span class="o">*</span> <span class="n">cellSize</span> <span class="o">-</span> <span class="n">sideWidth</span><span class="p">)))</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">distanceVar</span><span class="o">.</span><span class="n">calcDistanceFunction</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> 
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">distanceVariable</span></code> has now been created to mark the interface. Some other
variables need to be created that govern the concentrations of various species.</p>
<p>Create the catalyst surfactant coverage, <span class="math notranslate nohighlight">\(\theta\)</span>, variable.
This variable influences the deposition rate.</p>
<div class="doctest highlight-default notranslate" id="index-4"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">catalystVar</span> <span class="o">=</span> <span class="n">SurfactantVariable</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;catalyst variable&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">value</span><span class="o">=</span><span class="n">catalystCoverage</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">distanceVar</span><span class="o">=</span><span class="n">distanceVar</span><span class="p">)</span>
</pre></div>
</div>
<p>Create the bulk catalyst concentration, <span class="math notranslate nohighlight">\(c_{\theta}\)</span>,
in the electrolyte,</p>
<div class="doctest highlight-default notranslate" id="index-5"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bulkCatalystVar</span> <span class="o">=</span> <span class="n">CellVariable</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;bulk catalyst variable&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">value</span><span class="o">=</span><span class="n">catalystConcentration</span><span class="p">)</span>
</pre></div>
</div>
<p>Create the bulk metal ion concentration,
<span class="math notranslate nohighlight">\(c_m\)</span>, in the electrolyte.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">metalVar</span> <span class="o">=</span> <span class="n">CellVariable</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;metal variable&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">value</span><span class="o">=</span><span class="n">bulkMetalConcentration</span><span class="p">)</span>
</pre></div>
</div>
<p>The following commands build the <code class="docutils literal notranslate"><span class="pre">depositionRateVariable</span></code>,
<span class="math notranslate nohighlight">\(v\)</span>. The <code class="docutils literal notranslate"><span class="pre">depositionRateVariable</span></code> is given by the following equation.</p>
<div class="math notranslate nohighlight">
\[v = \frac{i \Omega}{n F}\]</div>
<p>where <span class="math notranslate nohighlight">\(\Omega\)</span> is the metal molar volume, <span class="math notranslate nohighlight">\(n\)</span> is the metal ion
charge and <span class="math notranslate nohighlight">\(F\)</span> is Faradayâs constant. The current density is given
by</p>
<div class="math notranslate nohighlight">
\[i = i_0 \frac{c_m^i}{c_m^{\infty}} \exp{ \left( \frac{- \alpha F}{R T} \eta \right) }\]</div>
<p>where <span class="math notranslate nohighlight">\(c_m^i\)</span> is the metal ion concentration in the bulk at the
interface, <span class="math notranslate nohighlight">\(c_m^{\infty}\)</span> is the far-field bulk concentration of
metal ions, <span class="math notranslate nohighlight">\(\alpha\)</span> is the transfer coefficient, <span class="math notranslate nohighlight">\(R\)</span> is the gas
constant, <span class="math notranslate nohighlight">\(T\)</span> is the temperature and <span class="math notranslate nohighlight">\(\eta\)</span> is the
overpotential. The exchange current density is an empirical
function of catalyst coverage,</p>
<div class="math notranslate nohighlight">
\[i_0(\theta) = b_0 + b_1 \theta\]</div>
<p>The commands needed to build this equation are,</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">expoConstant</span> <span class="o">=</span> <span class="o">-</span><span class="n">transferCoefficient</span> <span class="o">*</span> <span class="n">faradaysConstant</span> \
<span class="gp">... </span>               <span class="o">/</span> <span class="p">(</span><span class="n">gasConstant</span> <span class="o">*</span> <span class="n">temperature</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp</span> <span class="o">=</span> <span class="n">currentDensity1</span> \
<span class="gp">... </span>      <span class="o">*</span> <span class="n">catalystVar</span><span class="o">.</span><span class="n">interfaceVar</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exchangeCurrentDensity</span> <span class="o">=</span> <span class="n">currentDensity0</span> <span class="o">+</span> <span class="n">tmp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expo</span> <span class="o">=</span> <span class="n">numerix</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">expoConstant</span> <span class="o">*</span> <span class="n">overpotential</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">currentDensity</span> <span class="o">=</span> <span class="n">expo</span> <span class="o">*</span> <span class="n">exchangeCurrentDensity</span> <span class="o">*</span> <span class="n">metalVar</span> \
<span class="gp">... </span>                 <span class="o">/</span> <span class="n">bulkMetalConcentration</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">depositionRateVariable</span> <span class="o">=</span> <span class="n">currentDensity</span> <span class="o">*</span> <span class="n">molarVolume</span> \
<span class="gp">... </span>                         <span class="o">/</span> <span class="p">(</span><span class="n">charge</span> <span class="o">*</span> <span class="n">faradaysConstant</span><span class="p">)</span>
</pre></div>
</div>
<p>Build the extension velocity variable <span class="math notranslate nohighlight">\(v_{\text{ext}}\)</span>. The extension
velocity uses the
<code class="docutils literal notranslate"><span class="pre">extensionEquation</span></code> to spread the velocity at the interface to the
rest of the domain.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">extensionVelocityVariable</span> <span class="o">=</span> <span class="n">CellVariable</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;extension velocity&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">value</span><span class="o">=</span><span class="n">depositionRateVariable</span><span class="p">)</span>
</pre></div>
</div>
<p>Using the variables created above the governing equations will be
built.  The governing equation for surfactant conservation is given
by,</p>
<div class="math notranslate nohighlight">
\[\dot{\theta} = J v \theta + k c_{\theta}^i (1 - \theta)\]</div>
<p>where <span class="math notranslate nohighlight">\(\theta\)</span> is the coverage of catalyst at the interface,
<span class="math notranslate nohighlight">\(J\)</span> is the curvature of the interface, <span class="math notranslate nohighlight">\(v\)</span> is the normal velocity
of the interface, <span class="math notranslate nohighlight">\(c_{\theta}^i\)</span> is the concentration of
catalyst in the bulk at the interface. The value <span class="math notranslate nohighlight">\(k\)</span> is given
by an empirical function of overpotential,</p>
<div class="math notranslate nohighlight">
\[k = k_0 + k_3 \eta^3\]</div>
<p>The above equation is represented by the
<code class="xref py py-class docutils literal notranslate"><span class="pre">AdsorbingSurfactantEquation</span></code>
in <a class="reference internal" href="../glossary.html#term-FiPy"><span class="xref std std-term">FiPy</span></a>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">surfactantEquation</span> <span class="o">=</span> <span class="n">AdsorbingSurfactantEquation</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">surfactantVar</span><span class="o">=</span><span class="n">catalystVar</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">distanceVar</span><span class="o">=</span><span class="n">distanceVar</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">bulkVar</span><span class="o">=</span><span class="n">bulkCatalystVar</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">rateConstant</span><span class="o">=</span><span class="n">rateConstant0</span> \
<span class="gp">... </span>                   <span class="o">+</span> <span class="n">rateConstant3</span> <span class="o">*</span> <span class="n">overpotential</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>The variable <span class="math notranslate nohighlight">\(\phi\)</span> is advected by the
<code class="docutils literal notranslate"><span class="pre">advectionEquation</span></code> given by,</p>
<div class="math notranslate nohighlight">
\[\frac{\partial \phi}{\partial t} + v_{\text{ext}}|\nabla \phi| = 0\]</div>
<p>and is set up with the following commands:</p>
<div class="doctest highlight-default notranslate" id="index-6"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">advectionEquation</span> <span class="o">=</span> <span class="n">TransientTerm</span><span class="p">()</span> <span class="o">+</span> <span class="n">AdvectionTerm</span><span class="p">(</span><span class="n">extensionVelocityVariable</span><span class="p">)</span>
</pre></div>
</div>
<p>The diffusion of metal ions from the far field to the interface is
governed by,</p>
<div class="math notranslate nohighlight">
\[\frac{\partial c_m}{\partial t} = \nabla \cdot D \nabla  c_m\]</div>
<p>where,</p>
<div class="math notranslate nohighlight">
\[\begin{split}D = \begin{cases}
D_m &amp; \text{when $\phi &gt; 0$,} \\
0   &amp; \text{when $\phi \le 0$}
\end{cases}\end{split}\]</div>
<p>The following boundary condition applies at <span class="math notranslate nohighlight">\(\phi = 0\)</span>,</p>
<div class="math notranslate nohighlight">
\[D \hat{n} \cdot \nabla c = \frac{v}{\Omega}.\]</div>
<p>The metal ion diffusion equation is set up with the following commands.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">metalEquation</span> <span class="o">=</span> <span class="n">buildMetalIonDiffusionEquation</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">ionVar</span><span class="o">=</span><span class="n">metalVar</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">distanceVar</span><span class="o">=</span><span class="n">distanceVar</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">depositionRate</span><span class="o">=</span><span class="n">depositionRateVariable</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">diffusionCoeff</span><span class="o">=</span><span class="n">metalDiffusionCoefficient</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">metalIonMolarVolume</span><span class="o">=</span><span class="n">molarVolume</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">metalVar</span><span class="o">.</span><span class="n">constrain</span><span class="p">(</span><span class="n">bulkMetalConcentration</span><span class="p">,</span> <span class="n">mesh</span><span class="o">.</span><span class="n">facesTop</span><span class="p">)</span>
</pre></div>
</div>
<p>The surfactant bulk diffusion equation solves the bulk diffusion of a
species with a source term for the jump from the bulk to an interface.
The governing equation is given by,</p>
<div class="math notranslate nohighlight">
\[\frac{\partial c}{\partial t} = \nabla \cdot D \nabla  c\]</div>
<p>where,</p>
<div class="math notranslate nohighlight">
\[\begin{split}D = \begin{cases}
D_{\theta} &amp; \text{when $\phi &gt; 0$} \\
0          &amp; \text{when $\phi \le 0$}
\end{cases}\end{split}\]</div>
<p>The jump condition at the interface is defined by Langmuir
adsorption. Langmuir adsorption essentially states that the ability
for a species to jump from an electrolyte to an interface is
proportional to the concentration in the electrolyte, available site
density and a jump coefficient. The boundary condition
at <span class="math notranslate nohighlight">\(\phi = 0\)</span> is given by,</p>
<div class="math notranslate nohighlight">
\[D \hat{n} \cdot \nabla c = -k c (1 - \theta).\]</div>
<p>The surfactant bulk diffusion equation is set up with the following commands.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.surfactantBulkDiffusionEquation</span> <span class="kn">import</span> <span class="n">buildSurfactantBulkDiffusionEquation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bulkCatalystEquation</span> <span class="o">=</span> <span class="n">buildSurfactantBulkDiffusionEquation</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">bulkVar</span><span class="o">=</span><span class="n">bulkCatalystVar</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">distanceVar</span><span class="o">=</span><span class="n">distanceVar</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">surfactantVar</span><span class="o">=</span><span class="n">catalystVar</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">diffusionCoeff</span><span class="o">=</span><span class="n">catalystDiffusion</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">rateConstant</span><span class="o">=</span><span class="n">rateConstant0</span> <span class="o">*</span> <span class="n">siteDensity</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bulkCatalystVar</span><span class="o">.</span><span class="n">constrain</span><span class="p">(</span><span class="n">catalystConcentration</span><span class="p">,</span> <span class="n">mesh</span><span class="o">.</span><span class="n">facesTop</span><span class="p">)</span>
</pre></div>
</div>
<p>If running interactively, create viewers.</p>
<div class="doctest highlight-default notranslate" id="index-7"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>        <span class="kn">from</span> <span class="nn">.mayaviSurfactantViewer</span> <span class="kn">import</span> <span class="n">MayaviSurfactantViewer</span>
<span class="gp">... </span>        <span class="n">viewer</span> <span class="o">=</span> <span class="n">MayaviSurfactantViewer</span><span class="p">(</span><span class="n">distanceVar</span><span class="p">,</span>
<span class="gp">... </span>                                        <span class="n">catalystVar</span><span class="o">.</span><span class="n">interfaceVar</span><span class="p">,</span>
<span class="gp">... </span>                                        <span class="n">zoomFactor</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span>
<span class="gp">... </span>                                        <span class="n">datamax</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
<span class="gp">... </span>                                        <span class="n">datamin</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
<span class="gp">... </span>                                        <span class="n">smooth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">except</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">viewer</span> <span class="o">=</span> <span class="n">MultiViewer</span><span class="p">(</span><span class="n">viewers</span><span class="o">=</span><span class="p">(</span>
<span class="gp">... </span>            <span class="n">Viewer</span><span class="p">(</span><span class="n">distanceVar</span><span class="p">,</span> <span class="n">datamin</span><span class="o">=-</span><span class="mf">1e-9</span><span class="p">,</span> <span class="n">datamax</span><span class="o">=</span><span class="mf">1e-9</span><span class="p">),</span>
<span class="gp">... </span>            <span class="n">Viewer</span><span class="p">(</span><span class="n">catalystVar</span><span class="o">.</span><span class="n">interfaceVar</span><span class="p">)))</span>
<span class="gp">... </span>        <span class="kn">from</span> <span class="nn">fipy.models.levelSet.surfactant.matplotlibSurfactantViewer</span> <span class="kn">import</span> <span class="n">MatplotlibSurfactantViewer</span>
<span class="gp">... </span>        <span class="n">viewer</span> <span class="o">=</span> <span class="n">MatplotlibSurfactantViewer</span><span class="p">(</span><span class="n">catalystVar</span><span class="o">.</span><span class="n">interfaceVar</span><span class="p">)</span>
<span class="gp">... </span><span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">viewer</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">levelSetUpdateFrequency</span></code> defines how often to call the
<code class="docutils literal notranslate"><span class="pre">distanceEquation</span></code> to reinitialize the <code class="docutils literal notranslate"><span class="pre">distanceVariable</span></code> to a
distance function.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">levelSetUpdateFrequency</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.8</span> <span class="o">*</span> <span class="n">narrowBandWidth</span> \
<span class="gp">... </span>                              <span class="o">/</span> <span class="p">(</span><span class="n">cellSize</span> <span class="o">*</span> <span class="n">cflNumber</span> <span class="o">*</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<p>The following loop runs for <code class="docutils literal notranslate"><span class="pre">numberOfSteps</span></code> time steps. The time step
is calculated with the CFL number and the maximum extension velocity.
<span class="math notranslate nohighlight">\(v\)</span> to
<span class="math notranslate nohighlight">\(v_\text{ext}\)</span> throughout the whole domain using
<span class="math notranslate nohighlight">\(\nabla\phi\cdot\nabla v_\text{ext} = 0\)</span>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">builtins</span> <span class="kn">import</span> <span class="nb">range</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numberOfSteps</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">viewer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">viewer</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">levelSetUpdateFrequency</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">distanceVar</span><span class="o">.</span><span class="n">calcDistanceFunction</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">extensionVelocityVariable</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">depositionRateVariable</span><span class="p">())</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">distanceVar</span><span class="o">.</span><span class="n">updateOld</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">distanceVar</span><span class="o">.</span><span class="n">extendVariable</span><span class="p">(</span><span class="n">extensionVelocityVariable</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">dt</span> <span class="o">=</span> <span class="n">cflNumber</span> <span class="o">*</span> <span class="n">cellSize</span> <span class="o">/</span> <span class="n">extensionVelocityVariable</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">advectionEquation</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">distanceVar</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">surfactantEquation</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">catalystVar</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">metalEquation</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">var</span><span class="o">=</span><span class="n">metalVar</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">bulkCatalystEquation</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">var</span><span class="o">=</span><span class="n">bulkCatalystVar</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="n">GeneralSolver</span><span class="p">())</span> 
</pre></div>
</div>
<p>The following is a short test case. It uses saved data from a
simulation with 5 time steps. It is not a test for accuracy but a way
to tell if something has changed or been broken.</p>
<div class="doctest highlight-default notranslate" id="index-8"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>                        <span class="s2">&quot;simpleTrenchSystem.gz&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">##numerix.savetxt(filepath, numerix.array(catalystVar))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">catalystVar</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">numerix</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">filepath</span><span class="p">),</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">))</span> 
<span class="go">1</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">fipy</span> <span class="kn">import</span> <span class="nb">input</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;finished&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>


                <div class='last-updated'>
                Last updated on Jul 02, 2025.
                Created using <a href="http://sphinx-doc.org/">Sphinx</a> 7.1.2.
                </div>
              </div>
  </div>  
  <aside class="nist-page__region nist-page__region--sidebar-second tablet-lg:grid-col-4">
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">

<strong>FiPy: A Finite Volume PDE Solver Using Python</strong><br />
Version 3.4.5+347.g24c7a036d

<div class="sphinxsidebarsection">
  <h4>Previous topic</h4>
  <p class="topless"><a href="examples.levelSet.electroChem.gold.html"
                        title="previous chapter">examples.levelSet.electroChem.gold</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="examples.levelSet.electroChem.leveler.html"
                        title="next chapter">examples.levelSet.electroChem.leveler</a></p>
</div>
  <div class="sphinxsidebarsection">
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/generated/examples.levelSet.electroChem.howToWriteAScript.rst.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
  </div>
<div class="sphinxsidebarsection">
<div id="searchbox" style="display: none" role="search">
  <div data-layout-content-preview-placeholder-label="&quot;Sphinx
  Search&quot; field" class="nist-block nist-block--search">
  <h2 id="searchlabel">Quick search</h2>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
  </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
</div>
<div class="sphinxsidebarsection" id="contact-wrapper">
  
        <div data-layout-content-preview-placeholder-label="&quot;Related
        organization tree&quot; views block" class="nist-block nist-block--org">
          
          <h2 class="nist-block__title">Organizations</h2>
              
              <div class="views-element-container"><div
              class="js-view-dom-id-70b0923f677edbe3dda361030ef8dc373cd0ca94065c39cfd81338de767f1019">

            <div class="nist-related-orgs"><div class="term-tree-list"><ul
            class="term"><li class="selected"><a
            href="https://www.nist.gov/nist-organizations/nist-headquarters" hreflang="en">NIST
            Headquarters</a><ul class="term"><li class="selected"><a
            href="https://www.nist.gov/nist-organizations/nist-headquarters/laboratory-programs"
            hreflang="en">Laboratory Programs</a><ul class="term"><li
            class="selected"><a
            href="https://www.nist.gov/nist-organizations/nist-headquarters/laboratory-programs/material-measurement-laboratory"
            hreflang="en">Material Measurement Laboratory</a>
			<ul
			class="term"><li
			class="selected"><a href="https://www.nist.gov/mml/msed"
			hreflang="en">Materials Science and Engineering
			Division</a></li><li
			class="selected"><a href="https://www.nist.gov/mml/ctcms"
			hreflang="en">Center for Theoretical and
			              Computational Materials Science</a></li></ul>
                          </li></ul></li></ul></li></ul></div></div>
          <div class="nist-related-orgs"></div>
          <div class="nist-related-orgs"></div>



        </div>
        </div>

          </div>


          <div data-layout-content-preview-placeholder-label="&quot;NIST
          Staff&quot; field" class="nist-block nist-block--contact">

          <h2 class="nist-block__title">NIST Staff</h2>

                  <div class="nist-field nist-field--label-hidden
                  nist-field--link-list entity-reference nist-field__items
                  nist-field--no-margin">
                            <div class="nist-field__item
                            nist-field--no-margin"><a
                            href="https://www.nist.gov/people/jonathan-e-guyer"
                            hreflang="en">Jonathan E. Guyer</a></div>
                                <div class="nist-field__item
                                nist-field--no-margin"><a
                                href="https://www.nist.gov/people/daniel-wheeler"
                                hreflang="en">Daniel Wheeler</a></div>
                                <div class="nist-field__item
                                nist-field--no-margin"><a
                                href="https://www.nist.gov/people/james-warren"
                                hreflang="en">James A. Warren</a></div>
                  </div>


          </div>

          <div data-layout-content-preview-placeholder-label="&quot;Contact&quot; field"
          class="nist-block nist-block--contact nist-block--mail">

          <h2 class="nist-block__title">
          <a class="" href="../docs/source/CONTACT.html" style="">Contact</a>
          </h2>

          </div>

</div>
        </div>
      </div>
      <div class="clearer"></div>
  </aside>
        </div>
      </div>

      <div class="panel-region--postface">
      <div class="inner region-inner inside">
        
<div class="pane pane--nist-node-date-pane" >

    </div>
      </div>
    </div>

        </section>
        </div>
      </div>

      </div>  
    </div>          

    </div>

  </div>

</div>


  


  <!-- Taken from https://www.filamentgroup.com/lab/html-includes/#another-demo%3A-including-another-html-file -->
  <iframe src="../_static/ntd2d_menu.html" onload="this.before((this.contentDocument.body||this.contentDocument).children[0]);this.remove()"></iframe>
    </div>
  </body>
</html>