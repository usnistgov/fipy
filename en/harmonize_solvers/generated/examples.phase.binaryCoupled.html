
<!DOCTYPE html>


<!--[if IEMobile 7]><html class="iem7 no-js"  lang="en" dir="ltr"><![endif]-->
<!--[if lte IE 6]><html class="lt-ie9 lt-ie8 lt-ie7 no-js"  lang="en" dir="ltr"><![endif]-->
<!--[if (IE 7)&(!IEMobile)]><html class="lt-ie9 lt-ie8 no-js"  lang="en" dir="ltr"><![endif]-->
<!--[if IE 8]><html class="lt-ie9 no-js"  lang="en" dir="ltr"><![endif]-->
<!--[if (gte IE 9)|(gt IEMobile 7)]><!--><html class="no-js"  lang="en" dir="ltr" prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# book: http://ogp.me/ns/book# profile: http://ogp.me/ns/profile# video: http://ogp.me/ns/video# product: http://ogp.me/ns/product# content: http://purl.org/rss/1.0/modules/content/ dc: http://purl.org/dc/terms/ foaf: http://xmlns.com/foaf/0.1/ rdfs: http://www.w3.org/2000/01/rdf-schema# sioc: http://rdfs.org/sioc/ns# sioct: http://rdfs.org/sioc/types# skos: http://www.w3.org/2004/02/skos/core# xsd: http://www.w3.org/2001/XMLSchema#"><!--<![endif]-->

  <head>
<meta charset="utf-8" />
<link rel="shortcut icon" href="https://www.nist.gov/sites/all/themes/nist_style/favicon.ico" type="image/vnd.microsoft.icon" />
<script type="text/x-mathjax-config">MathJax.Hub.Config({
  extensions: ['tex2jax.js'],
  jax: ['input/TeX','output/HTML-CSS'],
  tex2jax: {
    inlineMath: [ ['$$','$$'], ['\\(','\\)'] ],
    processEscapes: true,
    processClass: 'tex2jax',
    ignoreClass: 'html'
  },
  showProcessingMessages: false,
  messageStyle: 'none'
});
</script>
<meta name="MobileOptimized" content="width">
    <meta name="HandheldFriendly" content="true">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=0">

      <!--[if lt IE 9]>
    <script src="https://www.nist.gov/sites/all/themes/zen/js/html5-respond.js"></script>
    <![endif]-->
    <!--[if (gte IE 6)&(lte IE 8)]>
  <script type="text/javascript" src="https://www.nist.gov/sites/all/themes/nist_style/js/selectivizr-min.js"></script>
  <![endif]--><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>examples.phase.binaryCoupled &#8212; FiPy 3.4.5+441.g5c25b4570 documentation</title>
    <link rel="stylesheet" href="../_static/ntd2d.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/ntd2d.css?v=de7af573" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/widetable.css?v=32b6a719" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=a4fb7c06"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script>window.MathJax = {"loader": {"load": ["[tex]/textmacros"]}, "tex": {"packages": {"[+]": ["textmacros"]}}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="canonical" href="https://pages.nist.gov/fipy/en/latest/generated/examples.phase.binaryCoupled.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="top" title="FiPy 3.4.5+441.g5c25b4570 documentation" href="../contents.html" />
    <link rel="up" title="examples.phase" href="examples.phase.html" />
    <link rel="next" title="examples.phase.impingement" href="examples.phase.impingement.html" />
    <link rel="prev" title="examples.phase.binary" href="examples.phase.binary.html" />
  
 


  <link rel="stylesheet" href="https://pages.nist.gov/nist-header-footer/css/nist-combined.css">
  <script src="https://code.jquery.com/jquery-3.6.2.min.js" type="text/javascript" defer="defer"></script>
  <script src="https://pages.nist.gov/nist-header-footer/js/nist-header-footer.js" type="text/javascript" defer="defer"></script>


  </head>
<!--  <body role="document">-->
  <body class="html not-front not-logged-in no-sidebars page-node page-node- page-node-414011 node-type-software hide-breadcrumb section-services-resources page-panels is-panel" role="document">
      <div id="page" class="mini-header">



    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="examples.phase.impingement.html" title="examples.phase.impingement"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="examples.phase.binary.html" title="examples.phase.binary"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html"><img src="../_static/fipy.png" alt="FiPy logo"
                 style="vertical-align: middle; margin-top: -1px"/>
        FiPy</a> &gt;</li>

          <li class="nav-item nav-item-1"><a href="../API.html" ><code class="xref py py-mod docutils literal notranslate"><span class="pre">fipy</span></code> Package Documentation</a> &gt;</li>
          <li class="nav-item nav-item-2"><a href="examples.html" >examples</a> &gt;</li>
          <li class="nav-item nav-item-3"><a href="examples.phase.html" accesskey="U">examples.phase</a> &gt;</li> 
      </ul>
    </div>

  <div id="main" class="clearfix" role="main" tabindex="-1">
    <div class="main__inner">
      <div class="page-info">
        <a id="main-content"></a>
      </div>

      <div class="document">
        <div class="documentwrapper">

      <div id="content" class="column">
      <div id="block-nist-www-content" class="nist-block">
        <section class="nist-page__content usa-section clearfix">

         

        <div class="grid-container margin-top-4">
        <div class="grid-row grid-gap-6">

  <div class="nist-page__region nist-page__region--content tablet-lg:grid-col-8">
              <div class="body" role="main">
		
  <section id="module-examples.phase.binaryCoupled">
<span id="examples-phase-binarycoupled"></span><h1>examples.phase.binaryCoupled<a class="headerlink" href="#module-examples.phase.binaryCoupled" title="Permalink to this heading">¶</a></h1>
<p>Simultaneously solve a phase-field evolution and solute diffusion problem in one-dimension.</p>
<p>It is straightforward to extend a phase field model to include binary alloys.
As in <a class="reference internal" href="examples.phase.simple.html#module-examples.phase.simple" title="examples.phase.simple"><code class="xref py py-mod docutils literal notranslate"><span class="pre">examples.phase.simple</span></code></a>, we will examine a 1D problem</p>
<div class="doctest highlight-default notranslate" id="index-0"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">fipy</span> <span class="kn">import</span> <span class="n">CellVariable</span><span class="p">,</span> <span class="n">Variable</span><span class="p">,</span> <span class="n">Grid1D</span><span class="p">,</span> <span class="n">TransientTerm</span><span class="p">,</span> <span class="n">DiffusionTerm</span><span class="p">,</span> <span class="n">ImplicitSourceTerm</span><span class="p">,</span> <span class="n">LinearLUSolver</span><span class="p">,</span> <span class="n">Viewer</span><span class="p">,</span> <span class="n">DefaultAsymmetricSolver</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">fipy.tools</span> <span class="kn">import</span> <span class="n">numerix</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nx</span> <span class="o">=</span> <span class="mi">400</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dx</span> <span class="o">=</span> <span class="mf">5e-6</span> <span class="c1"># cm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L</span> <span class="o">=</span> <span class="n">nx</span> <span class="o">*</span> <span class="n">dx</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">Grid1D</span><span class="p">(</span><span class="n">dx</span><span class="o">=</span><span class="n">dx</span><span class="p">,</span> <span class="n">nx</span><span class="o">=</span><span class="n">nx</span><span class="p">)</span>
</pre></div>
</div>
<p>The Helmholtz free energy functional can be written as the integral
<span id="id1">[<a class="reference internal" href="../references.html#id6" title="W. J. Boettinger, J. A. Warren, C. Beckermann, and A. Karma. Phase-field simulation of solidification. Annual Review of Materials Research, 32:163-194, 2002. doi:10.1146/annurev.matsci.32.101901.155803.">1</a>]</span> <span id="id2">[<a class="reference internal" href="../references.html#id9" title="G. B. McFadden. Phase-field models of solidification. Contemporary Mathematics, 306:107-145, 2002.">3</a>]</span> <span id="id3">[<a class="reference internal" href="../references.html#id15" title="A. A. Wheeler, W. J. Boettinger, and G. B. McFadden. Phase-field model for isothermal phase transitions in binary alloys. Physical Review A, 45(10):7424–7439, 1992.">30</a>]</span></p>
<div class="math notranslate nohighlight">
\[\mathcal{F}\left(\phi, C, T\right)
= \int_\mathcal{V} \left\{
    f(\phi, C, T)
    + \frac{\kappa_\phi}{2}\abs{\nabla\phi}^2
    + \frac{\kappa_C}{2}\abs{\nabla C}^2
\right\} dV\]</div>
<p>over the volume <span class="math notranslate nohighlight">\(\mathcal{V}\)</span> as a function of phase <span class="math notranslate nohighlight">\(\phi\)</span>
<a class="footnote-reference brackets" href="#phicoupled" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a></p>
<div class="doctest highlight-default notranslate" id="index-1"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">phase</span> <span class="o">=</span> <span class="n">CellVariable</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;phase&quot;</span><span class="p">,</span> <span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">hasOld</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>composition <span class="math notranslate nohighlight">\(C\)</span></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">C</span> <span class="o">=</span> <span class="n">CellVariable</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;composition&quot;</span><span class="p">,</span> <span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">hasOld</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>and temperature <span class="math notranslate nohighlight">\(T\)</span> <a class="footnote-reference brackets" href="#tcoupled" id="id5" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a></p>
<div class="doctest highlight-default notranslate" id="index-2"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;temperature&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Frequently, the gradient energy term in concentration is ignored and we
can derive governing equations</p>
<div class="math notranslate nohighlight" id="equation-eq-phase-binarycoupled-phase">
<span class="eqno">(1)<a class="headerlink" href="#equation-eq-phase-binarycoupled-phase" title="Permalink to this equation">¶</a></span>\[ \frac{\partial\phi}{\partial t}
 = M_\phi \left( \kappa_\phi \nabla^2 \phi
                - \frac{\partial f}{\partial \phi} \right)\]</div>
<p>for phase and</p>
<div class="math notranslate nohighlight" id="equation-eq-phase-binarycoupled-diffusion">
<span class="eqno">(2)<a class="headerlink" href="#equation-eq-phase-binarycoupled-diffusion" title="Permalink to this equation">¶</a></span>\[\frac{\partial C}{\partial t}
= \nabla\cdot\left( M_C \nabla \frac{\partial f}{\partial C} \right)\]</div>
<p>for solute.</p>
<p>The free energy density <span class="math notranslate nohighlight">\(f(\phi, C, T)\)</span> can be constructed in many
different ways. One approach is to construct free energy densities for
each of the pure components, as functions of phase, <em>e.g.</em></p>
<div class="math notranslate nohighlight">
\[f_A(\phi, T) = p(\phi) f_A^S(T)
+ \left(1 - p(\phi)\right) f_A^L(T) + \frac{W_A}{2} g(\phi)\]</div>
<p>where <span class="math notranslate nohighlight">\(f_A^L(T)\)</span>, <span class="math notranslate nohighlight">\(f_B^L(T)\)</span>, <span class="math notranslate nohighlight">\(f_A^S(T)\)</span>, and <span class="math notranslate nohighlight">\(f_B^S(T)\)</span>
are the free energy densities of the pure components. There are a
variety of choices for the interpolation function <span class="math notranslate nohighlight">\(p(\phi)\)</span> and the
barrier function <span class="math notranslate nohighlight">\(g(\phi)\)</span>,</p>
<p>such as those shown in <a class="reference internal" href="examples.phase.simple.html#module-examples.phase.simple" title="examples.phase.simple"><code class="xref py py-mod docutils literal notranslate"><span class="pre">examples.phase.simple</span></code></a></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">p</span><span class="p">(</span><span class="n">phi</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">phi</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="mi">6</span> <span class="o">*</span> <span class="n">phi</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">15</span> <span class="o">*</span> <span class="n">phi</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">g</span><span class="p">(</span><span class="n">phi</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="p">(</span><span class="n">phi</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">phi</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
<p>The desired thermodynamic model can then be applied to obtain
<span class="math notranslate nohighlight">\(f(\phi, C, T)\)</span>, such as for a regular solution,</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(\phi, C, T) &amp;= (1 - C) f_A(\phi, T) + C f_B(\phi, T) \\
&amp;\qquad + R T \left[
    (1 - C) \ln (1 - C) + C \ln C
\right]
+ C (1 - C) \left[
    \Omega_S p(\phi)
    + \Omega_L \left( 1 - p(\phi) \right)
\right]\end{split}\]</div>
<p>where</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">R</span> <span class="o">=</span> <span class="mf">8.314</span> <span class="c1"># J / (mol K)</span>
</pre></div>
</div>
<p>is the gas constant and <span class="math notranslate nohighlight">\(\Omega_S\)</span> and <span class="math notranslate nohighlight">\(\Omega_L\)</span> are the
regular solution interaction parameters for solid and liquid.</p>
<p>Another approach is useful when the free energy densities <span class="math notranslate nohighlight">\(f^L(C, T)\)</span>
and <span class="math notranslate nohighlight">\(f^S(C,T)\)</span> of the alloy in the solid and liquid phases are
known. This might be the case when the two different phases have
different thermodynamic models or when one or both is obtained from a
Calphad code. In this case, we can construct</p>
<div class="math notranslate nohighlight">
\[f(\phi, C, T) = p(\phi) f^S(C,T)
+ \left(1 - p(\phi)\right) f^L(C, T)
+ \left[
    (1-C) \frac{W_A}{2} + C \frac{W_B}{2}
\right] g(\phi).\]</div>
<p>When the thermodynamic models are the same in both phases, both
approaches should yield the same result.</p>
<p>We choose the first approach and make the simplifying assumptions of an
ideal solution and that</p>
<div class="math notranslate nohighlight">
\[\begin{split}f_A^L(T) &amp; = 0 \\
f_A^S(T) - f_A^L(T) &amp;= \frac{L_A\left(T - T_M^A\right)}{T_M^A}\end{split}\]</div>
<p>and likewise for component <span class="math notranslate nohighlight">\(B\)</span>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">LA</span> <span class="o">=</span> <span class="mf">2350.</span> <span class="c1"># J / cm**3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">LB</span> <span class="o">=</span> <span class="mf">1728.</span> <span class="c1"># J / cm**3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TmA</span> <span class="o">=</span> <span class="mf">1728.</span> <span class="c1"># K</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TmB</span> <span class="o">=</span> <span class="mf">1358.</span> <span class="c1"># K</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">enthalpyA</span> <span class="o">=</span> <span class="n">LA</span> <span class="o">*</span> <span class="p">(</span><span class="n">T</span> <span class="o">-</span> <span class="n">TmA</span><span class="p">)</span> <span class="o">/</span> <span class="n">TmA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">enthalpyB</span> <span class="o">=</span> <span class="n">LB</span> <span class="o">*</span> <span class="p">(</span><span class="n">T</span> <span class="o">-</span> <span class="n">TmB</span><span class="p">)</span> <span class="o">/</span> <span class="n">TmB</span>
</pre></div>
</div>
<p>This relates the difference between the free energy densities of the
pure solid and pure liquid phases to the latent heat <span class="math notranslate nohighlight">\(L_A\)</span> and the
pure component melting point <span class="math notranslate nohighlight">\(T_M^A\)</span>, such that</p>
<div class="math notranslate nohighlight">
\[f_A(\phi, T) = \frac{L_A\left(T - T_M^A\right)}{T_M^A} p(\phi)
+ \frac{W_A}{2} g(\phi).\]</div>
<p>With these assumptions</p>
<div class="math notranslate nohighlight" id="equation-eq-phase-binarycoupled-phasetransformation">
<span class="eqno">(3)<a class="headerlink" href="#equation-eq-phase-binarycoupled-phasetransformation" title="Permalink to this equation">¶</a></span>\[\begin{split}\frac{\partial f}{\partial \phi}
&amp;= (1-C) \frac{\partial f_A}{\partial \phi}
+ C \frac{\partial f_B}{\partial \phi} \nonumber \\
&amp;= \left\{
    (1-C) \frac{L_A\left(T - T_M^A\right)}{T_M^A}
    + C \frac{L_B\left(T - T_M^B\right)}{T_M^B}
\right\} p'(\phi)
+ \left\{
  (1-C) \frac{W_A}{2} + C \frac{W_B}{2}
\right\} g'(\phi)\end{split}\]</div>
<p>and</p>
<div class="math notranslate nohighlight" id="equation-eq-phase-binarycoupled-chemicalpotential">
<span class="eqno">(4)<a class="headerlink" href="#equation-eq-phase-binarycoupled-chemicalpotential" title="Permalink to this equation">¶</a></span>\[\begin{split}\frac{\partial f}{\partial C}
&amp;= \left[f_B(\phi, T) + \frac{R T}{V_m} \ln C\right]
- \left[f_A(\phi, T) + \frac{R T}{V_m} \ln (1-C) \right] \nonumber \\
&amp;= \left[\mu_B(\phi, C, T) - \mu_A(\phi, C, T) \right] / V_m\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mu_A\)</span> and <span class="math notranslate nohighlight">\(\mu_B\)</span> are the classical chemical potentials
for the binary species. <span class="math notranslate nohighlight">\(p'(\phi)\)</span> and <span class="math notranslate nohighlight">\(g'(\phi)\)</span> are the
partial derivatives of of <span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\(g\)</span> with respect to <span class="math notranslate nohighlight">\(\phi\)</span></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">pPrime</span><span class="p">(</span><span class="n">phi</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="mf">30.</span> <span class="o">*</span> <span class="n">g</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">gPrime</span><span class="p">(</span><span class="n">phi</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">phi</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">phi</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">phi</span><span class="p">)</span>
</pre></div>
</div>
<p><span class="math notranslate nohighlight">\(V_m\)</span> is the molar volume, which we take to be independent of
concentration and phase</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Vm</span> <span class="o">=</span> <span class="mf">7.42</span> <span class="c1"># cm**3 / mol</span>
</pre></div>
</div>
<p>On comparison with <a class="reference internal" href="examples.phase.simple.html#module-examples.phase.simple" title="examples.phase.simple"><code class="xref py py-mod docutils literal notranslate"><span class="pre">examples.phase.simple</span></code></a>, we can see that the
present form of the phase field equation is identical to the one found
earlier, with the source now composed of the concentration-weighted average
of the source for either pure component. We let the pure component barriers
equal the previous value</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">deltaA</span> <span class="o">=</span> <span class="n">deltaB</span> <span class="o">=</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">dx</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigmaA</span> <span class="o">=</span> <span class="mf">3.7e-5</span> <span class="c1"># J / cm**2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigmaB</span> <span class="o">=</span> <span class="mf">2.9e-5</span> <span class="c1"># J / cm**2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">betaA</span> <span class="o">=</span> <span class="mf">0.33</span> <span class="c1"># cm / (K s)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">betaB</span> <span class="o">=</span> <span class="mf">0.39</span> <span class="c1"># cm / (K s)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kappaA</span> <span class="o">=</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">sigmaA</span> <span class="o">*</span> <span class="n">deltaA</span> <span class="c1"># J / cm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kappaB</span> <span class="o">=</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">sigmaB</span> <span class="o">*</span> <span class="n">deltaB</span> <span class="c1"># J / cm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">WA</span> <span class="o">=</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">sigmaA</span> <span class="o">/</span> <span class="n">deltaA</span> <span class="c1"># J / cm**3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">WB</span> <span class="o">=</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">sigmaB</span> <span class="o">/</span> <span class="n">deltaB</span> <span class="c1"># J / cm**3</span>
</pre></div>
</div>
<p>and define the averages</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">W</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">C</span><span class="p">)</span> <span class="o">*</span> <span class="n">WA</span> <span class="o">/</span> <span class="mf">2.</span> <span class="o">+</span> <span class="n">C</span> <span class="o">*</span> <span class="n">WB</span> <span class="o">/</span> <span class="mf">2.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">enthalpy</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">C</span><span class="p">)</span> <span class="o">*</span> <span class="n">enthalpyA</span> <span class="o">+</span> <span class="n">C</span> <span class="o">*</span> <span class="n">enthalpyB</span>
</pre></div>
</div>
<p>We can now linearize the source exactly as before</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mPhi</span> <span class="o">=</span> <span class="o">-</span><span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">phase</span><span class="p">)</span> <span class="o">*</span> <span class="n">W</span> <span class="o">+</span> <span class="mi">30</span> <span class="o">*</span> <span class="n">phase</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">phase</span><span class="p">)</span> <span class="o">*</span> <span class="n">enthalpy</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dmPhidPhi</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">W</span> <span class="o">-</span> <span class="mi">30</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">phase</span><span class="p">)</span> <span class="o">*</span> <span class="n">enthalpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S1</span> <span class="o">=</span> <span class="n">dmPhidPhi</span> <span class="o">*</span> <span class="n">phase</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">phase</span><span class="p">)</span> <span class="o">+</span> <span class="n">mPhi</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">phase</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S0</span> <span class="o">=</span> <span class="n">mPhi</span> <span class="o">*</span> <span class="n">phase</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">phase</span><span class="p">)</span> <span class="o">-</span> <span class="n">S1</span> <span class="o">*</span> <span class="n">phase</span>
</pre></div>
</div>
<p>Using the same gradient energy coefficient and phase field mobility</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">kappa</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">C</span><span class="p">)</span> <span class="o">*</span> <span class="n">kappaA</span> <span class="o">+</span> <span class="n">C</span> <span class="o">*</span> <span class="n">kappaB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Mphi</span> <span class="o">=</span> <span class="n">TmA</span> <span class="o">*</span> <span class="n">betaA</span> <span class="o">/</span> <span class="p">(</span><span class="mi">6</span> <span class="o">*</span> <span class="n">LA</span> <span class="o">*</span> <span class="n">deltaA</span><span class="p">)</span>
</pre></div>
</div>
<p>we define the phase field equation</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">phaseEq</span> <span class="o">=</span> <span class="p">(</span><span class="n">TransientTerm</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">Mphi</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="n">phase</span><span class="p">)</span> <span class="o">==</span> <span class="n">DiffusionTerm</span><span class="p">(</span><span class="n">coeff</span><span class="o">=</span><span class="n">kappa</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="n">phase</span><span class="p">)</span>
<span class="gp">... </span>           <span class="o">+</span> <span class="n">S0</span> <span class="o">+</span> <span class="n">ImplicitSourceTerm</span><span class="p">(</span><span class="n">coeff</span><span class="o">=</span><span class="n">S1</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="n">phase</span><span class="p">))</span>
</pre></div>
</div>
<hr class="docutils" />
<p>When coding explicitly, it is typical to simply write a function to
evaluate the chemical potentials <span class="math notranslate nohighlight">\(\mu_A\)</span> and <span class="math notranslate nohighlight">\(\mu_B\)</span> and then
perform the finite differences necessary to calculate their gradient and
divergence, e.g.,:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">deltaChemPot</span><span class="p">(</span><span class="n">phase</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">((</span><span class="n">Vm</span> <span class="o">*</span> <span class="p">(</span><span class="n">enthalpyB</span> <span class="o">*</span> <span class="n">p</span><span class="p">(</span><span class="n">phase</span><span class="p">)</span> <span class="o">+</span> <span class="n">WA</span> <span class="o">*</span> <span class="n">g</span><span class="p">(</span><span class="n">phase</span><span class="p">))</span> <span class="o">+</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">C</span><span class="p">))</span> <span class="o">-</span>
            <span class="p">(</span><span class="n">Vm</span> <span class="o">*</span> <span class="p">(</span><span class="n">enthalpyA</span> <span class="o">*</span> <span class="n">p</span><span class="p">(</span><span class="n">phase</span><span class="p">)</span> <span class="o">+</span> <span class="n">WA</span> <span class="o">*</span> <span class="n">g</span><span class="p">(</span><span class="n">phase</span><span class="p">))</span> <span class="o">+</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">log</span><span class="p">(</span><span class="n">C</span><span class="p">)))</span>

<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">faces</span><span class="p">):</span>
    <span class="n">flux</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">Mc</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mf">.5</span><span class="p">]</span> <span class="o">+</span> <span class="n">Mc</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mf">.5</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> \
      <span class="o">*</span> <span class="p">(</span><span class="n">deltaChemPot</span><span class="p">(</span><span class="n">phase</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mf">.5</span><span class="p">],</span> <span class="n">C</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mf">.5</span><span class="p">],</span> <span class="n">T</span><span class="p">)</span> \
        <span class="o">-</span> <span class="n">deltaChemPot</span><span class="p">(</span><span class="n">phase</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mf">.5</span><span class="p">],</span> <span class="n">C</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mf">.5</span><span class="p">],</span> <span class="n">T</span><span class="p">))</span> <span class="o">/</span> <span class="n">dx</span>

<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cells</span><span class="p">):</span>
    <span class="n">diffusion</span> <span class="o">=</span> <span class="p">(</span><span class="n">flux</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mf">.5</span><span class="p">]</span> <span class="o">-</span> <span class="n">flux</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mf">.5</span><span class="p">])</span> <span class="o">/</span> <span class="n">dx</span>
</pre></div>
</div>
<p>where we neglect the details of the outer boundaries (<code class="docutils literal notranslate"><span class="pre">j</span> <span class="pre">=</span> <span class="pre">0</span></code> and <code class="docutils literal notranslate"><span class="pre">j</span> <span class="pre">=</span> <span class="pre">N</span></code>)
or exactly how to translate <code class="docutils literal notranslate"><span class="pre">j+.5</span></code> or <code class="docutils literal notranslate"><span class="pre">j-.5</span></code> into an array index,
much less the complexities of higher dimensions. FiPy can handle all of
these issues automatically, so we could just write:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chemPotA</span> <span class="o">=</span> <span class="n">Vm</span> <span class="o">*</span> <span class="p">(</span><span class="n">enthalpyA</span> <span class="o">*</span> <span class="n">p</span><span class="p">(</span><span class="n">phase</span><span class="p">)</span> <span class="o">+</span> <span class="n">WA</span> <span class="o">*</span> <span class="n">g</span><span class="p">(</span><span class="n">phase</span><span class="p">))</span> <span class="o">+</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">log</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="n">chemPotB</span> <span class="o">=</span> <span class="n">Vm</span> <span class="o">*</span> <span class="p">(</span><span class="n">enthalpyB</span> <span class="o">*</span> <span class="n">p</span><span class="p">(</span><span class="n">phase</span><span class="p">)</span> <span class="o">+</span> <span class="n">WB</span> <span class="o">*</span> <span class="n">g</span><span class="p">(</span><span class="n">phase</span><span class="p">))</span> <span class="o">+</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">C</span><span class="p">)</span>
<span class="n">flux</span> <span class="o">=</span> <span class="n">Mc</span> <span class="o">*</span> <span class="p">(</span><span class="n">chemPotB</span> <span class="o">-</span> <span class="n">chemPotA</span><span class="p">)</span><span class="o">.</span><span class="n">faceGrad</span>
<span class="n">eq</span> <span class="o">=</span> <span class="n">TransientTerm</span><span class="p">()</span> <span class="o">==</span> <span class="n">flux</span><span class="o">.</span><span class="n">divergence</span>
</pre></div>
</div>
<p>Although the second syntax would essentially work as written, such an
explicit implementation would be very slow. In order to take advantage
of <a class="reference internal" href="../glossary.html#term-FiPy"><span class="xref std std-term">FiPy</span></a>’s implicit solvers, it is necessary to reduce
Eq. <a class="reference internal" href="#equation-eq-phase-binarycoupled-diffusion">(2)</a> to the canonical form of
Eq. <a class="reference internal" href="../numerical/equation.html#equation-num-gen">(2)</a>, hence we must expand
Eq. <a class="reference internal" href="#equation-eq-phase-binarycoupled-chemicalpotential">(4)</a> as</p>
<div class="math notranslate nohighlight">
\[\frac{\partial f}{\partial C}
= \left[
    \frac{L_B\left(T - T_M^B\right)}{T_M^B}
    - \frac{L_A\left(T - T_M^A\right)}{T_M^A}
\right] p(\phi)
+ \frac{R T}{V_m} \left[\ln C - \ln (1-C)\right]
+ \frac{W_B - W_A}{2} g(\phi)\]</div>
<p>In either bulk phase, <span class="math notranslate nohighlight">\(\nabla p(\phi) = \nabla g(\phi) = 0\)</span>, so
we can then reduce Eq. <a class="reference internal" href="#equation-eq-phase-binarycoupled-diffusion">(2)</a> to</p>
<div class="math notranslate nohighlight" id="equation-eq-phase-binarycoupled-diffusion-bulk">
<span class="eqno">(5)<a class="headerlink" href="#equation-eq-phase-binarycoupled-diffusion-bulk" title="Permalink to this equation">¶</a></span>\[\begin{split}\frac{\partial C}{\partial t}
&amp;= \nabla\cdot\left( M_C \nabla \left\{
    \frac{R T}{V_m} \left[\ln C - \ln (1-C)\right]
\right\}
\right) \nonumber \\
&amp;= \nabla\cdot\left[
    \frac{M_C R T}{C (1-C) V_m} \nabla C
\right]\end{split}\]</div>
<p>and, by comparison with Fick’s second law</p>
<div class="math notranslate nohighlight">
\[\frac{\partial C}{\partial t}
= \nabla\cdot\left[D \nabla C\right],\]</div>
<p>we can associate the mobility <span class="math notranslate nohighlight">\(M_C\)</span> with the intrinsic diffusivity <span class="math notranslate nohighlight">\(D_C\)</span> by
<span class="math notranslate nohighlight">\(M_C \equiv D_C C (1-C) V_m / R T\)</span> and write Eq. <a class="reference internal" href="#equation-eq-phase-binarycoupled-diffusion">(2)</a> as</p>
<div class="math notranslate nohighlight" id="equation-eq-phase-binarycoupled-diffusion-canonical">
<span class="eqno">(6)<a class="headerlink" href="#equation-eq-phase-binarycoupled-diffusion-canonical" title="Permalink to this equation">¶</a></span>\[\begin{split}\frac{\partial C}{\partial t}
&amp;= \nabla\cdot\left( D_C \nabla C \right) \nonumber \\
&amp;\qquad + \nabla\cdot\left(
\frac{D_C C (1 - C) V_m}{R T}
\left\{
    \left[
        \frac{L_B\left(T - T_M^B\right)}{T_M^B}
        - \frac{L_A\left(T - T_M^A\right)}{T_M^A}
    \right] \nabla p(\phi)
    + \frac{W_B - W_A}{2} \nabla g(\phi)
\right\}
\right). \\
&amp;= \nabla\cdot\left( D_C \nabla C \right) \nonumber \\
&amp;\qquad + \nabla\cdot\left(
\frac{D_C C (1 - C) V_m}{R T}
\left\{
    \left[
        \frac{L_B\left(T - T_M^B\right)}{T_M^B}
        - \frac{L_A\left(T - T_M^A\right)}{T_M^A}
    \right] p'(\phi)
    + \frac{W_B - W_A}{2} g'(\phi)
\right\} \nabla \phi
\right).\end{split}\]</div>
<p>The first term is clearly a <a class="reference internal" href="fipy.terms.diffusionTerm.html#fipy.terms.diffusionTerm.DiffusionTerm" title="fipy.terms.diffusionTerm.DiffusionTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiffusionTerm</span></code></a> in <span class="math notranslate nohighlight">\(C\)</span>. The second is a
<a class="reference internal" href="fipy.terms.diffusionTerm.html#fipy.terms.diffusionTerm.DiffusionTerm" title="fipy.terms.diffusionTerm.DiffusionTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiffusionTerm</span></code></a> in <span class="math notranslate nohighlight">\(\phi\)</span> with a diffusion coefficient</p>
<div class="math notranslate nohighlight">
\[D_{\phi}(C, \phi) =
\frac{D_C C (1 - C) V_m}{R T}
\left\{
    \left[
        \frac{L_B\left(T - T_M^B\right)}{T_M^B}
        - \frac{L_A\left(T - T_M^A\right)}{T_M^A}
    \right] p'(\phi)
    + \frac{W_B - W_A}{2} g'(\phi)
\right\},\]</div>
<p>such that</p>
<div class="math notranslate nohighlight">
\[\frac{\partial C}{\partial t}
= \nabla\cdot\left( D_C \nabla C \right) + \nabla\cdot\left(D_\phi \nabla \phi \right)\]</div>
<p>or</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Dl</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span> <span class="c1"># cm**2 / s</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Ds</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mf">1e-9</span><span class="p">)</span> <span class="c1"># cm**2 / s</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Dc</span> <span class="o">=</span> <span class="p">(</span><span class="n">Ds</span> <span class="o">-</span> <span class="n">Dl</span><span class="p">)</span> <span class="o">*</span> <span class="n">phase</span><span class="o">.</span><span class="n">arithmeticFaceValue</span> <span class="o">+</span> <span class="n">Dl</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Dphi</span> <span class="o">=</span> <span class="p">((</span><span class="n">Dc</span> <span class="o">*</span> <span class="n">C</span><span class="o">.</span><span class="n">harmonicFaceValue</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">C</span><span class="o">.</span><span class="n">harmonicFaceValue</span><span class="p">)</span> <span class="o">*</span> <span class="n">Vm</span> <span class="o">/</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span><span class="p">))</span>
<span class="gp">... </span>        <span class="o">*</span> <span class="p">((</span><span class="n">enthalpyB</span> <span class="o">-</span> <span class="n">enthalpyA</span><span class="p">)</span> <span class="o">*</span> <span class="n">pPrime</span><span class="p">(</span><span class="n">phase</span><span class="o">.</span><span class="n">arithmeticFaceValue</span><span class="p">)</span>
<span class="gp">... </span>           <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">WB</span> <span class="o">-</span> <span class="n">WA</span><span class="p">)</span> <span class="o">*</span> <span class="n">gPrime</span><span class="p">(</span><span class="n">phase</span><span class="o">.</span><span class="n">arithmeticFaceValue</span><span class="p">)))</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">diffusionEq</span> <span class="o">=</span> <span class="p">(</span><span class="n">TransientTerm</span><span class="p">(</span><span class="n">var</span><span class="o">=</span><span class="n">C</span><span class="p">)</span>
<span class="gp">... </span>               <span class="o">==</span> <span class="n">DiffusionTerm</span><span class="p">(</span><span class="n">coeff</span><span class="o">=</span><span class="n">Dc</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="n">C</span><span class="p">)</span>
<span class="gp">... </span>               <span class="o">+</span> <span class="n">DiffusionTerm</span><span class="p">(</span><span class="n">coeff</span><span class="o">=</span><span class="n">Dphi</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="n">phase</span><span class="p">))</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span> <span class="o">=</span> <span class="n">phaseEq</span> <span class="o">&amp;</span> <span class="n">diffusionEq</span>
</pre></div>
</div>
<hr class="docutils" />
<p>We initialize the phase field to a step function in the middle of the domain</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">phase</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mf">1.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phase</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">mesh</span><span class="o">.</span><span class="n">cellCenters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">L</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span>
</pre></div>
</div>
<p>and start with a uniform composition field <span class="math notranslate nohighlight">\(C = 1/2\)</span></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">C</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
<p>In equilibrium, <span class="math notranslate nohighlight">\(\mu_A(0, C_L, T) = \mu_A(1, C_S, T)\)</span> and
<span class="math notranslate nohighlight">\(\mu_B(0, C_L, T) = \mu_B(1, C_S, T)\)</span> and, for ideal solutions, we can
deduce the liquidus and solidus compositions as</p>
<div class="math notranslate nohighlight">
\[\begin{split}C_L &amp;= \frac{1 - \exp\left(-\frac{L_A\left(T - T_M^A\right)}{T_M^A}\frac{V_m}{R T}\right)}
{\exp\left(-\frac{L_B\left(T - T_M^B\right)}{T_M^B}\frac{V_m}{R T}\right)
- \exp\left(-\frac{L_A\left(T - T_M^A\right)}{T_M^A}\frac{V_m}{R T}\right)} \\
C_S &amp;= \exp\left(-\frac{L_B\left(T - T_M^B\right)}{T_M^B}\frac{V_m}{R T}\right) C_L\end{split}\]</div>
<div class="doctest highlight-default notranslate" id="index-3"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Cl</span> <span class="o">=</span> <span class="p">((</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">numerix</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">enthalpyA</span> <span class="o">*</span> <span class="n">Vm</span> <span class="o">/</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span><span class="p">)))</span>
<span class="gp">... </span>      <span class="o">/</span> <span class="p">(</span><span class="n">numerix</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">enthalpyB</span> <span class="o">*</span> <span class="n">Vm</span> <span class="o">/</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span><span class="p">))</span> <span class="o">-</span> <span class="n">numerix</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">enthalpyA</span> <span class="o">*</span> <span class="n">Vm</span> <span class="o">/</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span><span class="p">))))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Cs</span> <span class="o">=</span> <span class="n">numerix</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">enthalpyB</span> <span class="o">*</span> <span class="n">Vm</span> <span class="o">/</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span><span class="p">))</span> <span class="o">*</span> <span class="n">Cl</span>
</pre></div>
</div>
<p>The phase fraction is predicted by the lever rule</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Cavg</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">cellVolumeAverage</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fraction</span> <span class="o">=</span> <span class="p">(</span><span class="n">Cl</span> <span class="o">-</span> <span class="n">Cavg</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">Cl</span> <span class="o">-</span> <span class="n">Cs</span><span class="p">)</span>
</pre></div>
</div>
<p>For the special case of <code class="docutils literal notranslate"><span class="pre">fraction</span> <span class="pre">=</span> <span class="pre">Cavg</span> <span class="pre">=</span> <span class="pre">0.5</span></code>, a little bit of algebra
reveals that the temperature that leaves the phase fraction unchanged is
given by</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">T</span><span class="o">.</span><span class="n">setValue</span><span class="p">((</span><span class="n">LA</span> <span class="o">+</span> <span class="n">LB</span><span class="p">)</span> <span class="o">*</span> <span class="n">TmA</span> <span class="o">*</span> <span class="n">TmB</span> <span class="o">/</span> <span class="p">(</span><span class="n">LA</span> <span class="o">*</span> <span class="n">TmB</span> <span class="o">+</span> <span class="n">LB</span> <span class="o">*</span> <span class="n">TmA</span><span class="p">))</span>
</pre></div>
</div>
<p>In this simple, binary, ideal solution case, we can derive explicit
expressions for the solidus and liquidus compositions. In general, this may
not be possible or practical. In that event, the root-finding facilities in
SciPy can be used.</p>
<p>We’ll need a function to return the two conditions for equilibrium</p>
<div class="math notranslate nohighlight">
\[\begin{split}0 = \mu_A(1, C_S, T) - \mu_A(0, C_L, T) &amp;=
\frac{L_A\left(T - T_M^A\right)}{T_M^A} V_m
+ R T \ln (1 - C_S) - R T \ln (1 - C_L) \\
0 = \mu_B(1, C_S, T) - \mu_B(0, C_L, T) &amp;=
\frac{L_B\left(T - T_M^B\right)}{T_M^B} V_m
+ R T \ln C_S - R T \ln C_L\end{split}\]</div>
<div class="doctest highlight-default notranslate" id="index-4"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">equilibrium</span><span class="p">(</span><span class="n">C</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="p">[</span><span class="n">numerix</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">enthalpyA</span> <span class="o">*</span> <span class="n">Vm</span>
<span class="gp">... </span>                          <span class="o">+</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">numerix</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">C</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">... </span>                          <span class="o">-</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">numerix</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">C</span><span class="p">[</span><span class="mi">1</span><span class="p">])),</span>
<span class="gp">... </span>            <span class="n">numerix</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">enthalpyB</span> <span class="o">*</span> <span class="n">Vm</span>
<span class="gp">... </span>                          <span class="o">+</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">numerix</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">C</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">... </span>                          <span class="o">-</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">numerix</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">C</span><span class="p">[</span><span class="mi">1</span><span class="p">]))]</span>
</pre></div>
</div>
<p>and we’ll have much better luck if we also supply the Jacobian</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left[\begin{matrix}
    \frac{\partial(\mu_A^S - \mu_A^L)}{\partial C_S}
    &amp; \frac{\partial(\mu_A^S - \mu_A^L)}{\partial C_L} \\
    \frac{\partial(\mu_B^S - \mu_B^L)}{\partial C_S}
    &amp; \frac{\partial(\mu_B^S - \mu_B^L)}{\partial C_L}
\end{matrix}\right]
=
R T\left[\begin{matrix}
    -\frac{1}{1-C_S} &amp; \frac{1}{1-C_L} \\
    \frac{1}{C_S} &amp; -\frac{1}{C_L}
\end{matrix}\right]\end{split}\]</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">equilibriumJacobian</span><span class="p">(</span><span class="n">C</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">numerix</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">1.</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">C</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="mf">1.</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">C</span><span class="p">[</span><span class="mi">1</span><span class="p">])],</span>
<span class="gp">... </span>                                  <span class="p">[</span> <span class="mf">1.</span> <span class="o">/</span> <span class="n">C</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>      <span class="o">-</span><span class="mf">1.</span> <span class="o">/</span> <span class="n">C</span><span class="p">[</span><span class="mi">1</span><span class="p">]]])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate" id="index-5"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>    <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">fsolve</span> 
<span class="gp">... </span>    <span class="n">CsRoot</span><span class="p">,</span> <span class="n">ClRoot</span> <span class="o">=</span> <span class="n">fsolve</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">equilibrium</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
<span class="gp">... </span>                            <span class="n">fprime</span><span class="o">=</span><span class="n">equilibriumJacobian</span><span class="p">)</span> 
<span class="gp">... </span><span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">ClRoot</span> <span class="o">=</span> <span class="n">CsRoot</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The SciPy library is not available to calculate the solidus and ... liquidus concentrations&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Cl</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">ClRoot</span><span class="p">))</span> 
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Cs</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">CsRoot</span><span class="p">))</span> 
<span class="go">1</span>
</pre></div>
</div>
<p>We plot the result against the sharp interface solution</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sharp</span> <span class="o">=</span> <span class="n">CellVariable</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;sharp&quot;</span><span class="p">,</span> <span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">cellCenters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sharp</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">Cs</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">L</span> <span class="o">*</span> <span class="n">fraction</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sharp</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">Cl</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">L</span> <span class="o">*</span> <span class="n">fraction</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">elapsed</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span> <span class="c1"># s</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate" id="index-6"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>        <span class="kn">from</span> <span class="nn">phaseViewer</span> <span class="kn">import</span> <span class="n">PhaseViewer</span>
<span class="gp">...</span>
<span class="gp">... </span>        <span class="n">viewer</span> <span class="o">=</span> <span class="n">PhaseViewer</span><span class="p">(</span><span class="n">phase</span><span class="o">=</span><span class="n">phase</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="n">C</span><span class="p">,</span> <span class="n">sharp</span><span class="o">=</span><span class="n">sharp</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="n">elapsed</span><span class="o">=</span><span class="n">elapsed</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="n">L</span><span class="o">=</span><span class="n">L</span><span class="p">,</span> <span class="n">deltaA</span><span class="o">=</span><span class="n">deltaA</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="n">tmin</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="mi">300</span> <span class="o">*</span> <span class="mi">3600</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="n">datamin</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">datamax</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">viewer</span> <span class="o">=</span> <span class="n">Viewer</span><span class="p">(</span><span class="nb">vars</span><span class="o">=</span><span class="p">(</span><span class="n">phase</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">sharp</span><span class="p">),</span>
<span class="gp">... </span>                        <span class="n">datamin</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">datamax</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">viewer</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>Because the phase field interface will not move, and because we’ve seen in
earlier examples that the diffusion problem is unconditionally stable, we
need take only one very large timestep to reach equilibrium</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dt</span> <span class="o">=</span> <span class="mf">1.e5</span>
</pre></div>
</div>
<p>Because the phase field equation is coupled to the composition through
<code class="docutils literal notranslate"><span class="pre">enthalpy</span></code> and <code class="docutils literal notranslate"><span class="pre">W</span></code> and the diffusion equation is coupled to the phase
field through <code class="docutils literal notranslate"><span class="pre">phaseTransformationVelocity</span></code>, it is necessary sweep this
non-linear problem to convergence. We use the “residual” of the equations
(a measure of how well they think they have solved the given set of linear
equations) as a test for how long to sweep.</p>
<p id="index-7">We now use the “<a class="reference internal" href="fipy.terms.term.html#fipy.terms.term.Term.sweep" title="fipy.terms.term.Term.sweep"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sweep()</span></code></a>” method instead of
“<a class="reference internal" href="fipy.terms.term.html#fipy.terms.term.Term.solve" title="fipy.terms.term.Term.solve"><code class="xref py py-meth docutils literal notranslate"><span class="pre">solve()</span></code></a>” because we require the residual.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fipy.solvers.solver</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">fipy</span><span class="o">.</span><span class="n">solvers</span><span class="o">.</span><span class="n">solver_suite</span> <span class="o">==</span> <span class="s1">&#39;petsc&#39;</span><span class="p">:</span>
<span class="gp">... </span>    <span class="kn">from</span> <span class="nn">fipy</span> <span class="kn">import</span> <span class="n">HYPREPreconditioner</span>
<span class="gp">... </span>    <span class="n">solver</span> <span class="o">=</span> <span class="n">DefaultAsymmetricSolver</span><span class="p">(</span><span class="n">criterion</span><span class="o">=</span><span class="s2">&quot;initial&quot;</span><span class="p">,</span>
<span class="gp">... </span>                                     <span class="n">precon</span><span class="o">=</span><span class="n">HYPREPreconditioner</span><span class="p">(),</span>
<span class="gp">... </span>                                     <span class="n">tolerance</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">)</span>
<span class="gp">... </span><span class="k">elif</span> <span class="n">fipy</span><span class="o">.</span><span class="n">solvers</span><span class="o">.</span><span class="n">solver_suite</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;trilinos&#39;</span><span class="p">,</span> <span class="s1">&#39;no-pysparse&#39;</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="kn">from</span> <span class="nn">fipy</span> <span class="kn">import</span> <span class="n">LinearBicgstabSolver</span>
<span class="gp">... </span>    <span class="n">solver</span> <span class="o">=</span> <span class="n">LinearBicgstabSolver</span><span class="p">(</span><span class="n">criterion</span><span class="o">=</span><span class="s2">&quot;initial&quot;</span><span class="p">,</span>
<span class="gp">... </span>                                  <span class="n">tolerance</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">)</span>
<span class="gp">... </span><span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">solver</span> <span class="o">=</span> <span class="n">DefaultAsymmetricSolver</span><span class="p">(</span><span class="n">criterion</span><span class="o">=</span><span class="s2">&quot;initial&quot;</span><span class="p">,</span>
<span class="gp">... </span>                                     <span class="n">precon</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>                                     <span class="n">tolerance</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">phase</span><span class="o">.</span><span class="n">updateOld</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span><span class="o">.</span><span class="n">updateOld</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">initialRes</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sweep</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">while</span> <span class="n">res</span> <span class="o">&gt;</span> <span class="mf">1e-5</span> <span class="ow">and</span> <span class="n">sweep</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">res</span> <span class="o">=</span> <span class="n">eq</span><span class="o">.</span><span class="n">sweep</span><span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="n">solver</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">initialRes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">initialRes</span> <span class="o">=</span> <span class="n">res</span>
<span class="gp">... </span>    <span class="n">res</span> <span class="o">=</span> <span class="n">res</span> <span class="o">/</span> <span class="n">initialRes</span>
<span class="gp">... </span>    <span class="n">sweep</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">fipy</span> <span class="kn">import</span> <span class="nb">input</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">viewer</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gp">... </span>    <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Stationary phase field. Press &lt;return&gt; to proceed...&quot;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/stationary.png"><img alt="phase and composition fields in equilibrium, compared with phase diagram concentrations" class="align-center" src="../_images/stationary.png" style="width: 90%;" /></a>
<p>We verify that the bulk phases have shifted to the predicted solidus and
liquidus compositions</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">faceCenters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Cs</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">faceValue</span><span class="p">[</span><span class="n">X</span><span class="o">.</span><span class="n">value</span><span class="o">==</span><span class="mi">0</span><span class="p">],</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Cl</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">faceValue</span><span class="p">[</span><span class="n">X</span><span class="o">.</span><span class="n">value</span><span class="o">==</span><span class="n">L</span><span class="p">],</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>and that the phase fraction remains unchanged</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">fraction</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">phase</span><span class="o">.</span><span class="n">cellVolumeAverage</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">2e-4</span><span class="p">))</span>
<span class="go">1</span>
</pre></div>
</div>
<p>while conserving mass overall</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Cavg</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">))</span>
<span class="go">1</span>
</pre></div>
</div>
<hr class="docutils" />
<p>We now quench by ten degrees</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">T</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">T</span><span class="p">()</span> <span class="o">-</span> <span class="mf">10.</span><span class="p">)</span> <span class="c1"># K</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sharp</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">Cs</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">L</span> <span class="o">*</span> <span class="n">fraction</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sharp</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">Cl</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">L</span> <span class="o">*</span> <span class="n">fraction</span><span class="p">)</span>
</pre></div>
</div>
<p>Because this lower temperature will induce the phase interface to move
(solidify), we will need to take much smaller timesteps (the time scales of
diffusion and of phase transformation compete with each other).</p>
<p>The <a class="reference external" href="http://en.wikipedia.org/wiki/Courant-Friedrichs-Lewy_condition">CFL limit</a> requires that no interface should advect more than one grid
spacing in a timestep. We can get a rough idea for the maximum timestep we can
take by looking at the velocity of convection induced by phase transformation in
Eq. <a class="reference internal" href="#equation-eq-phase-binarycoupled-diffusion-canonical">(6)</a> (even though there is no explicit
convection in the coupled form used for this example, the principle remains the
same). If we assume that the phase changes from 1 to 0 in a single grid spacing,
that the diffusivity is <cite>Dl</cite> at the interface, and that the term due to the difference in
barrier heights is negligible:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\vec{u}_\phi &amp;= \frac{D_\phi}{C} \nabla \phi
\\
&amp;\approx
\frac{D_l \frac{1}{2} V_m}{R T}
\left[
    \frac{L_B\left(T - T_M^B\right)}{T_M^B}
    - \frac{L_A\left(T - T_M^A\right)}{T_M^A}
\right] \frac{1}{\Delta x}
\\
&amp;\approx
\frac{D_l \frac{1}{2} V_m}{R T}
\left(L_B + L_A\right) \frac{T_M^A - T_M^B}{T_M^A + T_M^B}
\frac{1}{\Delta x}
\\
&amp;\approx 0.28~\mathrm{cm/s}\end{split}\]</div>
<p>To get a <span class="math notranslate nohighlight">\(\text{CFL} = \vec{u}_\phi \Delta t / \Delta x &lt; 1\)</span>, we need a
time step of about <span class="math notranslate nohighlight">\(10^{-5}~\mathrm{s}\)</span>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dt0</span> <span class="o">=</span> <span class="mf">1.e-5</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">builtins</span> <span class="kn">import</span> <span class="nb">range</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">phase</span><span class="o">.</span><span class="n">updateOld</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">C</span><span class="o">.</span><span class="n">updateOld</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">res</span> <span class="o">=</span> <span class="mf">1e+10</span>
<span class="gp">... </span>    <span class="n">sweep</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">... </span>    <span class="k">while</span> <span class="p">(</span><span class="n">res</span> <span class="o">&gt;</span> <span class="mf">1e-3</span> <span class="ow">or</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Cavg</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">2e-6</span><span class="p">)</span> <span class="ow">and</span> <span class="n">sweep</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">res</span> <span class="o">=</span> <span class="n">eq</span><span class="o">.</span><span class="n">sweep</span><span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="n">dt0</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="n">solver</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">sweep</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="gp">... </span>    <span class="n">elapsed</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt0</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">viewer</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">fipy</span> <span class="kn">import</span> <span class="nb">input</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Moving phase field. Press &lt;return&gt; to proceed...&quot;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/binaryCoupled-0.000080.png"><img alt="../_images/binaryCoupled-0.000080.png" class="align-center" src="../_images/binaryCoupled-0.000080.png" style="width: 90%;" /></a>
<p>We see that the composition on either side of the interface approaches the
sharp-interface solidus and liquidus, but it will take a great many more
timesteps to reach equilibrium. If we waited sufficiently long, we
could again verify the final concentrations and phase fraction against the
expected values.</p>
<p>We can estimate the time to equilibration by examining the time for the
diffusion field to become uniform.  In the liquid, this will take
<span class="math notranslate nohighlight">\(\mathcal{O}((10~\mathrm{\mu m})^2 / D_l) =
0.1~\mathrm{s}\)</span> and in the solid
<span class="math notranslate nohighlight">\(\mathcal{O}((10~\mathrm{\mu m})^2 / D_s) =
1000~\mathrm{s}\)</span>.</p>
<p>Not wanting to take a hundred-million steps, we employ adaptive time
stepping, using the <span class="xref std std-term">steppyingstounes</span> package.  This package takes
care of many of the messy details of stepping, like overshoot, underflow,
and step size adaptation, while keeping the structure of our solve loop
largely intact.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">steppyngstounes</span> <span class="kn">import</span> <span class="n">SequenceStepper</span><span class="p">,</span> <span class="n">PIDStepper</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">count</span>
</pre></div>
</div>
<p>Assuming the process is dominated by diffusion, we can take steps that
increase geometrically.  Since we’re unsure if diffusion is the only
process controlling dynamics, we take each increasing step with an adaptive
stepper that uses a <a class="reference external" href="https://en.wikipedia.org/wiki/PID_controller">PID controller</a> to keep the equation residuals and
mass conservation within acceptable limits.  The total number of solves is
not strongly sensitive to the number of sweeps, but two sweeps seems to be
both sufficient and efficient.</p>
<p>We’ll only advance the step if it’s successful, so we need to update the
old values before we get started.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">phase</span><span class="o">.</span><span class="n">updateOld</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span><span class="o">.</span><span class="n">updateOld</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">totaltime</span> <span class="o">=</span> <span class="mi">300</span> <span class="o">*</span> <span class="mi">3600</span> <span class="c1"># 300 h</span>
<span class="gp">... </span><span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">totaltime</span> <span class="o">=</span> <span class="mf">32e-5</span> <span class="c1"># 320 us</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dt</span> <span class="o">=</span> <span class="n">dt0</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">checkpoint</span> <span class="ow">in</span> <span class="n">SequenceStepper</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">elapsed</span><span class="p">),</span> <span class="n">stop</span><span class="o">=</span><span class="n">totaltime</span><span class="p">,</span>     
<span class="gp">... </span>                                  <span class="n">sizes</span><span class="o">=</span><span class="p">(</span><span class="n">dt0</span> <span class="o">*</span> <span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">count</span><span class="p">(</span><span class="mi">7</span><span class="p">))):</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">PIDStepper</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="n">checkpoint</span><span class="o">.</span><span class="n">begin</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">stop</span><span class="o">=</span><span class="n">checkpoint</span><span class="o">.</span><span class="n">end</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">size</span><span class="o">=</span><span class="n">dt</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">for</span> <span class="n">sweep</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
<span class="gp">... </span>            <span class="n">res</span> <span class="o">=</span> <span class="n">eq</span><span class="o">.</span><span class="n">sweep</span><span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="n">step</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="n">solver</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">err</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">res</span> <span class="o">/</span> <span class="mf">1e-3</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="nb">abs</span><span class="p">(</span><span class="n">Cavg</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2e-6</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="n">step</span><span class="o">.</span><span class="n">succeeded</span><span class="p">(</span><span class="n">error</span><span class="o">=</span><span class="n">err</span><span class="p">):</span>
<span class="gp">... </span>            <span class="n">phase</span><span class="o">.</span><span class="n">updateOld</span><span class="p">()</span>
<span class="gp">... </span>            <span class="n">C</span><span class="o">.</span><span class="n">updateOld</span><span class="p">()</span>
<span class="gp">... </span>            <span class="n">elapsed</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">step</span><span class="o">.</span><span class="n">end</span>
<span class="gp">... </span>        <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>            <span class="n">phase</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">phase</span><span class="o">.</span><span class="n">old</span>
<span class="gp">... </span>            <span class="n">C</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">old</span>
<span class="gp">... </span>    <span class="c1"># the last step might have been smaller than possible,</span>
<span class="gp">... </span>    <span class="c1"># if it was near the end of the checkpoint range</span>
<span class="gp">... </span>    <span class="n">dt</span> <span class="o">=</span> <span class="n">step</span><span class="o">.</span><span class="n">want</span>
<span class="gp">... </span>    <span class="n">_</span> <span class="o">=</span> <span class="n">checkpoint</span><span class="o">.</span><span class="n">succeeded</span><span class="p">()</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">viewer</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">fipy</span> <span class="kn">import</span> <span class="nb">input</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Re-equilbrated phase field. Press &lt;return&gt; to proceed...&quot;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/binaryCoupled-0.000899.png"><img alt="phase and composition fields at t=0.000899, compared with final phase diagram concentrations" src="../_images/binaryCoupled-0.000899.png" style="width: 30%;" /></a>
<a class="reference internal image-reference" href="../_images/binaryCoupled-8.949963.png"><img alt="phase and composition fields at t=8.949963, compared with final phase diagram concentrations" src="../_images/binaryCoupled-8.949963.png" style="width: 30%;" /></a>
<a class="reference internal image-reference" href="../_images/binaryCoupled-1080000.000000.png"><img alt="phase and composition fields at t=1080000, compared with final phase diagram concentrations" src="../_images/binaryCoupled-1080000.000000.png" style="width: 30%;" /></a>
<p>The interface moves <span class="math notranslate nohighlight">\(\approx 2.8~\mathrm{\mu m}\)</span> in
<span class="math notranslate nohighlight">\(70~\mathrm{ms}\)</span>, driven by diffusion in the liquid
phase (compare the estimate above of <span class="math notranslate nohighlight">\(0.1~\mathrm{s}\)</span>).
For the next
<span class="math notranslate nohighlight">\(12~\mathrm{s}\)</span>, the interface stalls while the solute step
trapped in the solid phase diffuses outward
(<span class="math notranslate nohighlight">\((2.8~\mathrm{\mu m})^2 / D_s =
\mathcal{O}(80~\mathrm{s})\)</span>).  Once the solute gradient in the
solid reaches the new position of the interface, the solidification front
begins to move, driven by diffusion in the solid.  When the solute in the
solid becomes uniform, the interface stalls again after <span class="math notranslate nohighlight">\(\approx
4000~\mathrm{s}\)</span>, having moved another
<span class="math notranslate nohighlight">\(2.9~\mathrm{\mu m}\)</span> (recall the estimate of
<span class="math notranslate nohighlight">\(1000~\mathrm{s}\)</span> for equilibration in the solid).  After this
point, there is essentially no further motion of the interface and barely
perceptible changes in the concentration field.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This evolution is qualitatively consistent with that seen in
<a class="reference internal" href="examples.phase.binary.html#module-examples.phase.binary" title="examples.phase.binary"><code class="xref py py-mod docutils literal notranslate"><span class="pre">examples.phase.binary</span></code></a>, but the interface does not move as far and
the bulk concentrations are further from the phase diagram values.  The
computation also takes substantially longer than the uncoupled variant.</p>
</div>
<p class="rubric">Footnotes</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="phicoupled" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">1</a><span class="fn-bracket">]</span></span>
<p>We will find that we need to “sweep” this non-linear problem
(see <em>e.g.</em> the composition-dependent diffusivity example in
<a class="reference internal" href="examples.diffusion.mesh1D.html#module-examples.diffusion.mesh1D" title="examples.diffusion.mesh1D"><code class="xref py py-mod docutils literal notranslate"><span class="pre">examples.diffusion.mesh1D</span></code></a>), so we declare <span class="math notranslate nohighlight">\(\phi\)</span> and <span class="math notranslate nohighlight">\(C\)</span>
to retain an “old” value.</p>
</aside>
<aside class="footnote brackets" id="tcoupled" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id5">2</a><span class="fn-bracket">]</span></span>
<p>we are going to want to
examine different temperatures in this example, so we declare <span class="math notranslate nohighlight">\(T\)</span>
as a <a class="reference internal" href="fipy.variables.variable.html#fipy.variables.variable.Variable" title="fipy.variables.variable.Variable"><code class="xref py py-class docutils literal notranslate"><span class="pre">Variable</span></code></a></p>
</aside>
</aside>
</section>


                <div class='last-updated'>
                Last updated on Aug 12, 2025.
                Created using <a href="http://sphinx-doc.org/">Sphinx</a> 7.1.2.
                </div>
              </div>
  </div>  
  <aside class="nist-page__region nist-page__region--sidebar-second tablet-lg:grid-col-4">
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">

<strong>FiPy: A Finite Volume PDE Solver Using Python</strong><br />
Version 3.4.5+441.g5c25b4570

<div class="sphinxsidebarsection">
  <h4>Previous topic</h4>
  <p class="topless"><a href="examples.phase.binary.html"
                        title="previous chapter">examples.phase.binary</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="examples.phase.impingement.html"
                        title="next chapter">examples.phase.impingement</a></p>
</div>
  <div class="sphinxsidebarsection">
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/generated/examples.phase.binaryCoupled.rst.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
  </div>
<div class="sphinxsidebarsection">
<div id="searchbox" style="display: none" role="search">
  <div data-layout-content-preview-placeholder-label="&quot;Sphinx
  Search&quot; field" class="nist-block nist-block--search">
  <h2 id="searchlabel">Quick search</h2>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
  </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
</div>
<div class="sphinxsidebarsection" id="contact-wrapper">
  
        <div data-layout-content-preview-placeholder-label="&quot;Related
        organization tree&quot; views block" class="nist-block nist-block--org">
          
          <h2 class="nist-block__title">Organizations</h2>
              
              <div class="views-element-container"><div
              class="js-view-dom-id-70b0923f677edbe3dda361030ef8dc373cd0ca94065c39cfd81338de767f1019">

            <div class="nist-related-orgs"><div class="term-tree-list"><ul
            class="term"><li class="selected"><a
            href="https://www.nist.gov/nist-organizations/nist-headquarters" hreflang="en">NIST
            Headquarters</a><ul class="term"><li class="selected"><a
            href="https://www.nist.gov/nist-organizations/nist-headquarters/laboratory-programs"
            hreflang="en">Laboratory Programs</a><ul class="term"><li
            class="selected"><a
            href="https://www.nist.gov/nist-organizations/nist-headquarters/laboratory-programs/material-measurement-laboratory"
            hreflang="en">Material Measurement Laboratory</a>
			<ul
			class="term"><li
			class="selected"><a href="https://www.nist.gov/mml/msed"
			hreflang="en">Materials Science and Engineering
			Division</a></li><li
			class="selected"><a href="https://www.nist.gov/mml/ctcms"
			hreflang="en">Center for Theoretical and
			              Computational Materials Science</a></li></ul>
                          </li></ul></li></ul></li></ul></div></div>
          <div class="nist-related-orgs"></div>
          <div class="nist-related-orgs"></div>



        </div>
        </div>

          </div>


          <div data-layout-content-preview-placeholder-label="&quot;NIST
          Staff&quot; field" class="nist-block nist-block--contact">

          <h2 class="nist-block__title">NIST Staff</h2>

                  <div class="nist-field nist-field--label-hidden
                  nist-field--link-list entity-reference nist-field__items
                  nist-field--no-margin">
                            <div class="nist-field__item
                            nist-field--no-margin"><a
                            href="https://www.nist.gov/people/jonathan-e-guyer"
                            hreflang="en">Jonathan E. Guyer</a></div>
                                <div class="nist-field__item
                                nist-field--no-margin"><a
                                href="https://www.nist.gov/people/daniel-wheeler"
                                hreflang="en">Daniel Wheeler</a></div>
                                <div class="nist-field__item
                                nist-field--no-margin"><a
                                href="https://www.nist.gov/people/james-warren"
                                hreflang="en">James A. Warren</a></div>
                  </div>


          </div>

          <div data-layout-content-preview-placeholder-label="&quot;Contact&quot; field"
          class="nist-block nist-block--contact nist-block--mail">

          <h2 class="nist-block__title">
          <a class="" href="../docs/source/CONTACT.html" style="">Contact</a>
          </h2>

          </div>

</div>
        </div>
      </div>
      <div class="clearer"></div>
  </aside>
        </div>
      </div>

      <div class="panel-region--postface">
      <div class="inner region-inner inside">
        
<div class="pane pane--nist-node-date-pane" >

    </div>
      </div>
    </div>

        </section>
        </div>
      </div>

      </div>  
    </div>          

    </div>

  </div>

</div>


  


  <!-- Taken from https://www.filamentgroup.com/lab/html-includes/#another-demo%3A-including-another-html-file -->
  <iframe src="../_static/ntd2d_menu.html" onload="this.before((this.contentDocument.body||this.contentDocument).children[0]);this.remove()"></iframe>
    </div>
  </body>
</html>