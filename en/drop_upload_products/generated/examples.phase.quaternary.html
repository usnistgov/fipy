
<!DOCTYPE html>


<!--[if IEMobile 7]><html class="iem7 no-js"  lang="en" dir="ltr"><![endif]-->
<!--[if lte IE 6]><html class="lt-ie9 lt-ie8 lt-ie7 no-js"  lang="en" dir="ltr"><![endif]-->
<!--[if (IE 7)&(!IEMobile)]><html class="lt-ie9 lt-ie8 no-js"  lang="en" dir="ltr"><![endif]-->
<!--[if IE 8]><html class="lt-ie9 no-js"  lang="en" dir="ltr"><![endif]-->
<!--[if (gte IE 9)|(gt IEMobile 7)]><!--><html class="no-js"  lang="en" dir="ltr" prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# book: http://ogp.me/ns/book# profile: http://ogp.me/ns/profile# video: http://ogp.me/ns/video# product: http://ogp.me/ns/product# content: http://purl.org/rss/1.0/modules/content/ dc: http://purl.org/dc/terms/ foaf: http://xmlns.com/foaf/0.1/ rdfs: http://www.w3.org/2000/01/rdf-schema# sioc: http://rdfs.org/sioc/ns# sioct: http://rdfs.org/sioc/types# skos: http://www.w3.org/2004/02/skos/core# xsd: http://www.w3.org/2001/XMLSchema#"><!--<![endif]-->

  <head>
<meta charset="utf-8" />
<link rel="shortcut icon" href="https://www.nist.gov/sites/all/themes/nist_style/favicon.ico" type="image/vnd.microsoft.icon" />
<script type="text/x-mathjax-config">MathJax.Hub.Config({
  extensions: ['tex2jax.js'],
  jax: ['input/TeX','output/HTML-CSS'],
  tex2jax: {
    inlineMath: [ ['$$','$$'], ['\\(','\\)'] ],
    processEscapes: true,
    processClass: 'tex2jax',
    ignoreClass: 'html'
  },
  showProcessingMessages: false,
  messageStyle: 'none'
});
</script>
<meta name="MobileOptimized" content="width">
    <meta name="HandheldFriendly" content="true">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=0">

      <!--[if lt IE 9]>
    <script src="https://www.nist.gov/sites/all/themes/zen/js/html5-respond.js"></script>
    <![endif]-->
    <!--[if (gte IE 6)&(lte IE 8)]>
  <script type="text/javascript" src="https://www.nist.gov/sites/all/themes/nist_style/js/selectivizr-min.js"></script>
  <![endif]--><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>examples.phase.quaternary &#8212; FiPy 3.99+6.g13372033c documentation</title>
    <link rel="stylesheet" href="../_static/ntd2d.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/ntd2d.css?v=de7af573" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/widetable.css?v=32b6a719" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=e98124d9"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script>window.MathJax = {"loader": {"load": ["[tex]/textmacros"]}, "tex": {"packages": {"[+]": ["textmacros"]}}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="canonical" href="https://pages.nist.gov/fipy/en/latest/generated/examples.phase.quaternary.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="top" title="FiPy 3.99+6.g13372033c documentation" href="../contents.html" />
    <link rel="up" title="examples.phase" href="examples.phase.html" />
    <link rel="next" title="examples.phase.simple" href="examples.phase.simple.html" />
    <link rel="prev" title="examples.phase.polyxtalCoupled" href="examples.phase.polyxtalCoupled.html" />
  
 


  <link rel="stylesheet" href="https://pages.nist.gov/nist-header-footer/css/nist-combined.css">
  <script src="https://code.jquery.com/jquery-3.6.2.min.js" type="text/javascript" defer="defer"></script>
  <script src="https://pages.nist.gov/nist-header-footer/js/nist-header-footer.js" type="text/javascript" defer="defer"></script>


  </head>
<!--  <body role="document">-->
  <body class="html not-front not-logged-in no-sidebars page-node page-node- page-node-414011 node-type-software hide-breadcrumb section-services-resources page-panels is-panel" role="document">
      <div id="page" class="mini-header">



    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="examples.phase.simple.html" title="examples.phase.simple"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="examples.phase.polyxtalCoupled.html" title="examples.phase.polyxtalCoupled"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html"><img src="../_static/fipy.png" alt="FiPy logo"
                 style="vertical-align: middle; margin-top: -1px"/>
        FiPy</a> &gt;</li>

          <li class="nav-item nav-item-1"><a href="../API.html" ><code class="xref py py-mod docutils literal notranslate"><span class="pre">fipy</span></code> Package Documentation</a> &gt;</li>
          <li class="nav-item nav-item-2"><a href="examples.html" >examples</a> &gt;</li>
          <li class="nav-item nav-item-3"><a href="examples.phase.html" accesskey="U">examples.phase</a> &gt;</li> 
      </ul>
    </div>

  <div id="main" class="clearfix" role="main" tabindex="-1">
    <div class="main__inner">
      <div class="page-info">
        <a id="main-content"></a>
      </div>

      <div class="document">
        <div class="documentwrapper">

      <div id="content" class="column">
      <div id="block-nist-www-content" class="nist-block">
        <section class="nist-page__content usa-section clearfix">

         

        <div class="grid-container margin-top-4">
        <div class="grid-row grid-gap-6">

  <div class="nist-page__region nist-page__region--content tablet-lg:grid-col-8">
              <div class="body" role="main">
		
  <section id="module-examples.phase.quaternary">
<span id="examples-phase-quaternary"></span><h1>examples.phase.quaternary<a class="headerlink" href="#module-examples.phase.quaternary" title="Permalink to this heading">¶</a></h1>
<p>Solve a phase-field evolution and diffusion of four species in one-dimension.</p>
<p>The same procedure used to construct the two-component phase field
diffusion problem in <a class="reference internal" href="examples.phase.binary.html#module-examples.phase.binary" title="examples.phase.binary"><code class="xref py py-mod docutils literal notranslate"><span class="pre">examples.phase.binary</span></code></a> can be used to build up a
system of multiple components. Once again, we’ll focus on 1D.</p>
<div class="doctest highlight-default notranslate" id="index-0"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">fipy</span> <span class="kn">import</span> <span class="n">CellVariable</span><span class="p">,</span> <span class="n">Grid1D</span><span class="p">,</span> <span class="n">TransientTerm</span><span class="p">,</span> <span class="n">DiffusionTerm</span><span class="p">,</span> <span class="n">ImplicitSourceTerm</span><span class="p">,</span> <span class="n">PowerLawConvectionTerm</span><span class="p">,</span> <span class="n">DefaultAsymmetricSolver</span><span class="p">,</span> <span class="n">Viewer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">fipy.tools</span> <span class="kn">import</span> <span class="n">numerix</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nx</span> <span class="o">=</span> <span class="mi">400</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dx</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L</span> <span class="o">=</span> <span class="n">nx</span> <span class="o">*</span> <span class="n">dx</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">Grid1D</span><span class="p">(</span><span class="n">dx</span> <span class="o">=</span> <span class="n">dx</span><span class="p">,</span> <span class="n">nx</span> <span class="o">=</span> <span class="n">nx</span><span class="p">)</span>
</pre></div>
</div>
<p>We consider a free energy density <span class="math notranslate nohighlight">\(f(\phi, C_0,\ldots,C_N, T)\)</span>
that is a function of phase <span class="math notranslate nohighlight">\(\phi\)</span></p>
<div class="doctest highlight-default notranslate" id="index-1"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">phase</span> <span class="o">=</span> <span class="n">CellVariable</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;phase&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">hasOld</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>interstitial components <span class="math notranslate nohighlight">\(C_0 \ldots C_M\)</span></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">interstitials</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="n">CellVariable</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">hasOld</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">... </span><span class="p">]</span>
</pre></div>
</div>
<p>substitutional components <span class="math notranslate nohighlight">\(C_{M+1} \ldots C_{N-1}\)</span></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">substitutionals</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="n">CellVariable</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">hasOld</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">CellVariable</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="n">hasOld</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
<span class="gp">... </span><span class="p">]</span>
</pre></div>
</div>
<p>a “solvent” <span class="math notranslate nohighlight">\(C_N\)</span> that is constrained by the concentrations of the
other substitutional species, such that <span class="math notranslate nohighlight">\(C_N = 1 - \sum_{j=M}^{N-1}
C_j\)</span>,</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">solvent</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">Cj</span> <span class="ow">in</span> <span class="n">substitutionals</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">solvent</span> <span class="o">-=</span> <span class="n">Cj</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solvent</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;CN&#39;</span>
</pre></div>
</div>
<p>and temperature <span class="math notranslate nohighlight">\(T\)</span></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="mi">1000</span>
</pre></div>
</div>
<p>The free energy density of such a system can be written as</p>
<div class="math notranslate nohighlight">
\[f(\phi, C_0, \ldots, C_N, T)
&amp;= \sum_{j=0}^N C_j \left[ \mu^\circ_j(\phi, T) + R T \ln \frac{C_j}{\rho} \right]\]</div>
<p>where</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">R</span> <span class="o">=</span> <span class="mf">8.314</span> <span class="c1"># J / (mol K)</span>
</pre></div>
</div>
<p>is the gas constant. As in the binary case,</p>
<div class="math notranslate nohighlight">
\[\mu^\circ_j(\phi, T) = p(\phi) \mu_j^{\circ S}(T)
+ \left(1 - p(\phi)\right) \mu_j^{\circ L}(T) + \frac{W_j}{2} g(\phi)\]</div>
<p>is constructed with the free energies of the pure components in each
phase, given the “tilting” function</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">p</span><span class="p">(</span><span class="n">phi</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">phi</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="mi">6</span> <span class="o">*</span> <span class="n">phi</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">15</span> <span class="o">*</span> <span class="n">phi</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>and the “double well” function</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">g</span><span class="p">(</span><span class="n">phi</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="p">(</span><span class="n">phi</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">phi</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
<p>We consider a very simplified model that has partial molar volumes
<span class="math notranslate nohighlight">\(\bar{V}_0 = \cdots = \bar{V}_{M} = 0\)</span> for the “interstitials” and
<span class="math notranslate nohighlight">\(\bar{V}_{M+1} = \cdots = \bar{V}_{N} = 1\)</span> for the “substitutionals”.
This approximation has been used in a number of models where density
effects are ignored, including the treatment of electrons in
electrodeposition processes <span id="id1">[<a class="reference internal" href="../references.html#id21" title="J. E. Guyer, W. J. Boettinger, J. A. Warren, and G. B. McFadden. Phase field modeling of electrochemistry I: Equilibrium. Physical Review E, 69:021603, 2004. arXiv:cond-mat/0308173, doi:10.1103/PhysRevE.69.021603.">22</a>]</span> <span id="id2">[<a class="reference internal" href="../references.html#id22" title="J. E. Guyer, W. J. Boettinger, J. A. Warren, and G. B. McFadden. Phase field modeling of electrochemistry II: Kinetics. Physical Review E, 69:021604, 2004. arXiv:cond-mat/0308179, doi:10.1103/PhysRevE.69.021604.">23</a>]</span>. Under these
constraints</p>
<div class="math notranslate nohighlight">
\[\begin{split}\frac{\partial f}{\partial \phi}
&amp;= \sum_{j=0}^N C_j \frac{\partial f_j}{\partial \phi}
\nonumber \\
&amp;= \sum_{j=0}^N C_j \left[
    \mu_j^{\circ SL}(T) p'(\phi) + \frac{W_j}{2} g'(\phi)
\right]
\\
\frac{\partial f}{\partial C_j}
&amp;= \left[\mu^\circ_j(\phi, T) + R T \ln \frac{C_j}{\rho} \right]
\nonumber \\
&amp;= \mu_j(\phi, C_j , T)
\qquad\text{for \( j = 0\ldots M \)}\end{split}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{split}\frac{\partial f}{\partial C_j}
&amp;= \left[\mu^\circ_j(\phi, T) + R T \ln \frac{C_j}{\rho} \right]
- \left[\mu^\circ_N(\phi, T) + R T \ln \frac{C_N}{\rho} \right]
\nonumber \\
&amp;= \left[\mu_j(\phi, C_j, T) - \mu_N(\phi, C_N, T) \right]
\qquad\text{for \( j = M+1\ldots N-1 \)}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mu_j^{\circ SL}(T) \equiv \mu_j^{\circ S}(T) - \mu_j^{\circ
L}(T)\)</span> and where <span class="math notranslate nohighlight">\(\mu_j\)</span> is the classical chemical potential of
component <span class="math notranslate nohighlight">\(j\)</span> for the binary species and <span class="math notranslate nohighlight">\(\rho = 1 +
\sum_{j=0}^{M} C_j\)</span> is the total molar density.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rho</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">Cj</span> <span class="ow">in</span> <span class="n">interstitials</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">rho</span> <span class="o">+=</span> <span class="n">Cj</span>
</pre></div>
</div>
<p><span class="math notranslate nohighlight">\(p'(\phi)\)</span> and <span class="math notranslate nohighlight">\(g'(\phi)\)</span> are the partial derivatives of of <span class="math notranslate nohighlight">\(p\)</span>
and <span class="math notranslate nohighlight">\(g\)</span> with respect to <span class="math notranslate nohighlight">\(\phi\)</span></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">pPrime</span><span class="p">(</span><span class="n">phi</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="mf">30.</span> <span class="o">*</span> <span class="n">g</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">gPrime</span><span class="p">(</span><span class="n">phi</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">phi</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">phi</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">phi</span><span class="p">)</span>
</pre></div>
</div>
<p>We “cook” the standard potentials to give the desired solid and liquid
concentrations, with a solid phase rich in interstitials and the solvent
and a liquid phase rich in the two substitutional species.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">interstitials</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">S</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interstitials</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">L</span> <span class="o">=</span> <span class="mf">0.4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">substitutionals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">S</span> <span class="o">=</span> <span class="mf">0.4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">substitutionals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">L</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">substitutionals</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">S</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">substitutionals</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">L</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solvent</span><span class="o">.</span><span class="n">S</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solvent</span><span class="o">.</span><span class="n">L</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">Cj</span> <span class="ow">in</span> <span class="n">substitutionals</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">solvent</span><span class="o">.</span><span class="n">S</span> <span class="o">-=</span> <span class="n">Cj</span><span class="o">.</span><span class="n">S</span>
<span class="gp">... </span>    <span class="n">solvent</span><span class="o">.</span><span class="n">L</span> <span class="o">-=</span> <span class="n">Cj</span><span class="o">.</span><span class="n">L</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rhoS</span> <span class="o">=</span> <span class="n">rhoL</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">Cj</span> <span class="ow">in</span> <span class="n">interstitials</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">rhoS</span> <span class="o">+=</span> <span class="n">Cj</span><span class="o">.</span><span class="n">S</span>
<span class="gp">... </span>    <span class="n">rhoL</span> <span class="o">+=</span> <span class="n">Cj</span><span class="o">.</span><span class="n">L</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate" id="index-2"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">Cj</span> <span class="ow">in</span> <span class="n">interstitials</span> <span class="o">+</span> <span class="n">substitutionals</span> <span class="o">+</span> <span class="p">[</span><span class="n">solvent</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="n">Cj</span><span class="o">.</span><span class="n">standardPotential</span> <span class="o">=</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="p">(</span><span class="n">numerix</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">Cj</span><span class="o">.</span><span class="n">L</span><span class="o">/</span><span class="n">rhoL</span><span class="p">)</span>
<span class="gp">... </span>                                    <span class="o">-</span> <span class="n">numerix</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">Cj</span><span class="o">.</span><span class="n">S</span><span class="o">/</span><span class="n">rhoS</span><span class="p">))</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">Cj</span> <span class="ow">in</span> <span class="n">interstitials</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">Cj</span><span class="o">.</span><span class="n">diffusivity</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="gp">... </span>    <span class="n">Cj</span><span class="o">.</span><span class="n">barrier</span> <span class="o">=</span> <span class="mf">0.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">Cj</span> <span class="ow">in</span> <span class="n">substitutionals</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">Cj</span><span class="o">.</span><span class="n">diffusivity</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="gp">... </span>    <span class="n">Cj</span><span class="o">.</span><span class="n">barrier</span> <span class="o">=</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">solvent</span><span class="o">.</span><span class="n">barrier</span> <span class="o">=</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T</span>
</pre></div>
</div>
<hr class="docutils" />
<p>We create the phase equation</p>
<div class="math notranslate nohighlight">
\[\frac{1}{M_\phi}\frac{\partial \phi}{\partial t}
= \kappa_\phi \nabla^2 \phi
- \sum_{j=0}^N C_j \left[
           \mu_j^{\circ SL}(T) p'(\phi) + \frac{W_j}{2} g'(\phi)
       \right]\]</div>
<p>with a semi-implicit source just as in <a class="reference internal" href="examples.phase.simple.html#module-examples.phase.simple" title="examples.phase.simple"><code class="xref py py-mod docutils literal notranslate"><span class="pre">examples.phase.simple</span></code></a> and
<a class="reference internal" href="examples.phase.binary.html#module-examples.phase.binary" title="examples.phase.binary"><code class="xref py py-mod docutils literal notranslate"><span class="pre">examples.phase.binary</span></code></a></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">enthalpy</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">barrier</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">Cj</span> <span class="ow">in</span> <span class="n">interstitials</span> <span class="o">+</span> <span class="n">substitutionals</span> <span class="o">+</span> <span class="p">[</span><span class="n">solvent</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="n">enthalpy</span> <span class="o">+=</span> <span class="n">Cj</span> <span class="o">*</span> <span class="n">Cj</span><span class="o">.</span><span class="n">standardPotential</span>
<span class="gp">... </span>    <span class="n">barrier</span> <span class="o">+=</span> <span class="n">Cj</span> <span class="o">*</span> <span class="n">Cj</span><span class="o">.</span><span class="n">barrier</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mPhi</span> <span class="o">=</span> <span class="o">-</span><span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">phase</span><span class="p">)</span> <span class="o">*</span> <span class="n">barrier</span> <span class="o">+</span> <span class="mi">30</span> <span class="o">*</span> <span class="n">phase</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">phase</span><span class="p">)</span> <span class="o">*</span> <span class="n">enthalpy</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dmPhidPhi</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">barrier</span> <span class="o">-</span> <span class="mi">30</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">phase</span><span class="p">)</span> <span class="o">*</span> <span class="n">enthalpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S1</span> <span class="o">=</span> <span class="n">dmPhidPhi</span> <span class="o">*</span> <span class="n">phase</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">phase</span><span class="p">)</span> <span class="o">+</span> <span class="n">mPhi</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">phase</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S0</span> <span class="o">=</span> <span class="n">mPhi</span> <span class="o">*</span> <span class="n">phase</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">phase</span><span class="p">)</span> <span class="o">-</span> <span class="n">S1</span> <span class="o">*</span> <span class="n">phase</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">phase</span><span class="o">.</span><span class="n">mobility</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phase</span><span class="o">.</span><span class="n">gradientEnergy</span> <span class="o">=</span> <span class="mi">25</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phase</span><span class="o">.</span><span class="n">equation</span> <span class="o">=</span> <span class="n">TransientTerm</span><span class="p">(</span><span class="n">coeff</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">phase</span><span class="o">.</span><span class="n">mobility</span><span class="p">)</span> \
<span class="gp">... </span>  <span class="o">==</span> <span class="n">DiffusionTerm</span><span class="p">(</span><span class="n">coeff</span><span class="o">=</span><span class="n">phase</span><span class="o">.</span><span class="n">gradientEnergy</span><span class="p">)</span> \
<span class="gp">... </span>     <span class="o">+</span> <span class="n">S0</span> <span class="o">+</span> <span class="n">ImplicitSourceTerm</span><span class="p">(</span><span class="n">coeff</span> <span class="o">=</span> <span class="n">S1</span><span class="p">)</span>
</pre></div>
</div>
<p>We could construct the diffusion equations one-by-one, in the manner of
<a class="reference internal" href="examples.phase.binary.html#module-examples.phase.binary" title="examples.phase.binary"><code class="xref py py-mod docutils literal notranslate"><span class="pre">examples.phase.binary</span></code></a>, but it is better to take advantage of the full
scripting power of the Python language, where we can easily loop over
components or even make “factory” functions if we desire. For the
interstitial diffusion equations, we arrange in canonical form as before:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\underbrace{
    \frac{\partial C_j}{\partial t}
    \vphantom{\left\{
        \overbrace{
            \left[
                \mu_j^{\circ SL} \nabla p(\phi)
            \right]
        }^{\text{phase transformation}}
    \right\}}
}_{\text{transient}}
&amp;= \underbrace{
    D_j\nabla^2 C_j
    \vphantom{\left\{
        \overbrace{
            \left[
                \mu_j^{\circ SL} \nabla p(\phi)
            \right]
        }^{\text{phase transformation}}
    \right\}}
}_{\text{diffusion}} \\
&amp; \qquad + \underbrace{
    D_j\nabla\cdot
    \frac{C_j}{1 + \sum_{\substack{k=0\\ k \neq j}}^{M} C_k}
    \left\{
        \overbrace{
            \frac{\rho}{R T}
            \left[
                \mu_j^{\circ SL} \nabla p(\phi)
                + \frac{W_j}{2} \nabla g(\phi)
            \right]
        }^{\text{phase transformation}}
        -
        \overbrace{
            \sum_{\substack{i=0\\ i \neq j}}^{M} \nabla C_i
        }^{\text{counter diffusion}}
    \right\}
}_{\text{convection}}\end{split}\]</div>
<div class="doctest highlight-default notranslate" id="index-3"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">Cj</span> <span class="ow">in</span> <span class="n">interstitials</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">phaseTransformation</span> <span class="o">=</span> <span class="p">(</span><span class="n">rho</span><span class="o">.</span><span class="n">harmonicFaceValue</span> <span class="o">/</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span><span class="p">))</span> \
<span class="gp">... </span>      <span class="o">*</span> <span class="p">(</span><span class="n">Cj</span><span class="o">.</span><span class="n">standardPotential</span> <span class="o">*</span> <span class="n">p</span><span class="p">(</span><span class="n">phase</span><span class="p">)</span><span class="o">.</span><span class="n">faceGrad</span>
<span class="gp">... </span>         <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">Cj</span><span class="o">.</span><span class="n">barrier</span> <span class="o">*</span> <span class="n">g</span><span class="p">(</span><span class="n">phase</span><span class="p">)</span><span class="o">.</span><span class="n">faceGrad</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">CkSum</span> <span class="o">=</span> <span class="n">CellVariable</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">Ck</span> <span class="ow">in</span> <span class="p">[</span><span class="n">Ck</span> <span class="k">for</span> <span class="n">Ck</span> <span class="ow">in</span> <span class="n">interstitials</span> <span class="k">if</span> <span class="n">Ck</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">Cj</span><span class="p">]:</span>
<span class="gp">... </span>        <span class="n">CkSum</span> <span class="o">+=</span> <span class="n">Ck</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">counterDiffusion</span> <span class="o">=</span> <span class="n">CkSum</span><span class="o">.</span><span class="n">faceGrad</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">convectionCoeff</span> <span class="o">=</span> <span class="n">counterDiffusion</span> <span class="o">+</span> <span class="n">phaseTransformation</span>
<span class="gp">... </span>    <span class="n">convectionCoeff</span> <span class="o">*=</span> <span class="p">(</span><span class="n">Cj</span><span class="o">.</span><span class="n">diffusivity</span>
<span class="gp">... </span>                        <span class="o">/</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">CkSum</span><span class="o">.</span><span class="n">harmonicFaceValue</span><span class="p">))</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">Cj</span><span class="o">.</span><span class="n">equation</span> <span class="o">=</span> <span class="p">(</span><span class="n">TransientTerm</span><span class="p">()</span>
<span class="gp">... </span>                   <span class="o">==</span> <span class="n">DiffusionTerm</span><span class="p">(</span><span class="n">coeff</span><span class="o">=</span><span class="n">Cj</span><span class="o">.</span><span class="n">diffusivity</span><span class="p">)</span>
<span class="gp">... </span>                   <span class="o">+</span> <span class="n">PowerLawConvectionTerm</span><span class="p">(</span><span class="n">coeff</span><span class="o">=</span><span class="n">convectionCoeff</span><span class="p">))</span>
</pre></div>
</div>
<hr class="docutils" />
<p>The canonical form of the substitutional diffusion equations is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\underbrace{
     \frac{\partial C_j}{\partial t}
}_{\text{transient}}
 &amp;= \underbrace{
     D_{j}\nabla^2 C_j
     \vphantom{\frac{\partial C_j}{\partial t}}
 }_{\text{diffusion}} \\
 &amp; \qquad + \underbrace{
     D_{j}\nabla\cdot
     \frac{C_j}{1 - \sum_{\substack{k=M+1\\ k \neq j}}^{N-1} C_k}
     \left\{
        \overbrace{
             \frac{C_N}{R T}
             \left[
                 \left(\mu_j^{\circ SL} - \mu_N^{\circ SL}\right) \nabla p(\phi)
                 + \frac{W_j - W_N}{2} \nabla g(\phi)
             \right]
             \vphantom{\sum_{\substack{i=M+1\\ i \neq j}}^{N-1} \nabla C_i}
        }^{\text{phase transformation}}
        +
        \overbrace{
            \sum_{\substack{i=M+1\\ i \neq j}}^{N-1} \nabla C_i
        }^{\text{counter diffusion}}
     \right\}
 }_{\text{convection}}\end{split}\]</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">Cj</span> <span class="ow">in</span> <span class="n">substitutionals</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">phaseTransformation</span> <span class="o">=</span> <span class="p">(</span><span class="n">solvent</span><span class="o">.</span><span class="n">harmonicFaceValue</span> <span class="o">/</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span><span class="p">))</span> \
<span class="gp">... </span>      <span class="o">*</span> <span class="p">((</span><span class="n">Cj</span><span class="o">.</span><span class="n">standardPotential</span> <span class="o">-</span> <span class="n">solvent</span><span class="o">.</span><span class="n">standardPotential</span><span class="p">)</span> <span class="o">*</span> <span class="n">p</span><span class="p">(</span><span class="n">phase</span><span class="p">)</span><span class="o">.</span><span class="n">faceGrad</span>
<span class="gp">... </span>         <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">Cj</span><span class="o">.</span><span class="n">barrier</span> <span class="o">-</span> <span class="n">solvent</span><span class="o">.</span><span class="n">barrier</span><span class="p">)</span> <span class="o">*</span> <span class="n">g</span><span class="p">(</span><span class="n">phase</span><span class="p">)</span><span class="o">.</span><span class="n">faceGrad</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">CkSum</span> <span class="o">=</span> <span class="n">CellVariable</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">Ck</span> <span class="ow">in</span> <span class="p">[</span><span class="n">Ck</span> <span class="k">for</span> <span class="n">Ck</span> <span class="ow">in</span> <span class="n">substitutionals</span> <span class="k">if</span> <span class="n">Ck</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">Cj</span><span class="p">]:</span>
<span class="gp">... </span>        <span class="n">CkSum</span> <span class="o">+=</span> <span class="n">Ck</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">counterDiffusion</span> <span class="o">=</span> <span class="n">CkSum</span><span class="o">.</span><span class="n">faceGrad</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">convectionCoeff</span> <span class="o">=</span> <span class="n">counterDiffusion</span> <span class="o">+</span> <span class="n">phaseTransformation</span>
<span class="gp">... </span>    <span class="n">convectionCoeff</span> <span class="o">*=</span> <span class="p">(</span><span class="n">Cj</span><span class="o">.</span><span class="n">diffusivity</span>
<span class="gp">... </span>                        <span class="o">/</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">CkSum</span><span class="o">.</span><span class="n">harmonicFaceValue</span><span class="p">))</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">Cj</span><span class="o">.</span><span class="n">equation</span> <span class="o">=</span> <span class="p">(</span><span class="n">TransientTerm</span><span class="p">()</span>
<span class="gp">... </span>                   <span class="o">==</span> <span class="n">DiffusionTerm</span><span class="p">(</span><span class="n">coeff</span><span class="o">=</span><span class="n">Cj</span><span class="o">.</span><span class="n">diffusivity</span><span class="p">)</span>
<span class="gp">... </span>                   <span class="o">+</span> <span class="n">PowerLawConvectionTerm</span><span class="p">(</span><span class="n">coeff</span><span class="o">=</span><span class="n">convectionCoeff</span><span class="p">))</span>
</pre></div>
</div>
<hr class="docutils" />
<p>We start with a sharp phase boundary</p>
<div class="math notranslate nohighlight">
\[\begin{split}\xi =
\begin{cases}
    1&amp; \text{for $x \le L/2$,} \\
    0&amp; \text{for $x &gt; L/2$,}
\end{cases}\end{split}\]</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">cellCenters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phase</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mf">1.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phase</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">x</span> <span class="o">&gt;</span> <span class="n">L</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>and with uniform concentration fields, initially equal to the average of
the solidus and liquidus concentrations</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">Cj</span> <span class="ow">in</span> <span class="n">interstitials</span> <span class="o">+</span> <span class="n">substitutionals</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">Cj</span><span class="o">.</span><span class="n">setValue</span><span class="p">((</span><span class="n">Cj</span><span class="o">.</span><span class="n">S</span> <span class="o">+</span> <span class="n">Cj</span><span class="o">.</span><span class="n">L</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">)</span>
</pre></div>
</div>
<p>If we’re running interactively, we create a viewer</p>
<div class="doctest highlight-default notranslate" id="index-4"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">viewer</span> <span class="o">=</span> <span class="n">Viewer</span><span class="p">(</span><span class="nb">vars</span><span class="o">=</span><span class="p">([</span><span class="n">phase</span><span class="p">]</span>
<span class="gp">... </span>                          <span class="o">+</span> <span class="n">interstitials</span> <span class="o">+</span> <span class="n">substitutionals</span>
<span class="gp">... </span>                          <span class="o">+</span> <span class="p">[</span><span class="n">solvent</span><span class="p">]),</span>
<span class="gp">... </span>                    <span class="n">datamin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">datamax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">viewer</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>and again iterate to equilibrium.  The initial residual is much larger than
the norm of the right-hand-side vector, so we use <cite>“initial”</cite> tolerance
scaling.</p>
<div class="doctest highlight-default notranslate" id="index-5"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">solver</span> <span class="o">=</span> <span class="n">DefaultAsymmetricSolver</span><span class="p">(</span><span class="n">criterion</span><span class="o">=</span><span class="s2">&quot;initial&quot;</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dt</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="p">[</span><span class="n">phase</span><span class="p">]</span> <span class="o">+</span> <span class="n">substitutionals</span> <span class="o">+</span> <span class="n">interstitials</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">field</span><span class="o">.</span><span class="n">updateOld</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">phase</span><span class="o">.</span><span class="n">equation</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">var</span> <span class="o">=</span> <span class="n">phase</span><span class="p">,</span> <span class="n">dt</span> <span class="o">=</span> <span class="n">dt</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">substitutionals</span> <span class="o">+</span> <span class="n">interstitials</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">field</span><span class="o">.</span><span class="n">equation</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">var</span> <span class="o">=</span> <span class="n">field</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="n">dt</span> <span class="o">=</span> <span class="n">dt</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="n">solver</span> <span class="o">=</span> <span class="n">solver</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">viewer</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/quaternary1.png"><img alt="phase and four composition fields in equilibrium" class="align-center" src="../_images/quaternary1.png" style="width: 90%;" /></a>
<p>We can confirm that the far-field phases have remained separated</p>
<div class="doctest highlight-default notranslate" id="index-6"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">faceCenters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">numerix</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">phase</span><span class="o">.</span><span class="n">faceValue</span><span class="p">[</span><span class="n">X</span><span class="o">.</span><span class="n">value</span><span class="o">==</span><span class="mi">0</span><span class="p">],</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">rtol</span> <span class="o">=</span> <span class="mf">1e-5</span><span class="p">,</span> <span class="n">atol</span> <span class="o">=</span> <span class="mf">1e-5</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">numerix</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">phase</span><span class="o">.</span><span class="n">faceValue</span><span class="p">[</span><span class="n">X</span><span class="o">.</span><span class="n">value</span><span class="o">==</span><span class="n">L</span><span class="p">],</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">rtol</span> <span class="o">=</span> <span class="mf">1e-5</span><span class="p">,</span> <span class="n">atol</span> <span class="o">=</span> <span class="mf">1e-5</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>and that the concentration fields have appropriately segregated into
their equilibrium values in each phase</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">equilibrium</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">Cj</span> <span class="ow">in</span> <span class="n">interstitials</span> <span class="o">+</span> <span class="n">substitutionals</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">equilibrium</span> <span class="o">&amp;=</span> <span class="n">numerix</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">Cj</span><span class="o">.</span><span class="n">faceValue</span><span class="p">[</span><span class="n">X</span><span class="o">.</span><span class="n">value</span><span class="o">==</span><span class="mi">0</span><span class="p">],</span> <span class="n">Cj</span><span class="o">.</span><span class="n">S</span><span class="p">,</span> <span class="n">rtol</span> <span class="o">=</span> <span class="mf">3e-3</span><span class="p">,</span> <span class="n">atol</span> <span class="o">=</span> <span class="mf">3e-3</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
<span class="gp">... </span>    <span class="n">equilibrium</span> <span class="o">&amp;=</span> <span class="n">numerix</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">Cj</span><span class="o">.</span><span class="n">faceValue</span><span class="p">[</span><span class="n">X</span><span class="o">.</span><span class="n">value</span><span class="o">==</span><span class="n">L</span><span class="p">],</span> <span class="n">Cj</span><span class="o">.</span><span class="n">L</span><span class="p">,</span> <span class="n">rtol</span> <span class="o">=</span> <span class="mf">3e-3</span><span class="p">,</span> <span class="n">atol</span> <span class="o">=</span> <span class="mf">3e-3</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">equilibrium</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</section>


                <div class='last-updated'>
                Last updated on Sep 08, 2025.
                Created using <a href="http://sphinx-doc.org/">Sphinx</a> 7.1.2.
                </div>
              </div>
  </div>  
  <aside class="nist-page__region nist-page__region--sidebar-second tablet-lg:grid-col-4">
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">

<strong>FiPy: A Finite Volume PDE Solver Using Python</strong><br />
Version 3.99+6.g13372033c

<div class="sphinxsidebarsection">
  <h4>Previous topic</h4>
  <p class="topless"><a href="examples.phase.polyxtalCoupled.html"
                        title="previous chapter">examples.phase.polyxtalCoupled</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="examples.phase.simple.html"
                        title="next chapter">examples.phase.simple</a></p>
</div>
  <div class="sphinxsidebarsection">
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/generated/examples.phase.quaternary.rst.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
  </div>
<div class="sphinxsidebarsection">
<div id="searchbox" style="display: none" role="search">
  <div data-layout-content-preview-placeholder-label="&quot;Sphinx
  Search&quot; field" class="nist-block nist-block--search">
  <h2 id="searchlabel">Quick search</h2>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
  </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
</div>
<div class="sphinxsidebarsection" id="contact-wrapper">
  
        <div data-layout-content-preview-placeholder-label="&quot;Related
        organization tree&quot; views block" class="nist-block nist-block--org">
          
          <h2 class="nist-block__title">Organizations</h2>
              
              <div class="views-element-container"><div
              class="js-view-dom-id-70b0923f677edbe3dda361030ef8dc373cd0ca94065c39cfd81338de767f1019">

            <div class="nist-related-orgs"><div class="term-tree-list"><ul
            class="term"><li class="selected"><a
            href="https://www.nist.gov/nist-organizations/nist-headquarters" hreflang="en">NIST
            Headquarters</a><ul class="term"><li class="selected"><a
            href="https://www.nist.gov/nist-organizations/nist-headquarters/laboratory-programs"
            hreflang="en">Laboratory Programs</a><ul class="term"><li
            class="selected"><a
            href="https://www.nist.gov/nist-organizations/nist-headquarters/laboratory-programs/material-measurement-laboratory"
            hreflang="en">Material Measurement Laboratory</a>
			<ul
			class="term"><li
			class="selected"><a href="https://www.nist.gov/mml/msed"
			hreflang="en">Materials Science and Engineering
			Division</a></li><li
			class="selected"><a href="https://www.nist.gov/mml/ctcms"
			hreflang="en">Center for Theoretical and
			              Computational Materials Science</a></li></ul>
                          </li></ul></li></ul></li></ul></div></div>
          <div class="nist-related-orgs"></div>
          <div class="nist-related-orgs"></div>



        </div>
        </div>

          </div>


          <div data-layout-content-preview-placeholder-label="&quot;NIST
          Staff&quot; field" class="nist-block nist-block--contact">

          <h2 class="nist-block__title">NIST Staff</h2>

                  <div class="nist-field nist-field--label-hidden
                  nist-field--link-list entity-reference nist-field__items
                  nist-field--no-margin">
                            <div class="nist-field__item
                            nist-field--no-margin"><a
                            href="https://www.nist.gov/people/jonathan-e-guyer"
                            hreflang="en">Jonathan E. Guyer</a></div>
                                <div class="nist-field__item
                                nist-field--no-margin"><a
                                href="https://www.nist.gov/people/daniel-wheeler"
                                hreflang="en">Daniel Wheeler</a></div>
                                <div class="nist-field__item
                                nist-field--no-margin"><a
                                href="https://www.nist.gov/people/james-warren"
                                hreflang="en">James A. Warren</a></div>
                  </div>


          </div>

          <div data-layout-content-preview-placeholder-label="&quot;Contact&quot; field"
          class="nist-block nist-block--contact nist-block--mail">

          <h2 class="nist-block__title">
          <a class="" href="../docs/source/CONTACT.html" style="">Contact</a>
          </h2>

          </div>

</div>
        </div>
      </div>
      <div class="clearer"></div>
  </aside>
        </div>
      </div>

      <div class="panel-region--postface">
      <div class="inner region-inner inside">
        
<div class="pane pane--nist-node-date-pane" >

    </div>
      </div>
    </div>

        </section>
        </div>
      </div>

      </div>  
    </div>          

    </div>

  </div>

</div>


  


  <!-- Taken from https://www.filamentgroup.com/lab/html-includes/#another-demo%3A-including-another-html-file -->
  <iframe src="../_static/ntd2d_menu.html" onload="this.before((this.contentDocument.body||this.contentDocument).children[0]);this.remove()"></iframe>
    </div>
  </body>
</html>