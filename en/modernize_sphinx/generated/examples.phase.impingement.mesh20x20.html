
<!DOCTYPE html>


<!--[if IEMobile 7]><html class="iem7 no-js"  lang="en" dir="ltr"><![endif]-->
<!--[if lte IE 6]><html class="lt-ie9 lt-ie8 lt-ie7 no-js"  lang="en" dir="ltr"><![endif]-->
<!--[if (IE 7)&(!IEMobile)]><html class="lt-ie9 lt-ie8 no-js"  lang="en" dir="ltr"><![endif]-->
<!--[if IE 8]><html class="lt-ie9 no-js"  lang="en" dir="ltr"><![endif]-->
<!--[if (gte IE 9)|(gt IEMobile 7)]><!--><html class="no-js"  lang="en" dir="ltr" prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# book: http://ogp.me/ns/book# profile: http://ogp.me/ns/profile# video: http://ogp.me/ns/video# product: http://ogp.me/ns/product# content: http://purl.org/rss/1.0/modules/content/ dc: http://purl.org/dc/terms/ foaf: http://xmlns.com/foaf/0.1/ rdfs: http://www.w3.org/2000/01/rdf-schema# sioc: http://rdfs.org/sioc/ns# sioct: http://rdfs.org/sioc/types# skos: http://www.w3.org/2004/02/skos/core# xsd: http://www.w3.org/2001/XMLSchema#"><!--<![endif]-->

  <head>
<meta charset="utf-8" />
<link rel="shortcut icon" href="https://www.nist.gov/sites/all/themes/nist_style/favicon.ico" type="image/vnd.microsoft.icon" />
<script type="text/x-mathjax-config">MathJax.Hub.Config({
  extensions: ['tex2jax.js'],
  jax: ['input/TeX','output/HTML-CSS'],
  tex2jax: {
    inlineMath: [ ['$$','$$'], ['\\(','\\)'] ],
    processEscapes: true,
    processClass: 'tex2jax',
    ignoreClass: 'html'
  },
  showProcessingMessages: false,
  messageStyle: 'none'
});
</script>
<meta name="MobileOptimized" content="width">
    <meta name="HandheldFriendly" content="true">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=0">

      <!--[if lt IE 9]>
    <script src="https://www.nist.gov/sites/all/themes/zen/js/html5-respond.js"></script>
    <![endif]-->
    <!--[if (gte IE 6)&(lte IE 8)]>
  <script type="text/javascript" src="https://www.nist.gov/sites/all/themes/nist_style/js/selectivizr-min.js"></script>
  <![endif]--><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>examples.phase.impingement.mesh20x20 &#8212; FiPy 3.4.4+256.g961ca499 documentation</title>
    <link rel="stylesheet" href="../_static/ntd2d.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/ntd2d.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="top" title="FiPy 3.4.4+256.g961ca499 documentation" href="../contents.html" />
    <link rel="up" title="examples.phase.impingement" href="examples.phase.impingement.html" />
    <link rel="next" title="examples.phase.impingement.mesh40x1" href="examples.phase.impingement.mesh40x1.html" />
    <link rel="prev" title="examples.phase.impingement" href="examples.phase.impingement.html" />
  
 


  <link rel="stylesheet" href="https://pages.nist.gov/nist-header-footer/css/nist-combined.css">
  <script src="https://code.jquery.com/jquery-3.6.2.min.js" type="text/javascript" defer="defer"></script>
  <script src="https://pages.nist.gov/nist-header-footer/js/nist-header-footer.js" type="text/javascript" defer="defer"></script>

  </head>
<!--  <body role="document">-->
  <body class="html not-front not-logged-in no-sidebars page-node page-node- page-node-414011 node-type-software hide-breadcrumb section-services-resources page-panels is-panel" role="document">
      <div id="page" class="mini-header">



    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="examples.phase.impingement.mesh40x1.html" title="examples.phase.impingement.mesh40x1"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="examples.phase.impingement.html" title="examples.phase.impingement"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html"><img src="../_static/fipy.png" alt="FiPy logo"
                 style="vertical-align: middle; margin-top: -1px"/>
        FiPy</a> &gt;</li>

          <li class="nav-item nav-item-1"><a href="../API.html" ><code class="xref py py-mod docutils literal notranslate"><span class="pre">fipy</span></code> Package Documentation</a> &gt;</li>
          <li class="nav-item nav-item-2"><a href="examples.html" >examples</a> &gt;</li>
          <li class="nav-item nav-item-3"><a href="examples.phase.html" >examples.phase</a> &gt;</li>
          <li class="nav-item nav-item-4"><a href="examples.phase.impingement.html" accesskey="U">examples.phase.impingement</a> &gt;</li> 
      </ul>
    </div>

  <div id="main" class="clearfix" role="main" tabindex="-1">
    <div class="main__inner">
      <div class="page-info">
        <a id="main-content"></a>
      </div>

      <div class="document">
        <div class="documentwrapper">

      <div id="content" class="column">
      <div id="block-nist-www-content" class="nist-block">
        <section class="nist-page__content usa-section clearfix">

         

        <div class="grid-container margin-top-4">
        <div class="grid-row grid-gap-6">

  <div class="nist-page__region nist-page__region--content tablet-lg:grid-col-8">
              <div class="body" role="main">
		
  <section id="module-examples.phase.impingement.mesh20x20">
<span id="examples-phase-impingement-mesh20x20"></span><h1>examples.phase.impingement.mesh20x20<a class="headerlink" href="#module-examples.phase.impingement.mesh20x20" title="Permalink to this heading">¶</a></h1>
<p>Solve for the impingement of four grains in two dimensions.</p>
<p>In the following examples, we solve the same set of equations as in
<a class="reference internal" href="examples.phase.impingement.mesh40x1.html#module-examples.phase.impingement.mesh40x1" title="examples.phase.impingement.mesh40x1"><code class="xref py py-mod docutils literal notranslate"><span class="pre">examples.phase.impingement.mesh40x1</span></code></a>
with different initial conditions and a 2D mesh:</p>
<div class="doctest highlight-default notranslate" id="index-0"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">fipy.tools.parser</span> <span class="kn">import</span> <span class="n">parse</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">numberOfElements</span> <span class="o">=</span> <span class="n">parse</span><span class="p">(</span><span class="s1">&#39;--numberOfElements&#39;</span><span class="p">,</span> <span class="n">action</span> <span class="o">=</span> <span class="s1">&#39;store&#39;</span><span class="p">,</span>
<span class="gp">... </span>                         <span class="nb">type</span> <span class="o">=</span> <span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="n">default</span> <span class="o">=</span> <span class="mi">400</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">numberOfSteps</span> <span class="o">=</span> <span class="n">parse</span><span class="p">(</span><span class="s1">&#39;--numberOfSteps&#39;</span><span class="p">,</span> <span class="n">action</span> <span class="o">=</span> <span class="s1">&#39;store&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="nb">type</span> <span class="o">=</span> <span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="n">default</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate" id="index-1"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">fipy</span> <span class="kn">import</span> <span class="n">CellVariable</span><span class="p">,</span> <span class="n">ModularVariable</span><span class="p">,</span> <span class="n">Grid2D</span><span class="p">,</span> <span class="n">TransientTerm</span><span class="p">,</span> <span class="n">DiffusionTerm</span><span class="p">,</span> <span class="n">ExplicitDiffusionTerm</span><span class="p">,</span> <span class="n">ImplicitSourceTerm</span><span class="p">,</span> <span class="n">GeneralSolver</span><span class="p">,</span> <span class="n">Viewer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">fipy.tools</span> <span class="kn">import</span> <span class="n">numerix</span><span class="p">,</span> <span class="n">dump</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">steps</span> <span class="o">=</span> <span class="n">numberOfSteps</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">numerix</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">numberOfElements</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L</span> <span class="o">=</span> <span class="mf">2.5</span> <span class="o">*</span> <span class="n">N</span> <span class="o">/</span> <span class="mf">100.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dL</span> <span class="o">=</span> <span class="n">L</span> <span class="o">/</span> <span class="n">N</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">Grid2D</span><span class="p">(</span><span class="n">dx</span><span class="o">=</span><span class="n">dL</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="n">dL</span><span class="p">,</span> <span class="n">nx</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">ny</span><span class="o">=</span><span class="n">N</span><span class="p">)</span>
</pre></div>
</div>
<p>The initial conditions are given by
<span class="math notranslate nohighlight">\(\phi = 1\)</span> and</p>
<div class="math notranslate nohighlight">
\[\begin{split}\theta = \begin{cases}
\frac{2 \pi}{3} &amp; \text{for $x^2 - y^2 &lt; L / 2$,} \\
\frac{-2 \pi}{3} &amp; \text{for $(x-L)^2 - y^2 &lt; L / 2$,} \\
\frac{-2 \pi}{3}+0.3 &amp; \text{for $x^2 - (y-L)^2 &lt; L / 2$,} \\
\frac{2 \pi}{3} &amp; \text{for $(x-L)^2 - (y-L)^2 &lt; L / 2$.}
\end{cases}\end{split}\]</div>
<p>This defines four solid regions with different
orientations. Solidification occurs and then boundary wetting occurs
where the orientation varies.</p>
<p>The parameters for this example are</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">timeStepDuration</span> <span class="o">=</span> <span class="mf">0.02</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phaseTransientCoeff</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thetaSmallValue</span> <span class="o">=</span> <span class="mf">1e-6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">beta</span> <span class="o">=</span> <span class="mf">1e5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mu</span> <span class="o">=</span> <span class="mf">1e3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thetaTransientCoeff</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gamma</span><span class="o">=</span> <span class="mf">1e3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">epsilon</span> <span class="o">=</span> <span class="mf">0.008</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.015</span>
</pre></div>
</div>
<p>The system is held isothermal at</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">10.</span>
</pre></div>
</div>
<p>and is initialized to liquid everywhere</p>
<div class="doctest highlight-default notranslate" id="index-2"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">phase</span> <span class="o">=</span> <span class="n">CellVariable</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;phase field&#39;</span><span class="p">,</span> <span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">)</span>
</pre></div>
</div>
<p>The orientation is initialized to a uniform value to denote the
randomly oriented liquid phase</p>
<div class="doctest highlight-default notranslate" id="index-3"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">ModularVariable</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;theta&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">value</span><span class="o">=-</span><span class="n">numerix</span><span class="o">.</span><span class="n">pi</span> <span class="o">+</span> <span class="mf">0.0001</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">hasOld</span><span class="o">=</span><span class="mi">1</span>
<span class="gp">... </span>    <span class="p">)</span>
</pre></div>
</div>
<p>Four different solid circular domains are created at each corner of
the domain with appropriate orientations</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">cellCenters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">thetaValue</span> <span class="ow">in</span> <span class="p">((</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">2.</span> <span class="o">*</span> <span class="n">numerix</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">3.</span><span class="p">),</span>
<span class="gp">... </span>                         <span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.</span> <span class="o">*</span> <span class="n">numerix</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">3.</span><span class="p">),</span>
<span class="gp">... </span>                         <span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.</span> <span class="o">*</span> <span class="n">numerix</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">3.</span> <span class="o">+</span> <span class="mf">0.3</span><span class="p">),</span>
<span class="gp">... </span>                         <span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span>  <span class="mf">2.</span> <span class="o">*</span> <span class="n">numerix</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">3.</span><span class="p">)):</span>
<span class="gp">... </span>    <span class="n">segment</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">L</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="gp">... </span>    <span class="n">phase</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">segment</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">theta</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">thetaValue</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">segment</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">phase</span></code> equation is built in the following way. The source term is
linearized in the manner demonstrated in <a class="reference internal" href="examples.phase.simple.html#module-examples.phase.simple" title="examples.phase.simple"><code class="xref py py-mod docutils literal notranslate"><span class="pre">examples.phase.simple</span></code></a>
(Kobayashi, semi-implicit). Here we use a function to build the equation,
so that it can be reused later.</p>
<div class="doctest highlight-default notranslate" id="index-4"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">buildPhaseEquation</span><span class="p">(</span><span class="n">phase</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">mPhiVar</span> <span class="o">=</span> <span class="n">phase</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="n">temperature</span> <span class="o">*</span> <span class="n">phase</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">phase</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">thetaMag</span> <span class="o">=</span> <span class="n">theta</span><span class="o">.</span><span class="n">old</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">mag</span>
<span class="gp">... </span>    <span class="n">implicitSource</span> <span class="o">=</span> <span class="n">mPhiVar</span> <span class="o">*</span> <span class="p">(</span><span class="n">phase</span> <span class="o">-</span> <span class="p">(</span><span class="n">mPhiVar</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">... </span>    <span class="n">implicitSource</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">s</span> <span class="o">+</span> <span class="n">epsilon</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">thetaMag</span><span class="p">)</span> <span class="o">*</span> <span class="n">thetaMag</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">TransientTerm</span><span class="p">(</span><span class="n">phaseTransientCoeff</span><span class="p">)</span> <span class="o">==</span> \
<span class="gp">... </span>              <span class="n">ExplicitDiffusionTerm</span><span class="p">(</span><span class="n">alpha</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> \
<span class="gp">... </span>              <span class="o">-</span> <span class="n">ImplicitSourceTerm</span><span class="p">(</span><span class="n">implicitSource</span><span class="p">)</span> \
<span class="gp">... </span>              <span class="o">+</span> <span class="p">(</span><span class="n">mPhiVar</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="n">mPhiVar</span> <span class="o">*</span> <span class="n">phase</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">phaseEq</span> <span class="o">=</span> <span class="n">buildPhaseEquation</span><span class="p">(</span><span class="n">phase</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">theta</span></code> equation is built in the following way. The details for
this equation are fairly involved, see J. A. Warren <em>et al.</em>. The main
detail is that a source must be added to correct for the
discretization of <code class="docutils literal notranslate"><span class="pre">theta</span></code> on the circle.  The source term requires the
evaluation of the face gradient without the modular operators.</p>
<div class="doctest highlight-default notranslate" id="index-5"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">buildThetaEquation</span><span class="p">(</span><span class="n">phase</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">phaseMod</span> <span class="o">=</span> <span class="n">phase</span> <span class="o">+</span> <span class="p">(</span> <span class="n">phase</span> <span class="o">&lt;</span> <span class="n">thetaSmallValue</span> <span class="p">)</span> <span class="o">*</span> <span class="n">thetaSmallValue</span>
<span class="gp">... </span>    <span class="n">phaseModSq</span> <span class="o">=</span> <span class="n">phaseMod</span> <span class="o">*</span> <span class="n">phaseMod</span>
<span class="gp">... </span>    <span class="n">expo</span> <span class="o">=</span> <span class="n">epsilon</span> <span class="o">*</span> <span class="n">beta</span> <span class="o">*</span> <span class="n">theta</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">mag</span>
<span class="gp">... </span>    <span class="n">expo</span> <span class="o">=</span> <span class="p">(</span><span class="n">expo</span> <span class="o">&lt;</span> <span class="mf">100.</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">expo</span> <span class="o">-</span> <span class="mf">100.</span><span class="p">)</span> <span class="o">+</span> <span class="mf">100.</span>
<span class="gp">... </span>    <span class="n">pFunc</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">+</span> <span class="n">numerix</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">expo</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">mu</span> <span class="o">/</span> <span class="n">epsilon</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">phaseFace</span> <span class="o">=</span> <span class="n">phase</span><span class="o">.</span><span class="n">arithmeticFaceValue</span>
<span class="gp">... </span>    <span class="n">phaseSq</span> <span class="o">=</span> <span class="n">phaseFace</span> <span class="o">*</span> <span class="n">phaseFace</span>
<span class="gp">... </span>    <span class="n">gradMag</span> <span class="o">=</span> <span class="n">theta</span><span class="o">.</span><span class="n">faceGrad</span><span class="o">.</span><span class="n">mag</span>
<span class="gp">... </span>    <span class="n">eps</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">/</span> <span class="n">gamma</span> <span class="o">/</span> <span class="mf">10.</span>
<span class="gp">... </span>    <span class="n">gradMag</span> <span class="o">+=</span> <span class="p">(</span><span class="n">gradMag</span> <span class="o">&lt;</span> <span class="n">eps</span><span class="p">)</span> <span class="o">*</span> <span class="n">eps</span>
<span class="gp">... </span>    <span class="n">IGamma</span> <span class="o">=</span> <span class="p">(</span><span class="n">gradMag</span> <span class="o">&gt;</span> <span class="mf">1.</span> <span class="o">/</span> <span class="n">gamma</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">gradMag</span> <span class="o">-</span> <span class="n">gamma</span><span class="p">)</span> <span class="o">+</span> <span class="n">gamma</span>
<span class="gp">... </span>    <span class="n">diffusionCoeff</span> <span class="o">=</span> <span class="n">phaseSq</span> <span class="o">*</span> <span class="p">(</span><span class="n">s</span> <span class="o">*</span> <span class="n">IGamma</span> <span class="o">+</span> <span class="n">epsilon</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">thetaGradDiff</span> <span class="o">=</span> <span class="n">theta</span><span class="o">.</span><span class="n">faceGrad</span> <span class="o">-</span> <span class="n">theta</span><span class="o">.</span><span class="n">faceGradNoMod</span>
<span class="gp">... </span>    <span class="n">sourceCoeff</span> <span class="o">=</span> <span class="p">(</span><span class="n">diffusionCoeff</span> <span class="o">*</span> <span class="n">thetaGradDiff</span><span class="p">)</span><span class="o">.</span><span class="n">divergence</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">TransientTerm</span><span class="p">(</span><span class="n">thetaTransientCoeff</span> <span class="o">*</span> <span class="n">phaseModSq</span> <span class="o">*</span> <span class="n">pFunc</span><span class="p">)</span> <span class="o">==</span> \
<span class="gp">... </span>               <span class="n">DiffusionTerm</span><span class="p">(</span><span class="n">diffusionCoeff</span><span class="p">)</span> \
<span class="gp">... </span>               <span class="o">+</span> <span class="n">sourceCoeff</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">thetaEq</span> <span class="o">=</span> <span class="n">buildThetaEquation</span><span class="p">(</span><span class="n">phase</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
</pre></div>
</div>
<p>If the example is run interactively, we create viewers for the phase
and orientation variables. Rather than viewing the raw orientation,
which is not meaningful in the liquid phase, we weight the orientation
by the phase</p>
<div class="doctest highlight-default notranslate" id="index-6"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">phaseViewer</span> <span class="o">=</span> <span class="n">Viewer</span><span class="p">(</span><span class="nb">vars</span><span class="o">=</span><span class="n">phase</span><span class="p">,</span> <span class="n">datamin</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">datamax</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">thetaProd</span> <span class="o">=</span> <span class="o">-</span><span class="n">numerix</span><span class="o">.</span><span class="n">pi</span> <span class="o">+</span> <span class="n">phase</span> <span class="o">*</span> <span class="p">(</span><span class="n">theta</span> <span class="o">+</span> <span class="n">numerix</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">thetaProductViewer</span> <span class="o">=</span> <span class="n">Viewer</span><span class="p">(</span><span class="nb">vars</span><span class="o">=</span><span class="n">thetaProd</span><span class="p">,</span>
<span class="gp">... </span>                                <span class="n">datamin</span><span class="o">=-</span><span class="n">numerix</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">datamax</span><span class="o">=</span><span class="n">numerix</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">phaseViewer</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">thetaProductViewer</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>The solution will be tested against data that was created with <code class="docutils literal notranslate"><span class="pre">steps</span>
<span class="pre">=</span> <span class="pre">10</span></code> with a FORTRAN code written by Ryo Kobayashi for phase field
modeling. The following code opens the file <code class="file docutils literal notranslate"><span class="pre">mesh20x20.gz</span></code> extracts the
data and compares it with the <cite>theta</cite> variable.</p>
<div class="doctest highlight-default notranslate" id="index-7"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">future.utils</span> <span class="kn">import</span> <span class="n">text_to_native_str</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">testData</span> <span class="o">=</span> <span class="n">numerix</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">text_to_native_str</span><span class="p">(</span><span class="s1">&#39;.gz&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">flat</span>
</pre></div>
</div>
<p>We step the solution in time, plotting as we go if running interactively,</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">builtins</span> <span class="kn">import</span> <span class="nb">range</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">theta</span><span class="o">.</span><span class="n">updateOld</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">thetaEq</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">timeStepDuration</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="n">GeneralSolver</span><span class="p">(</span><span class="n">iterations</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">1e-15</span><span class="p">))</span>
<span class="gp">... </span>    <span class="n">phaseEq</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">phase</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">timeStepDuration</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="n">GeneralSolver</span><span class="p">(</span><span class="n">iterations</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">1e-15</span><span class="p">))</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">phaseViewer</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gp">... </span>        <span class="n">thetaProductViewer</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>The solution is compared against Ryo Kobayashi’s test data</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">theta</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">testData</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-7</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-7</span><span class="p">))</span>
<span class="go">1</span>
</pre></div>
</div>
<p>The following code shows how to restart a simulation from some saved
data. First, reset the variables to their original values.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">phase</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="o">-</span><span class="n">numerix</span><span class="o">.</span><span class="n">pi</span> <span class="o">+</span> <span class="mf">0.0001</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">cellCenters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">thetaValue</span> <span class="ow">in</span> <span class="p">((</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">2.</span> <span class="o">*</span> <span class="n">numerix</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">3.</span><span class="p">),</span>
<span class="gp">... </span>                         <span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.</span> <span class="o">*</span> <span class="n">numerix</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">3.</span><span class="p">),</span>
<span class="gp">... </span>                         <span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.</span> <span class="o">*</span> <span class="n">numerix</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">3.</span> <span class="o">+</span> <span class="mf">0.3</span><span class="p">),</span>
<span class="gp">... </span>                         <span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span>  <span class="mf">2.</span> <span class="o">*</span> <span class="n">numerix</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">3.</span><span class="p">)):</span>
<span class="gp">... </span>    <span class="n">segment</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">L</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="gp">... </span>    <span class="n">phase</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">segment</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">theta</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">thetaValue</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">segment</span><span class="p">)</span>
</pre></div>
</div>
<p>Step through half the time steps.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">builtins</span> <span class="kn">import</span> <span class="nb">range</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span> <span class="o">//</span> <span class="mi">2</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">theta</span><span class="o">.</span><span class="n">updateOld</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">thetaEq</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">timeStepDuration</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="n">GeneralSolver</span><span class="p">(</span><span class="n">iterations</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">1e-15</span><span class="p">))</span>
<span class="gp">... </span>    <span class="n">phaseEq</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">phase</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">timeStepDuration</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="n">GeneralSolver</span><span class="p">(</span><span class="n">iterations</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">1e-15</span><span class="p">))</span>
</pre></div>
</div>
<p>We confirm that the solution has not yet converged to that given by
Ryo Kobayashi’s FORTRAN code:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">theta</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">testData</span><span class="p">))</span>
<span class="go">0</span>
</pre></div>
</div>
<p>We save the variables to disk.</p>
<div class="doctest highlight-default notranslate" id="index-8"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span> <span class="o">=</span> <span class="n">dump</span><span class="o">.</span><span class="n">write</span><span class="p">({</span><span class="s1">&#39;phase&#39;</span> <span class="p">:</span> <span class="n">phase</span><span class="p">,</span> <span class="s1">&#39;theta&#39;</span> <span class="p">:</span> <span class="n">theta</span><span class="p">},</span> <span class="n">extension</span> <span class="o">=</span> <span class="s1">&#39;.gz&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>and then recall them to test the data pickling mechanism</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">dump</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">newPhase</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;phase&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">newTheta</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;theta&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">newThetaEq</span> <span class="o">=</span> <span class="n">buildThetaEquation</span><span class="p">(</span><span class="n">newPhase</span><span class="p">,</span> <span class="n">newTheta</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">newPhaseEq</span> <span class="o">=</span> <span class="n">buildPhaseEquation</span><span class="p">(</span><span class="n">newPhase</span><span class="p">,</span> <span class="n">newTheta</span><span class="p">)</span>
</pre></div>
</div>
<p>and finish the iterations,</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">builtins</span> <span class="kn">import</span> <span class="nb">range</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span> <span class="o">//</span> <span class="mi">2</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">newTheta</span><span class="o">.</span><span class="n">updateOld</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">newThetaEq</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">newTheta</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">timeStepDuration</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="n">GeneralSolver</span><span class="p">(</span><span class="n">iterations</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">1e-15</span><span class="p">))</span>
<span class="gp">... </span>    <span class="n">newPhaseEq</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">newPhase</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">timeStepDuration</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="n">GeneralSolver</span><span class="p">(</span><span class="n">iterations</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">1e-15</span><span class="p">))</span>
</pre></div>
</div>
<p>The solution is compared against Ryo Kobayashi’s test data</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">newTheta</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">testData</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-7</span><span class="p">))</span>
<span class="go">1</span>
</pre></div>
</div>
</section>


                <div class='last-updated'>
                Last updated on Aug 10, 2023.
                Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.3.0.
                </div>
              </div>
  </div>  
  <aside class="nist-page__region nist-page__region--sidebar-second tablet-lg:grid-col-4">
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">

            <p class="logo"><a href="../contents.html">
              <img class="logo" src="../_static/logo.png" alt="Logo"/>
            </a></p>
<strong>FiPy: A Finite Volume PDE Solver Using Python</strong><br />
Version 3.4.4+256.g961ca499

<div class="sphinxsidebarsection">
  <h4>Previous topic</h4>
  <p class="topless"><a href="examples.phase.impingement.html"
                        title="previous chapter">examples.phase.impingement</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="examples.phase.impingement.mesh40x1.html"
                        title="next chapter">examples.phase.impingement.mesh40x1</a></p>
</div>
  <div class="sphinxsidebarsection">
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/generated/examples.phase.impingement.mesh20x20.rst.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
  </div>
<div class="sphinxsidebarsection">
<div id="searchbox" style="display: none" role="search">
  <div data-layout-content-preview-placeholder-label="&quot;Sphinx
  Search&quot; field" class="nist-block nist-block--search">
  <h2>Quick search</h2>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
  </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
</div>
<div class="sphinxsidebarsection" id="contact-wrapper">
  
        <div data-layout-content-preview-placeholder-label="&quot;Related
        organization tree&quot; views block" class="nist-block nist-block--org">
          
          <h2 class="nist-block__title">Organizations</h2>
              
              <div class="views-element-container"><div
              class="js-view-dom-id-70b0923f677edbe3dda361030ef8dc373cd0ca94065c39cfd81338de767f1019">

            <div class="nist-related-orgs"><div class="term-tree-list"><ul
            class="term"><li class="selected"><a
            href="https://www.nist.gov/nist-organizations/nist-headquarters" hreflang="en">NIST
            Headquarters</a><ul class="term"><li class="selected"><a
            href="https://www.nist.gov/nist-organizations/nist-headquarters/laboratory-programs"
            hreflang="en">Laboratory Programs</a><ul class="term"><li
            class="selected"><a
            href="https://www.nist.gov/nist-organizations/nist-headquarters/laboratory-programs/material-measurement-laboratory"
            hreflang="en">Material Measurement Laboratory</a>
			<ul
			class="term"><li
			class="selected"><a href="https://www.nist.gov/mml/msed"
			hreflang="en">Materials Science and Engineering
			Division</a></li><li
			class="selected"><a href="https://www.nist.gov/mml/ctcms"
			hreflang="en">Center for Theoretical and
			              Computational Materials Science</a></li></ul>
                          </li></ul></li></ul></li></ul></div></div>
          <div class="nist-related-orgs"></div>
          <div class="nist-related-orgs"></div>



        </div>
        </div>

          </div>


          <div data-layout-content-preview-placeholder-label="&quot;NIST
          Staff&quot; field" class="nist-block nist-block--contact">

          <h2 class="nist-block__title">NIST Staff</h2>

                  <div class="nist-field nist-field--label-hidden
                  nist-field--link-list entity-reference nist-field__items
                  nist-field--no-margin">
                            <div class="nist-field__item
                            nist-field--no-margin"><a
                            href="https://www.nist.gov/people/jonathan-e-guyer"
                            hreflang="en">Jonathan E. Guyer</a></div>
                                <div class="nist-field__item
                                nist-field--no-margin"><a
                                href="https://www.nist.gov/people/daniel-wheeler"
                                hreflang="en">Daniel Wheeler</a></div>
                                <div class="nist-field__item
                                nist-field--no-margin"><a
                                href="https://www.nist.gov/people/james-warren"
                                hreflang="en">James A. Warren</a></div>
                  </div>


          </div>

          <div data-layout-content-preview-placeholder-label="&quot;Contact&quot; field"
          class="nist-block nist-block--contact nist-block--mail">

          <h2 class="nist-block__title">
          <a class="" href="../docs/source/CONTACT.html" style="">Contact</a>
          </h2>

          </div>

</div>
        </div>
      </div>
      <div class="clearer"></div>
  </aside>
        </div>
      </div>

      <div class="panel-region--postface">
      <div class="inner region-inner inside">
        
<div class="pane pane--nist-node-date-pane" >

    </div>
      </div>
    </div>

        </section>
        </div>
      </div>

      </div>  
    </div>          

    </div>

  </div>

</div>


  


  <!-- Taken from https://www.filamentgroup.com/lab/html-includes/#another-demo%3A-including-another-html-file -->
  <iframe src="../_static/ntd2d_menu.html" onload="this.before((this.contentDocument.body||this.contentDocument).children[0]);this.remove()"></iframe>
    </div>
  </body>
</html>